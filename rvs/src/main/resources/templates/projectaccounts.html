<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" lang="en"
	class="light-style layout-navbar-fixed layout-menu-fixed" dir="ltr"
	data-theme="theme-default" th:data-assets-path="@{/assets/}"
	data-template="vertical-menu-template">
<head>
<meta name="_csrf" th:content="${_csrf.token}" />
<!-- default header name is X-CSRF-TOKEN -->
<meta name="_csrf_header" th:content="${_csrf.headerName}" />

<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

<title>Project Invoice & Receipt</title>

<meta name="description" content="" />



<!-- Favicon -->
<link rel="icon" type="image/x-icon"
	th:href="@{/assets/img/favicon/favicon.ico}" />

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
	href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Rubik:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
	rel="stylesheet" />

<!-- Icons -->
<link rel="stylesheet" th:href="@{/assets/vendor/fonts/boxicons.css}" />
<link rel="stylesheet" th:href="@{/assets/vendor/fonts/fontawesome.css}" />
<link rel="stylesheet" th:href="@{/assets/vendor/fonts/flag-icons.css}" />

<!-- Core CSS -->
<link rel="stylesheet" th:href="@{/assets/vendor/css/rtl/core.css}"
	class="template-customizer-core-css" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/css/rtl/theme-default.css}"
	class="template-customizer-theme-css" />
<link rel="stylesheet" th:href="@{/assets/css/demo.css}" />

<!-- Vendors CSS -->
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/typeahead-js/typeahead.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-bs5/datatables.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/animate-css/animate.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/sweetalert2/sweetalert2.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/flatpickr/flatpickr.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/jquery-timepicker/jquery-timepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/select2/select2.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/tagify/tagify.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/formvalidation/dist/css/formValidation.min.css}" />
<!-- Page CSS -->

<link rel="stylesheet"
	th:href="@{/assets/vendor/css/pages/page-user-view.css}" />
<!-- Helpers -->
<script th:src="@{/assets/vendor/js/helpers.js}"></script>

<!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
<!--? Template customizer: To hide customizer set displayCustomizer value false in config.js.  -->
<script th:src="@{/assets/vendor/js/template-customizer.js}"></script>
<!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
<script th:src="@{/assets/js/config.js}"></script>

<style type="text/css">
.contacteditbtn {
	cursor: pointer;
}

.activitytypeicon {
	position: relative;
	margin-left: -10px;
}

.guestdetailslist, .followerdetailslist {
	top: 10px;
	font-size: 14px;
	left: -20px;
}

.tooltipx {
	position: relative;
	display: inline-block;
}

.tooltipx .tooltiptextx {
	visibility: hidden;
	font-size: 12px;
	min-width: 120px;
	background-color: black;
	color: #fff;
	text-align: center;
	border-radius: 6px;
	padding: 5px 1px;
	/* Position the tooltip */
	position: absolute;
	left: 50px;
	z-index: 1;
}

.tooltipx:hover .tooltiptextx {
	visibility: visible;
}

.btn-iconx {
	padding: 1px;
	display: inline-flex;
	margin-right: 2px;
	margin-top: -3px;
	width: 15px;
	height: 15px;
}

.editactivity {
	cursor: pointer;
}

.editnoteactivity {
	cursor: pointer;
}

.generatenewreceipt {
	cursor: pointer;
}

.editprojectprj {
	cursor: pointer;
}

.editprojectprj1 {
	padding-left: 10px;
	vertical-align: middle;
	margin-top: -5px;
	cursor: pointer;
}

.sameasInvoiceto {
	float: right;
	padding-left: 10px;
	font-weight: normal;
	font-size: 13px;
}
</style>
<script th:inline="javascript">
	var emplanstat = 0;
	var emgstat = 0;
	var languagelist = "";
	var educationdegreelist = "";
	var Nomineerelationshiplist = "";
	
	function optionshandle(radio)
	{
		
		$(".ActivityTitle").attr('placeholder',radio.title +' details...');
		$(".activitytype").removeClass("active");
		$(".activitytype"+radio.title).addClass("active");
	}	
	
	
</script>
</head>

<body>
	<!-- Layout wrapper -->
	<div class="layout-wrapper layout-content-navbar">
		<div class="layout-container">
			<!-- Menu -->
			<div th:insert="menu"></div>
			<!-- / Menu -->

			<!-- Layout container -->
			<div class="layout-page">
				<!-- Navbar -->
				<div th:insert="header"></div>
				<!-- / Navbar -->

				<!-- Content wrapper -->
				<div class="content-wrapper">
					<!-- Content -->

					<div class="container-xxl flex-grow-1 container-p-y">
						<h4 class="py-3 breadcrumb-wrapper mb-4">
							<span class="text-muted fw-light">Works /<a
								href="projectlist">Project</a>/
							</span> Invoices


						</h4>
						<div class="row gy-4">
							<!-- User Sidebar -->
							<div class="col-xl-4 col-lg-5 col-md-5 order-1 order-md-0">
								<!-- User Card -->
								<div class="card mb-4">
									<div class="card-body">
										<div class="user-avatar-section">
											<div class="d-flex align-items-center flex-column">
												<img class="img-fluid rounded my-1"
													th:src="@{/assets/img/bg_rvs/Project.jpg}"
													alt="User avatar" />
												<div class="user-info text-center">
													<h5 class="mb-2" th:text="${projectMaster.Title}"
														id="Lbl_Title"></h5>
													<span class="badge bg-label-secondary" id="Lbl_ProjectID"
														th:text="'Project ID : '+ ${projectMaster.projectID}"></span>
												</div>
											</div>
										</div>
										<div class="d-flex justify-content-around flex-wrap my-4">
											<div class="d-flex align-items-start me-4 mt-3 gap-3">
												<span class="badge bg-label-primary p-2 rounded"><i
													class="bx bx-rupee bx-sm"></i></span>
												<div>
													<h6 class="mb-0">
														Rs.<span th:text="${projectMaster.projectvalue}"
															id="Lbl_projectvaluetotal"></span>
													</h6>
													<span>Project Value</span>
												</div>
											</div>
											<div class="d-flex align-items-start mt-3 gap-3">
												<span class="badge bg-label-primary p-2 rounded"><i
													class="bx bx-stats bx-sm"></i></span>
												<div>
													<h6 class="mb-0">
														<span th:text="${projectMaster.status}" id="Lbl_Status"></span>
													</h6>
													<span>Project Status</span>
												</div>
											</div>



										</div>
										<h5 class="pb-2 border-bottom mb-4">Details</h5>
										<div class="info-container">
											<ul class="list-unstyled">
												<li class="mb-3"><span class="fw-bold me-2">Phase:
												</span> <span th:text="${projectMaster.pipeline}" id="Lbl_pipeline"></span></li>
												<li class="mb-3"><span class="fw-bold me-2">Label:</span>
													<span id="Lbl_label"> <span
														th:if="${projectMaster.Label} =='Hot'"
														class="badge bg-danger" th:text="${projectMaster.Label}"></span>
														<span th:if="${projectMaster.Label} =='Warm'"
														class="badge bg-warning" th:text="${projectMaster.Label}"></span>
														<span th:if="${projectMaster.Label} =='Cold'"
														class="badge bg-primary" th:text="${projectMaster.Label}"></span>


												</span></li>
												<li class="mb-3"><span class="fw-bold me-2">Organization:</span>
													<span th:text="${projectMaster.OrganizationName}"
													id="Lbl_organization"></span>
													<hr /></li>

												<li class="mb-3"><span class="fw-bold me-2">Nature
														Of Work:</span> <span th:text="${projectMaster.NatureofWork}"
													id="Lbl_NatureofWork"></span></li>
												<li class="mb-3"><span class="fw-bold me-2">Area:</span>
													<span th:text="${projectMaster.Area}" id="Lbl_Area"></span>
													<span th:text="${projectMaster.UNITS}" id="Lbl_UNITS"></span>
												</li>

												<li class="mb-3"><span class="fw-bold me-2">Location:</span>
													<span th:text="${projectMaster.Location}" id="Lbl_Location"></span>
												</li>
												<li class="mb-3"><span class="fw-bold me-2">T.Date:</span>
													<span th:text="${projectMaster.tdateMMddYYY}"
													id="Lbl_tdate"></span></li>
												<li class="mb-3"><span class="fw-bold me-2">T.Estimate:</span>
													<span th:text="${projectMaster.projectvalue}"
													id="Lbl_projectvalue"></span></li>
												<li class="mb-3"><span class="fw-bold me-2">Purpose:</span>
													<span th:text="${projectMaster.purpose}" id="Lbl_purpose"></span>
												</li>

												<li class="mb-3"><span class="fw-bold me-2">Source:</span>
													<span th:text="${projectMaster.Source}" id="Lbl_Source"></span>
												</li>

												<li class="mb-3"><span class="fw-bold me-2">Reference:</span>
													<span th:text="${projectMaster.ReferenceName}"
													id="Lbl_Reference"></span>
												<hr /></li>

												<li class="mb-3"><span class="fw-bold me-2">Board:</span>
													<span th:text="${projectMaster.boardName}" id="Lbl_board"></span>
												</li>
												<li class="mb-3"><span class="fw-bold me-2">Branch:</span>
													<span th:text="${projectMaster.branchname}"
													id="Lbl_branchname"></span></li>
												<li class="mb-3"><span class="fw-bold me-2">Notes:</span>
													<span th:text="${projectMaster.notes}" id="Lbl_notes"></span>
												</li>
												<li class="mb-3"><span class="fw-bold me-2">Project
														In Date:</span> <span
													th:text="${projectMaster.expectedstartdateMMddYYY}"
													id="Lbl_expectedstartdate"></span></li>
												<li class="mb-3"><span class="fw-bold me-2">Due
														Date:</span> <span
													th:text="${projectMaster.expectedclosingdateMMddYYY}"
													id="Lbl_expectedclosingdate"></span></li>
												<li class="mb-3"><span class="fw-bold me-2">Follower:</span>

													<span id="Lbl_follower"> <span
														th:each="obj : ${projectMaster.projectFollowers}"
														th:utext="${obj.Followername} + '<br/>'"> </span>
												</span></li>


											</ul>
											<div class="d-flex justify-content-center pt-3">
												<a href="javascript:;" class="btn btn-primary me-3"
													data-bs-target="#editprojectMasterdetails"
													data-bs-toggle="modal"
													id="editOrganizationContactsdetailsbtn">Edit</a>

											</div>
										</div>
									</div>
								</div>
								<!-- /User Card -->
								<!-- Connected Accounts -->
								<div class="card mb-4">
									<h5 class="card-header">
										Connected People
										<div class="card-action-element" style="float: right">
											<button class="btn btn-primary btn-sm" type="button"
												data-bs-toggle="modal" data-bs-target="#addNewperson"
												alt="Add New Person">
												<i class="bx bx-plus bx-xs me-1"></i>
											</button>
											<button class="btn btn-primary btn-sm" type="button"
												data-bs-toggle="modal" data-bs-target="#linkperson"
												alt="Link Person">
												<i class="bx bx-link bx-xs me-1"></i>
											</button>
										</div>
									</h5>
									<div class="card-body">
										<div class="d-flex mb-3" th:each="obj : ${cplist}">
											<div th:class="'flex-grow-1 row dcon'+ ${obj.id} ">
												<div class="col-6 mb-sm-0 mb-2">
													<a th:href="'contactpersonview?id='+ ${obj.id}"
														target="_blank">
														<h6 class="mb-0" th:text="${obj.peoplename}"></h6>
													</a> <small class="text-muted" th:text="${obj.primarymob}"></small>
												</div>
												<div class="col-3 text-end">
													<label class="switch me-0"> <input type="checkbox"
														class="switch-input" th:name="${obj.id}"
														th:onclick="'makeprimarycontactperson(this)'"
														th:checked="${obj.primaryperson}" /> <span
														class="switch-toggle-slider"> <span
															class="switch-on"> <i class="bx bx-check"></i>
														</span> <span class="switch-off"> <i class="bx bx-x"></i>
														</span>
													</span> <span class="switch-label"></span>
													</label>


												</div>
												<div class="col-3">
													<div class="dropdown">
														<button class="btn p-0" type="button" id="salesReport"
															data-bs-toggle="dropdown" aria-haspopup="true"
															aria-expanded="false">
															<i class="bx bx-dots-vertical-rounded"></i>
														</button>
														<div class="dropdown-menu dropdown-menu-end"
															aria-labelledby="salesReport">
															<a class="dropdown-item" th:name="${obj.id}"
																th:onclick="'removecontactperson(this)'">Unlink</a>

														</div>
													</div>
												</div>
											</div>
										</div>

										<div id="contactpeopprojectdidv"></div>

									</div>
								</div>
								<!-- /Connected Accounts -->

							</div>
							<!--/ User Sidebar -->

							<!-- User Content -->
							<div class="col-xl-8 col-lg-7 col-md-7 order-0 order-md-1">
								<!-- User Pills -->
								<ul class="nav nav-pills flex-column flex-md-row mb-3">
									<li class="nav-item"><a class="nav-link "
										th:href="'projectview?id='+${projectMaster.id}"><i
											class="bx bx-user me-1"></i>Plan</a></li>
									<li class="nav-item"><a class="nav-link "
										th:href="'projectiteminfo?id='+${projectMaster.id}"><i
											class='bx bxl-ok-ru'></i>Projects</a></li>
									<li class="nav-item"><a class="nav-link "
										th:href="'projectattachment?id='+${projectMaster.id}"><i
											class="bx bx-link me-1"></i>Files</a></li>
									<li class="nav-item"><a class="nav-link active"><i
											class="menu-icon tf-icons bx bx-food-menu me-1"></i>Invoices</a></li>
									<li class="nav-item"><a class="nav-link"
										th:href="'projectpurchase?id='+${projectMaster.id}"> <i
											class="menu-icon tf-icons bx bx-food-menu me-1"></i>Purchase
									</a></li>
									<li class="nav-item"><a class="nav-link"
										th:href="'projectexpense?id='+${projectMaster.id}"><i
											class="menu-icon tf-icons bx bx-food-menu me-1"></i>Expense</a></li>
									<li class="nav-item"><a class="nav-link"
										th:href="'projectnotes?id='+${projectMaster.id}"><i
											class='bx bx-notepad'></i>Notes</a></li>
								</ul>
								<!--/ User Pills -->



								<!-- Project   Card -->
								<div class="card  mb-4">
									<div class="card-body1">
										<div class="card-header align-items-center">
											<h5 class="card-action-title mb-0">
												Invoice List
												<div class="card-action-element" style="float: right">
													<button class="btn btn-primary btn-sm addNewInvoicebtn"
														type="button" data-bs-toggle="modal"
														data-bs-target="#invoicemodel">
														<i class="bx bx-plus bx-xs me-1"></i>
													</button>
												</div>
											</h5>
										</div>
										<div class="table-responsive">
											<table class="table border-top m-0">
												<thead>
													<tr>
														<th>Invoice #</th>
														<th>Type</th>
														<th>Date</th>
														<th>Due Date</th>
														<th>Amount</th>
													</tr>
												</thead>
												<tbody id="projectinvoicelist">

												</tbody>
											</table>
										</div>
									</div>
								</div>
								<!-- /Project   Card -->

								<!-- Receipts   Card -->
								<div class="card  mb-4">
									<div class="card-body1">
										<div class="card-header align-items-center">
											<h5 class="card-action-title mb-0">Receipts List</h5>
										</div>
										<div class="table-responsive">
											<table class="table border-top m-0">
												<thead>
													<tr>
														<th>Ref #</th>
														<th>Invoice #</th>
														<th>Date</th>
														<th>Account</th>

														<th>Amount Paid</th>
													</tr>
												</thead>
												<tbody id="receiptslist">

												</tbody>
											</table>
										</div>
									</div>
								</div>
								<!-- /Receipts   Card -->
							</div>
							<!-- User Content -->
							<!-- Add Invoice -->
							<div class="modal fade" id="invoicemodel" tabindex="-1"
								aria-hidden="true">


								<div class="modal-dialog modal-xl modal-simple modal-add-new-cc">
									<div class="modal-content p-3 p-md-5">
										<div class="modal-bodyx">
											<button type="button" class="btn-close"
												data-bs-dismiss="modal" aria-label="Close"></button>
											<form class="row g-3 needs-validation" id="editinvoiceformx"
												onsubmit="return false">
												<!-- -------- -->
												<!-- Invoice Add-->
												<div class="col-lg-12 col-12 mb-lg-0 mb-4">
													<div class="card invoice-preview-card">
														<div class="card-body">
															<div class="row p-sm-3 p-0">
																<div class="col-md-4 mb-md-0 mb-4">
																	<div class="d-flex svg-illustration mb-4 gap-2">
																		<img th:src="@{/assets/img/logo/favicon.ico}" /> <span
																			class="app-brand-text h3 mb-0 fw-bold">RVS
																			Land Surveyors</span>
																	</div>
																	<p class="mb-1">29, Palani Illam, Sundaram Brothers
																		Layout,</p>
																	<p class="mb-1">Ramanathapuram, Coimbatore - 641045</p>
																	<p class="mb-1">+ 91 96007 31477,
																		accounts@rvsls.com.</p>
																	<p class="mb-0">GSTIN/UIN: 33AASFR5322C1ZD</p>
																</div>
																<div class="col-md-4">
																	<dl class="row mb-2">
																		<dt class="col-sm-6 mb-2 mb-sm-0 text-md-end">
																			<span class="text-capitalize mb-0 text-nowrap">Tally
																				Ref #</span>
																		</dt>
																		<dd class="col-sm-6 d-flex justify-content-md-end">
																			<div class="w-px-150">
																				<input type="text" class="form-control"
																					id="invoiceNo" name="invoiceNo" required /> <input
																					type="hidden" class="form-control" id="invoiceid"
																					name="invoiceid" />
																			</div>
																		</dd>
																		<dt class="col-sm-6 mb-2 mb-sm-0 text-md-end">
																			<span class="fw-normal">Bill Type:</span>
																		</dt>
																		<dd class="col-sm-6 d-flex justify-content-md-end">
																			<div class="w-px-150">
																				<select id="invoiceType" name="invoiceType"
																					class="form-select"
																					aria-label="Default select example" required>
																					<option value="">-</option>
																					<option value="Tax Invoice">Tax Invoice</option>
																					<option value="Proforma Invoice">Proforma
																						Invoice</option>
																					<option value="Bill">Bill</option>
																				</select>
																			</div>
																		</dd>

																	</dl>
																</div>
																<div class="col-md-4">
																	<dl class="row mb-2">
																		<dt class="col-sm-6 mb-2 mb-sm-0 text-md-end">
																			<span class=" text-capitalize mb-0 text-nowrap">
																				Date:</span>
																		</dt>
																		<dd class="col-sm-6 d-flex justify-content-md-end">
																			<div class="w-px-150">
																				<input type="date" class="form-control"
																					id="invoiceDate" name="invoiceDate" required />
																			</div>
																		</dd>

																		<dt class="col-sm-6 mb-2 mb-sm-0 text-md-end">
																			<span class="fw-normal">Due Date:</span>
																		</dt>
																		<dd class="col-sm-6 d-flex justify-content-md-end">
																			<div class="w-px-150">
																				<input type="date" class="form-control date-picker"
																					id="dueDate" name="dueDate" required />
																			</div>
																		</dd>

																	</dl>
																</div>
															</div>

															<hr />

															<div class="row p-sm-3 p-0">
																<div class="col-md-6 col-sm-5 col-12 mb-sm-0 mb-4 "
																	style="padding-right: 3%;">
																	<h6 class="pb-2">Customer:</h6>
																	<p class="row mb-1">
																		<input type="text" class="col-12 form-control lxd"
																			name="invoiceaddressline1" id="invoiceaddressline1"
																			Placeholder="Address Line1" />
																	</p>
																	<p class="row mb-1">
																		<input type="text" class="col-12 form-control lxd"
																			name="invoiceaddressline2" id="invoiceaddressline2"
																			Placeholder="Address Line2" />
																	</p>
																	<p class="row mb-1">
																		<input type="text" class="col-6 form-control lxd"
																			name="invoiceaddresscity" id="invoiceaddresscity"
																			Placeholder="City / District" style="width: 50%" />
																		<input type="text" class="col-6 form-control lxd"
																			name="invoiceaddresspincode"
																			id="invoiceaddresspincode" Placeholder="Pincode"
																			style="width: 50%" />
																	</p>
																	<p class="row mb-1">
																		<input type="text" class="col-6 form-control lxd"
																			name="invoiceaddressState" id="invoiceaddressState"
																			Placeholder="State" style="width: 50%" /> <input
																			type="text" class="col-6 form-control lxd"
																			name="invoiceGSTNo" id="invoiceGSTNo"
																			Placeholder="GST" style="width: 50%" />
																	</p>

																</div>
																<div class="col-md-6 col-sm-7">
																	<h6 class="pb-2">
																		Bill To: <label for="sameasInvoiceto"
																			class="sameasInvoiceto">Same as Invoice to
																			Address</label> <input type="checkbox"
																			class="sameasInvoiceto" id="sameasInvoiceto"
																			name="sameasInvoiceto" value="sameasInvoiceto">

																	</h6>
																	<p class="row mb-1">
																		<input type="text" class="col-12 form-control lxd"
																			name="billaddressline1" id="billaddressline1"
																			Placeholder="Address Line1" />
																	</p>
																	<p class="row mb-1">
																		<input type="text" class="col-12 form-control lxd"
																			name="billaddressline2" id="billaddressline2"
																			Placeholder="Address Line2" />
																	</p>
																	<p class="row mb-1">
																		<input type="text" class="col-6 form-control lxd"
																			name="billaddresscity" id="billaddresscity"
																			Placeholder="City / District" style="width: 50%" />
																		<input type="text" class="col-6 form-control lxd"
																			name="billaddresspincode" id="billaddresspincode"
																			Placeholder="Pincode" style="width: 50%" />
																	</p>
																	<p class="row mb-1">
																		<input type="text" class="col-6 form-control lxd"
																			name="billaddressState" id="billaddressState"
																			Placeholder="State" style="width: 50%" /> <input
																			type="text" class="col-6 form-control lxd"
																			name="billGSTNo" id="billGSTNo" Placeholder="GST"
																			style="width: 50%" />
																	</p>

																</div>
															</div>

															<hr class="mx-n4" />

															<div class="mb-3" data-repeater-list="group-a">
																<div class="repeater-wrapper pt-0 pt-md-4"
																	id="invoiceitemlist"></div>
															</div>
															<div class="row">
																<div class="col-12">
																	<button type="button" class="btn btn-primary"
																		id="addnewinvoiceitem">Add
																		Item</button>
																</div>
															</div>


															<hr class="my-4 mx-n4" />

															<div class="row py-sm-3">
																<div class="col-6">
																	<div class="mb-3">
																		<label for="note" class="form-label fw-semibold">Note:</label>
																		<textarea class="form-control" rows="2" id="note"
																			name="note" placeholder="Invoice note"></textarea>
																	</div>
																</div>
																<div class="col-md-6 d-flex justify-content-end">
																	<div class="invoice-calculations">
																		<div class="d-flex justify-content-between mb-2">
																			<span class="w-px-100">Total:</span> <span
																				class="fw-semibold" id="totalamtwithouttax">0.00</span>
																		</div>
																		<div
																			class="d-flex justify-content-between mb-2 totaldiscountamountdiv">
																			<span class="w-px-100">Discount:</span> <span
																				class="fw-semibold" id=totaldiscountamount>0.00</span>
																		</div>
																		<div
																			class="d-flex justify-content-between mb-2 totalCGSTdiv">
																			<span class="w-px-100">CGST:</span> <span
																				class="fw-semibold" id="totalCGST">0.00</span>
																		</div>
																		<div
																			class="d-flex justify-content-between mb-2 totalSGSTdiv">
																			<span class="w-px-100">SGST:</span> <span
																				class="fw-semibold" id="totalSGST">0.00</span>
																		</div>
																		<div
																			class="d-flex justify-content-between mb-2 totalIGSTdiv">
																			<span class="w-px-100">IGST:</span> <span
																				class="fw-semibold" id="totalIGST">0.00</span>
																		</div>
																		<hr />
																		<div class="d-flex justify-content-between">
																			<span class="w-px-100">Total Amount:</span> <span
																				class="fw-semibold" id="totalamount">0.00</span>
																		</div>

																	</div>
																</div>
															</div>
															<div align="center">
																<button type="submit"
																	class="btn btn-primary editInvoicesubmit me-sm-3 me-1">Save
																</button>

																<button type="reset"
																	class="btn btn-label-secondary editInvoiceclose"
																	data-bs-dismiss="modal" aria-label="Close">
																	Cancel</button>

															</div>
														</div>
													</div>
												</div>
												<!-- /Invoice Add-->
												<!-- -------- -->
											</form>
										</div>
									</div>
								</div>

							</div>
							<!--/ Add Invoice -->
							<!-- Edit Receipt Modal -->
							<div class="modal fade" id="receiptmodel" tabindex="-1"
								aria-hidden="true">
								<div class="modal-dialog modal-lg modal-simple modal-edit-user">
									<div class="modal-content p-3 p-md-5">
										<div class="modal-body">
											<button type="button" class="btn-close"
												data-bs-dismiss="modal" aria-label="Close"></button>
											<div class="text-center mb-4">
												<h5>Payment Receipt</h5>
											</div>
											<form class="row g-3 needs-validation" id="editreceiptformx"
												onsubmit="return false">
												<div class="row p-sm-3 p-0">
													<div class="col-md-6 mb-md-0 mb-4">

														<p class="mb-1">
															<b>Invoice No# :</b> <span id="invoiceNotxt"></span> <input
																type="hidden" id="recepitid" name="recepitid" /> <input
																type="hidden" id="recinvoiceid" name="recinvoiceid"
																required />
														</p>
														<p class="mb-1">
															<b>Due Date :</b> <span id="duedatetxt"></span>
														</p>
														<p class="mb-0"></p>
													</div>
													<div class="col-md-6">
														<p class="mb-1" align="right">
															<b>Amount :</b> <span id="invoiceamounttxt"></span>
														</p>
														<p class="mb-1" align="right">
															<b>Total paid :</b> <span id="invoicetotalpaidNotxt"></span>
														</p>
														<p class="mb-0" align="right">
															<b>Balance Due :</b> <span id="invoiceBalancetxt"></span>
														</p>
													</div>

												</div>


												<div class="col-12 col-md-6">
													<label class="form-label" for="recepitNo">Tally
														Receipt #</label> <input type="text" id="recepitNo"
														name="recepitNo" class="form-control" required />
												</div>

												<div class="col-12 col-md-6">
													<label class="form-label" for="recepitDate">Date</label> <input
														type="date" id="recepitDate" name="recepitDate"
														class="form-control" required />
												</div>

												<div class="col-12 col-md-6">
													<label class="form-label" for="depositedto">Deposited
														To</label> <select id="depositedto" name="depositedto"
														class="form-select" aria-label="Default select example"
														required>
														<option value="">-</option>
														<th:block th:each="obj1 : ${accountlist}">
															<option th:value="${obj1.accountheadid}"
																th:text="${obj1.category}"></option>
														</th:block>

													</select>
												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="modeofPayment">Mode
														of Payment</label> <select id="modeofPayment" name="modeofPayment"
														class="form-select" aria-label="Default select example"
														required>
														<option value="">-</option>
														<th:block th:each="str :${ModeofPayment}">
															<option th:value="${str}" th:text="${str}"></option>
														</th:block>
													</select>
												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="amount">Amount </label> <input
														type="text" id="amount" name="amount"
														class="form-control modal-edit-tax-id" required />
												</div>
												<div class="col-12 col-md-6">
													<br /> <label class="switch"> <input
														type="checkbox" class="switch-input" id="payfull" /> <span
														class="switch-toggle-slider"> <span
															class="switch-on"></span> <span class="switch-off"></span>
													</span> <span class="switch-label">Pay in Full</span>
													</label>
												</div>
												<div class="col-12">
													<label class="form-label" for="notes">Notes </label> <input
														type="text" id="notes" name="notes"
														class="form-control modal-edit-tax-id" />
												</div>

												<div class="col-12 text-center mt-4">
													<button type="submit"
														class="btn btn-primary editReceiptsubmit me-sm-3 me-1">Save
													</button>

													<button type="reset"
														class="btn btn-label-secondary editReceiptclose"
														data-bs-dismiss="modal" aria-label="Close">
														Cancel</button>
												</div>
											</form>
										</div>
									</div>
								</div>
							</div>




							<!--/ Edit User Modal -->

							<!-- Edit User Modal -->
							<div class="modal fade" id="editprojectMasterdetails"
								tabindex="-1" aria-hidden="true">
								<div class="modal-dialog modal-lg modal-simple modal-edit-user">
									<div class="modal-content p-3 p-md-5">

										<div class="modal-body">
											<button type="button" class="btn-close"
												data-bs-dismiss="modal" aria-label="Close"></button>
											<div class="text-center mb-4">
												<h3>Edit Project Information</h3>
												<p>Update Project Basic Information</p>
											</div>
											<form id="editprojectMasterdetailsForm"
												th:object="${projectMaster}"
												class="row g-3 needs-validation" onsubmit="return false">
												<input type="hidden" th:value="${projectMaster['id']}"
													id="projectMasterID" name="projectMasterID" />

												<div class="col-12 col-md-6">
													<label class="form-label" for="Title">Project ID</label>
													<div>
														<input type="text" id="ProjectID" th:field="*{projectID}"
															class="form-control  capitalize"
															th:value="${projectMaster['projectID']}" required>

													</div>

												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="Title">TITLE</label>
													<div>
														<input type="text" id="Title" th:field="*{Title}"
															class="form-control  capitalize"
															th:value="${projectMaster['Title']}" required>

													</div>

												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="organization">ORAGNIZATION</label>
													<div>
														<select class="form-select followers form-control "
															id="organization" th:field="*{Organization}"
															th:value="${projectMaster['Organization']}">
															<option value="">-</option>
															<th:block th:each="str :${organizationlist}">
																<option th:value="${str.id}" th:text="${str.orgname}"></option>
															</th:block>
														</select>

														<div class="invalid-feedback">Please select
															follower.</div>
													</div>
												</div>

												<div class="col-12 col-md-6">
													<label class="form-label" for="board">Board</label>
													<div>
														<select class="form-control" id="board"
															th:field="*{board}">
															<option value="">-</option>
															<th:block th:each="str :${board}">
																<option th:value="${str.id}" th:text="${str.boardName}"></option>
															</th:block>
														</select>
													</div>
												</div>
												<hr />

												<div class="col-12 col-md-6">
													<label class="form-label" for="NatureofWork">Nature
														Of Work</label>
													<div>
														<select class="form-control" id="NatureofWork"
															th:field="*{NatureofWork}"
															th:value="${projectMaster['NatureofWork']}">
															<th:block th:each="str :${NATUREOFWORK}">
																<option th:value="${str}" th:text="${str}"></option>
															</th:block>
														</select>
													</div>

												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="Area">Area</label>
													<div>
														<input type="number" id="Area" step="any"
															th:field="*{Area}" class="form-control  capitalize"
															th:value="${projectMaster['Area']}">
													</div>

												</div>

												<div class="col-12 col-md-6">
													<label class="form-label" for="NatureofWork">Unit</label>
													<div>
														<select class="form-control" id="UNITS"
															th:field="*{UNITS}" th:value="${projectMaster['UNITS']}">
															<th:block th:each="str :${UNITS}">
																<option th:value="${str}" th:text="${str}"></option>
															</th:block>
														</select>
													</div>

												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="Location">Location</label>
													<div>
														<input type="text" id="Location" th:field="*{Location}"
															class="form-control  capitalize"
															th:value="${projectMaster['Location']}">
													</div>

												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="tdate">T.Date</label>
													<div>
														<input type="text" id="tdate" th:field="*{tdate}"
															th:value="${projectMaster['tdate']}"
															class="form-control  capitalize">
													</div>
												</div>

												<div class="col-12 col-md-6">
													<label class="form-label" for="Source">T.Estimate</label>
													<div>
														<input type="number" id="projectvalue" step="any"
															th:field="*{projectvalue}"
															class="form-control  capitalize"
															th:value="${projectMaster['projectvalue']}">
													</div>

												</div>

												<div class="col-12 col-md-6">
													<label class="form-label" for="pipeline">Phase </label>
													<div>
														<select class="form-control" id="pipeline"
															th:field="*{pipeline}"
															th:value="${projectMaster['pipeline']}">
															<th:block th:each="str :${Phase}">
																<option th:value="${str}" th:text="${str}"></option>
															</th:block>
														</select>
													</div>
												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="purpose">PURPOSE </label>
													<div>
														<select class="form-control  addpurposedata" id="purpose"
															th:field="*{purpose}"
															th:value="${projectMaster['purpose']}">
															<th:block th:each="str :${PURPOSE}">
																<option th:value="${str}" th:text="${str}"></option>
															</th:block>
														</select>
													</div>

												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="Source">SOURCE </label>
													<div>
														<select class="form-control  addsourcedata" id="Source"
															th:field="*{Source}"
															th:value="${projectMaster['Source']}">
															<th:block th:each="str :${SOURCE}">
																<option th:value="${str}" th:text="${str}"></option>
															</th:block>
														</select>
													</div>

												</div>

												<div class="col-12 col-md-6 Referencediv">
													<label class="form-label" for="Reference">REFERENCE</label>
													<div>

														<select class="form-control " id="Reference"
															th:field="*{Reference}"
															th:value="${projectMaster['Reference']}">
															<option value="">-</option>
															<th:block th:each="str :${personlist}">
																<option th:value="${str.id}" th:text="${str.peoplename}"></option>
															</th:block>
														</select>
													</div>

												</div>
												<hr />

												<div class="col-12 col-md-6">
													<label class="form-label" for="label">LABEL </label>
													<div>
														<select class="form-control" id="label"
															th:field="*{label}" th:value="${projectMaster['label']}">
															<th:block th:each="str :${Label}">
																<option th:value="${str}" th:text="${str}"></option>
															</th:block>

														</select>
													</div>
												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="phonenumber">BRANCH</label>
													<div>
														<select class="form-select  form-control " id="branch"
															th:field="*{branch}"
															th:value="${projectMaster['branch']}" required>
															<th:block th:each="str :${branchlist}">
																<option th:value="${str.id}"
																	th:text="${str.BRANCH_NAME}"></option>
															</th:block>
														</select>

													</div>
												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="followers">FOLLOWER</label>
													<div>
														<select
															class="select2  form-select followers form-control "
															id="followers" name="follower" multiple="multiple"
															required>
															<th:block th:each="str :${employeelist}">
																<option th:value="${str.empMasterid}"
																	th:text="${str.StaffName}"></option>
															</th:block>
														</select>

														<div class="invalid-feedback">Please select
															follower.</div>
													</div>
												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="Status">Status</label>
													<div>
														<select class="form-control" id="Status"
															th:field="*{Status}"
															th:value="${projectMaster['Status']}">
															<th:block th:each="str :${ProjectStatus}">
																<option th:value="${str}" th:text="${str}"></option>
															</th:block>
														</select>
													</div>

												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="notes">NOTES</label>
													<div>

														<input type="text" id="notes" th:field="*{notes}"
															th:value="${projectMaster['notes']}"
															class="form-control  capitalize">
													</div>
												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="startdateX1">
														Project In Date</label>
													<div>

														<input type="text" id="startdateX1"
															th:field="*{startdate}"
															th:value="${projectMaster['startdate']}"
															class="form-control  capitalize">
													</div>
												</div>
												<div class="col-12 col-md-6">
													<label class="form-label" for="expectedclosingdate">
														Due Date</label>
													<div>

														<input type="text" id="expectedclosingdate"
															th:field="*{expectedclosingdate}"
															th:value="${projectMaster['expectedclosingdate']}"
															class="form-control  capitalize">
													</div>
												</div>


												<div class="col-12 text-center mt-4">
													<button type="submit"
														class="btn btn-primary editorganizationdatasubmit me-sm-3 me-1">Update</button>
													<button type="button"
														class="btn btn-label-secondary editorganizationdataclose"
														data-bs-dismiss="modal" aria-label="Close">Cancel</button>
												</div>
											</form>
										</div>
									</div>
								</div>
							</div>
							<!--/ Edit User Modal -->
							<!-- Edit People Modal -->
							<div class="modal fade" id="addNewperson" tabindex="-1"
								aria-hidden="true">
								<div
									class="modal-dialog modal-dialog-centered1 modal-simple modal-add-new-cc">
									<div class="modal-content p-3 p-md-5">

										<div class="modal-body">
											<button type="button" class="btn-close"
												data-bs-dismiss="modal" aria-label="Close"></button>
											<div class="text-center mb-4">
												<h3>Create People Information</h3>
												<p>Update People Basic Information</p>
											</div>
											<form id="editPeopledetailsForm"
												class="row g-3 needs-validation" onsubmit="return false">

												<div class="col-12 ">


													<label class="form-label" for="Model_peoplename">Name</label>
													<input type="text" class="form-control"
														id="Model_peoplename" required />
													<div class="invalid-feedback">Please enter Person
														Name.</div>
												</div>

												<div class="col-12">
													<label class="form-label" for="Model_peoplecontact">Contact
														Number </label> <input type="text"
														class="form-control phone-number-otp-mask" pattern=".{12}"
														id="Model_peoplecontact" required />
													<div class="invalid-feedback">Please enter Contact.</div>
												</div>

												<div class="col-12 text-center mt-4">
													<button type="submit"
														class="btn btn-primary editpeopledatasubmit me-sm-3 me-1">ADD</button>
													<button type="reset"
														class="btn btn-label-secondary editpeopledataclose"
														data-bs-dismiss="modal" aria-label="Close">
														Cancel</button>
												</div>
											</form>
										</div>
									</div>
								</div>
							</div>
							<!--/ Edit People Modal -->
							<!-- Edit People Modal -->
							<div class="modal fade" id="linkperson" tabindex="-1"
								aria-hidden="true">
								<div
									class="modal-dialog modal-dialog-centered1 modal-simple modal-add-new-cc">
									<div class="modal-content p-3 p-md-5">

										<div class="modal-body">
											<button type="button" class="btn-close"
												data-bs-dismiss="modal" aria-label="Close"></button>
											<div class="text-center mb-4">
												<h3>Link People Information</h3>
												<p>Update People Basic Information</p>
											</div>
											<form id="linkPeopledetailsForm" class="row g-3"
												onsubmit="return false">

												<div class="col-12 ">


													<label class="form-label" for="Model_linkpeoplename">People
														Name</label> <select class="form-select"
														aria-label="Default select example"
														id="Model_linkpeoplename" required>

														<option th:each="obj : ${contactPeopleList}"
															th:value="${obj.id}" th:text="${obj.peoplename}"></option>

													</select>

												</div>


												<div class="col-12 text-center mt-4">
													<button type="submit"
														class="btn btn-primary linkpeopledatasubmit me-sm-3 me-1">ADD</button>
													<button type="reset"
														class="btn btn-label-secondary linkpeopledataclose"
														data-bs-dismiss="modal" aria-label="Close">
														Cancel</button>
												</div>
											</form>
										</div>
									</div>
								</div>
							</div>
							<!--/ Edit People Modal -->

							<!--scrolling content Modal -->
							<div class="modal fade" id="ItemStatusScrollable" tabindex="-1"
								role="dialog" aria-labelledby="ItemStatusScrollableTitle"
								aria-hidden="true">
								<div class="modal-dialog modal-dialog-scrollable"
									role="document">
									<div class="modal-content">
										<div class="modal-header">
											<h5 class="modal-title white" id="ItemStatusScrollableTitle"></h5>
											<button type="button" class="btn-close"
												data-bs-dismiss="modal" aria-label="Close"></button>
										</div>
										<div class="modal-body">
											<div class="col-md-12">
												<div class="form-group">
													<label for="addmodel" id="additemalltxt"></label>
													<div class="position-relative">
														<fieldset class="form-group">
															<input type="text" id="additemall" name="addmodel"
																class="form-control capitalize">
														</fieldset>
													</div>
												</div>
											</div>

										</div>
										<div class="modal-footer">
											<button type="button" class="btn btn-light-secondary"
												data-bs-dismiss="modal">
												<i class="bx bx-x d-block d-sm-none"></i> <span
													class="d-none d-sm-block">Close</span>
											</button>
											<button type="button" class="btn btn-primary ml-1"
												id="additemallsavebtn">
												<i class="bx bx-check d-block d-sm-none"></i> <span
													class="d-none d-sm-block">ADD</span>
											</button>
										</div>
									</div>
								</div>
							</div>
							<!--scrolling content Modal -->

							<!-- /Modal -->

						</div>
						<!-- / Content -->

						<!-- Footer -->
						<footer class="content-footer footer bg-footer-theme">
							<div
								class="container-fluid d-flex flex-wrap justify-content-between py-2 flex-md-row flex-column">
								<div class="mb-2 mb-md-0"></div>
								<div></div>
							</div>

						</footer>
						<!-- / Footer -->

						<div class="content-backdrop fade"></div>
					</div>
					<!-- Content wrapper -->
				</div>
				<!-- / Layout page -->
			</div>

			<!-- Overlay -->
			<div class="layout-overlay layout-menu-toggle"></div>

			<!-- Drag Target Area To SlideIn Menu On Small Screens -->
			<div class="drag-target"></div>
		</div>
		<!-- / Layout wrapper -->


		<!-- Core JS -->
		<!-- build:js assets/vendor/js/core.js -->
		<script th:src="@{/assets/vendor/libs/jquery/jquery.js}"></script>
		<script th:src="@{/assets/vendor/libs/popper/popper.js}"></script>
		<script th:src="@{/assets/vendor/js/bootstrap.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js}"></script>

		<script th:src="@{/assets/vendor/libs/hammer/hammer.js}"></script>

		<script th:src="@{/assets/vendor/libs/i18n/i18n.js}"></script>
		<script th:src="@{/assets/vendor/libs/typeahead-js/typeahead.js}"></script>

		<script th:src="@{/assets/vendor/js/menu.js}"></script>
		<!-- endbuild -->

		<!-- Vendors JS -->
		<script th:src="@{/assets/vendor/libs/moment/moment.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables/jquery.dataTables.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-bs5/datatables-bootstrap5.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-responsive/datatables.responsive.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons/datatables-buttons.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.js}"></script>
		<script th:src="@{/assets/vendor/libs/jszip/jszip.js}"></script>
		<script th:src="@{/assets/vendor/libs/pdfmake/pdfmake.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons/buttons.html5.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons/buttons.print.js}"></script>
		<script th:src="@{/assets/vendor/libs/sweetalert2/sweetalert2.js}"></script>
		<script th:src="@{/assets/vendor/libs/cleavejs/cleave.js}"></script>
		<script th:src="@{/assets/vendor/libs/cleavejs/cleave-phone.js}"></script>
		<script th:src="@{/assets/vendor/libs/select2/select2.js}"></script>

		<!-- Main JS -->
		<script th:src="@{/assets/js/main.js}"></script>

		<!-- Flat Picker -->
		<script th:src="@{/assets/vendor/libs/moment/moment.js}"></script>
		<script th:src="@{/assets/vendor/libs/flatpickr/flatpickr.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/jquery-timepicker/jquery-timepicker.js}"></script>
		<script th:src="@{/assets/vendor/libs/pickr/pickr.js}"></script>
		<script th:src="@{/assets/vendor/libs/tagify/tagify.js}"></script>
		<script th:src="@{/assets/js/forms-selects.js}"></script>
		<!-- Page JS -->
		<!-- <script th:src="@{/assets/js/modal-edit-user.js}"></script> -->
		<script th:src="@{/assets/js/app-user-view.js}"></script>
		<script th:src="@{/assets/js/app-user-view-account.js}"></script>

		<script th:src="@{/assets/js/ui-popover.js}"></script>

		<script>
		var invoiceIncre=1;
		
			$(document)
					.ready(
							function() {
							
								//--------------------------------------------------------------------------------------------------------------------------------------
								var ids="[[${projectMaster['id']}]]";
								$("#mastercategoryid").val(ids);
								
								var NATUREOFWORK="[[${NATUREOFWORK}]]";
								var UNITS="[[${UNITS}]]";
								
								NATUREOFWORK_temp="";
								
								var array = NATUREOFWORK.replace("[","").replace("]","").split(",");
								for(i=0;i<array.length;i++){
									NATUREOFWORK_temp += "<option value='" +array[i] + "'>"+array[i] + "</option>";
								}
								
								UNITS_temp="";
								var array = UNITS.replace("[","").replace("]","").split(",");
								for(i=0;i<array.length;i++){
									UNITS_temp += "<option value='" +array[i] + "'>"+array[i] + "</option>";
								}
								
   
							        
								var projectfollowerids="[[${projectMaster['projectfollowerids']}]]";
								$("#followers").val(projectfollowerids.split(",")).change();
								
								
								//--------------------------------------------------------------------------------------------------------------------------------------		 		

								$(function() {
									var token = $("meta[name='_csrf']").attr(
											"content");
									var header = $("meta[name='_csrf_header']")
											.attr("content");
									$(document).ajaxSend(
											function(e, xhr, options) {
												xhr.setRequestHeader(header,
														token);
											});
								});
								// --------------------------------------------------------------------
								
								
								
								
								//--------------------------------------------------------------------------------------------------------------------------------------		
								$(".Referencediv").hide();
								if($("#Source").val()=='Referral')
								{
									$(".Referencediv").show();
								}else
								{
									$(".Referencediv").hide();
								}
								
								$('#Source').change(function(){
									
									if($(this).val()=='Referral')
									{
										$(".Referencediv").show();
									}else
									{
										$(".Referencediv").hide();
									}
								});
								//--------------------------------------------------------------------------------------  

								function validationformreset() {

									$('.editorganizationdataclose').click();
									$('.editorganizationdatasubmit').prop(
											"disabled", false);
									$('.editorganizationdatasubmit').html(
											"Submit");
								}
								function validationlinkformreset() {
									$('.linkpeopledataclose').click();
									$('.linkpeopledatasubmit').prop("disabled",
											false);
									$('.linkpeopledatasubmit').html("Submit");
								}
								function validationformprojectreset()
								   {
							   				$('.projectprojectclose').click();
							   				$('.projectprojectsave').prop("disabled",false);
								   			$('.projectprojectsave').html("Submit");
								   }
								
								function validationinvoiceformreset()
								   {
							   				$('.editInvoiceclose').click();
							   				$('.editInvoicesubmit').prop("disabled",false);
							   				
							   				invoiceIncre=1;
							   				html='<div class="d-flex border rounded position-relative pe-0 incontact'+ invoiceIncre + '"> <div class="row w-100 m-0 p-3"> 	<div class="col-md-4 col-12 mb-md-0 mb-3 ps-md-0"> <p class="mb-2 repeater-title">Item Description</p> <input type="hidden" id="InvoiceItemid'+ invoiceIncre +'" name="InvoiceItemid'+ invoiceIncre +'" /> <select class="form-select item-details mb-2" id="InvoiceItem'+ invoiceIncre +'" name="InvoiceItem'+ invoiceIncre +'" required> <option value="">-</option> ' + NATUREOFWORK_temp + '</select> <textarea class="form-control" rows="2" id="Description'+ invoiceIncre +'" name="Description'+ invoiceIncre +'" placeholder="Item Information"></textarea> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Qty</p> <input type="number"  step="any" class="form-control invoice-item-qty"  min="1" max="500" id="Quantity'+ invoiceIncre +'" name="Quantity'+ invoiceIncre +'" onchange="invoiceamountCalculator()" required /> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Unit</p> <select class="form-select item-details mb-2" id="Unit'+ invoiceIncre +'" name="Unit'+ invoiceIncre +'" required> <option value="">-</option> '+ UNITS_temp +'  </select> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Price</p> <input type="number" class="form-control invoice-item-price mb-2" onchange="invoiceamountCalculator()" id="Price'+ invoiceIncre +'" name="Price'+ invoiceIncre +'" required/> <input type="hidden" id="Discountperip'+ invoiceIncre +'" value="0" name="Discountper'+ invoiceIncre +'" /> <input type="hidden" id="CGSTperip'+ invoiceIncre +'" value="0" name="CGSTper'+ invoiceIncre +'" /> <input type="hidden" id="IGSTperip'+ invoiceIncre +'" value="0" name="IGSTper'+ invoiceIncre +'" /> <input type="hidden" id="SGSTperip'+ invoiceIncre +'" value="0" name="SGSTper'+ invoiceIncre +'" /> 	 <div>  <span  data-bs-toggle="tooltip"  data-bs-offset="0,4" data-bs-placement="right" data-bs-html="true"	title="Discount %"	class="discount me-2" id="Discountpertxt'+  invoiceIncre +'">0%</span> <span class="tax-1 me-2" data-bs-toggle="tooltip" 	data-bs-placement="top" title="CGST %" 	id="CGSTpertxt'+  invoiceIncre +'">0%</span> <span class="tax-2" 	data-bs-toggle="tooltip" data-bs-placement="top" 	title="SGST %" id="SGSTpertxt'+  invoiceIncre +'">0%</span> <span 	class="tax-2" data-bs-toggle="tooltip" 	data-bs-placement="top" title="IGST %" 	id="IGSTpertxt'+  invoiceIncre +'">0%</span> </div> 	</div> 	<div class="col-md-2 col-12 pe-0"> <p class="mb-2 repeater-title">Taxable Amount</p> <p class="mb-0" id="taxableamount'+  invoiceIncre +'">0.00</p> 	</div> </div> <div 	class="d-flex flex-column align-items-center justify-content-between border-start p-2"> 	<i class="bx bx-x fs-4 text-muted cursor-pointer" onclick="deleteinvoiceItem('+ invoiceIncre +')"></i> 	<div class="dropdown"> <i class="bx bx-cog bx-xs text-muted cursor-pointer more-options-dropdown" role="button" id="dropdownMenuButton" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false"> </i> <div class="dropdown-menu dropdown-menu-end w-px-300 p-3" aria-labelledby="dropdownMenuButton"> <div class="row g-3"> 	<div class="col-12"> <label for="discountInput" class="form-label">Discount(%)</label> <input type="number" class="form-control" id="Discountper'+ invoiceIncre +'" min="0" max="100" /> 	</div> 	<div class="col-md-6"> <label for="taxInput1" class="form-label">CGST % 1</label> <select id="CGSTper'+ invoiceIncre +'" class="form-select tax-select CGST"> <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> 	<div class="col-md-6"> <label for="taxInput2" class="form-label">SGST % 2</label> <select id="SGSTper'+ invoiceIncre +'" class="form-select tax-select SGST"> <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> 	<div class="col-md-12"> <label for="taxInput2" class="form-label">IGST % 2</label> <select id="IGSTper'+ invoiceIncre +'" class="form-select tax-select IGST"  onchange="IGSTchange('+ invoiceIncre +')"> <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> </div> <div class="dropdown-divider my-3"></div> <button type="button" onclick="applydiscountandtax(this)" name="'+ invoiceIncre + '"	class="btn btn-label-primary btn-apply-changes">Apply</button> </div> 	</div> </div> </div>';
											$('#invoiceitemlist').html(html);
							   				
							   				invoiceamountCalculator();
								   			$('.editInvoicesubmit').html("Save");
								   			
								   }
								
								function validationreceiptformreset()
								   {
									$('.editReceiptclose').click();
					   				$('.editReceiptsubmit').prop("disabled",false);
						   			$('.editReceiptsubmit').html("Save");
								   			
								   }
								//--------------------------------------------------------------------------------------------------------------------------------------
								$("#startdate").change(function() {
									if($('#enddate').val() ==''){
										$('#enddate').val($(this).val());
									}
								});
								$("#starttime").change(function() {
									if($('#endtime').val() ==''){
										$('#endtime').val($(this).val());
									}
								});
								 //------------------------------------------------------------------------ 
								 $('.addNewInvoicebtn').on('click', function(event){
									validationinvoiceformreset();
									$("#projectitemid").val("");
									$("#invoiceType").val("Tax Invoice").change();
									
								 });
								 
								 
								
								//--------------------------------------------------------------------------------------------------------------------------------------
								
								
								//--------------------------------------------------------------------------------------------------------------------------------------
								$('#editinvoiceformx').on('submit',function(event) {
									if (event.target.checkValidity()) {
										$('.editInvoicesubmit').prop("disabled",true);
										$('.editInvoicesubmit').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
										const formData = new FormData(document.querySelector("#editinvoiceformx"));
										formData.append("projectid","[[${projectMaster['id']}]]");
										formData.append("invoiceitemcount", invoiceIncre);
										
										$.ajax({
											type : "POST",
											url : "projectinvoicesave",
											processData : false,
											contentType : false,
											data : formData,
											success : function(
													result) {
												
												validationinvoiceformreset();
												
												getinvoicelist();

											},
											error : function(e) {
												console.log("Error"+ e);
											}
										});
									} else {
										$('.editInvoicesubmit').prop("disabled",false);
									}
								});
								// --------------------------------------------------------------------
								
								$("#addnewinvoiceitem").click(function() {
									invoiceIncre = invoiceIncre+1;
									
									html='<div class="d-flex border rounded position-relative pe-0 incontact'+ invoiceIncre + '"> <div class="row w-100 m-0 p-3"> 	<div class="col-md-4 col-12 mb-md-0 mb-3 ps-md-0"> <p class="mb-2 repeater-title">Item Description</p> <input type="hidden" id="InvoiceItemid'+ invoiceIncre +'" name="InvoiceItemid'+ invoiceIncre +'" /> <select class="form-select item-details mb-2" id="InvoiceItem'+ invoiceIncre +'" name="InvoiceItem'+ invoiceIncre +'" required> <option value="">-</option> ' + NATUREOFWORK_temp + '</select> <textarea class="form-control" rows="2" id="Description'+ invoiceIncre +'" name="Description'+ invoiceIncre +'" placeholder="Item Information"></textarea> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Qty</p> <input type="number" step="any" class="form-control invoice-item-qty"  min="1" max="500" id="Quantity'+ invoiceIncre +'" name="Quantity'+ invoiceIncre +'" onchange="invoiceamountCalculator()" required /> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Unit</p> <select class="form-select item-details mb-2" id="Unit'+ invoiceIncre +'" name="Unit'+ invoiceIncre +'" required> <option value="">-</option> '+ UNITS_temp +'  </select> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Price</p> <input type="number" class="form-control invoice-item-price mb-2" onchange="invoiceamountCalculator()" id="Price'+ invoiceIncre +'" name="Price'+ invoiceIncre +'" required/> <input type="hidden" id="Discountperip'+ invoiceIncre +'" value="0" name="Discountper'+ invoiceIncre +'" /> <input type="hidden" id="CGSTperip'+ invoiceIncre +'" value="0" name="CGSTper'+ invoiceIncre +'" /> <input type="hidden" id="IGSTperip'+ invoiceIncre +'" value="0" name="IGSTper'+ invoiceIncre +'" /> <input type="hidden" id="SGSTperip'+ invoiceIncre +'" value="0" name="SGSTper'+ invoiceIncre +'" /> 	 <div>  <span  data-bs-toggle="tooltip" data-bs-placement="top" 	title="Discount %"	class="discount me-2" id="Discountpertxt'+  invoiceIncre +'">0%</span> <span class="tax-1 me-2" data-bs-toggle="tooltip" 	data-bs-placement="top" title="CGST %" 	id="CGSTpertxt'+  invoiceIncre +'">0%</span> <span class="tax-2" 	data-bs-toggle="tooltip" data-bs-placement="top" 	title="SGST %" id="SGSTpertxt'+  invoiceIncre +'">0%</span> <span 	class="tax-2" data-bs-toggle="tooltip" 	data-bs-placement="top" title="IGST %" 	id="IGSTpertxt'+  invoiceIncre +'">0%</span> </div> 	</div> 	<div class="col-md-2 col-12 pe-0"> <p class="mb-2 repeater-title">Taxable Amount</p> <p class="mb-0" id="taxableamount'+  invoiceIncre +'">0.00</p> 	</div> </div> <div 	class="d-flex flex-column align-items-center justify-content-between border-start p-2"> 	<i class="bx bx-x fs-4 text-muted cursor-pointer" onclick="deleteinvoiceItem('+ invoiceIncre +')"></i> 	<div class="dropdown"> <i class="bx bx-cog bx-xs text-muted cursor-pointer more-options-dropdown" role="button" id="dropdownMenuButton" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false"> </i> <div class="dropdown-menu dropdown-menu-end w-px-300 p-3" aria-labelledby="dropdownMenuButton"> <div class="row g-3"> 	<div class="col-12"> <label for="discountInput" class="form-label">Discount(%)</label> <input type="number" class="form-control" id="Discountper'+ invoiceIncre +'" min="0" max="100" /> 	</div> 	<div class="col-md-6"> <label for="taxInput1" class="form-label">CGST % 1</label> <select id="CGSTper'+ invoiceIncre +'" class="form-select tax-select CGST"> <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> 	<div class="col-md-6"> <label for="taxInput2" class="form-label">SGST % 2</label> <select id="SGSTper'+ invoiceIncre +'" class="form-select tax-select SGST"> <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> 	<div class="col-md-12"> <label for="taxInput2" class="form-label">IGST % 2</label> <select id="IGSTper'+ invoiceIncre +'" class="form-select tax-select IGST" onchange="IGSTchange('+ invoiceIncre +')"> <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> </div> <div class="dropdown-divider my-3"></div> <button type="button" onclick="applydiscountandtax(this)" name="'+ invoiceIncre + '"	class="btn btn-label-primary btn-apply-changes">Apply</button> </div> 	</div> </div> </div>';
									$('#invoiceitemlist').append(html);
									$('#invoiceType').change();
								});
								
								//--------------------------------------------------------------------------------------------------------------------------------------
								$('#editreceiptformx').on('submit',function(event) {
									if (event.target.checkValidity()) {
										$('.editReceiptsubmit').prop("disabled",true);
										$('.editReceiptsubmit').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
										const formData = new FormData(document.querySelector("#editreceiptformx"));
										formData.append("projectid","[[${projectMaster['id']}]]");
										
										$.ajax({
											type : "POST",
											url : "projectreceiptsave",
											processData : false,
											contentType : false,
											data : formData,
											success : function(
													result) {
												
												validationreceiptformreset();
												
												getreceiptlist();

											},
											error : function(e) {
												console.log("Error"+ e);
											}
										});
									} else {
										$('.editReceiptsubmit').prop("disabled",false);
									}
								});
								// --------------------------------------------------------------------
								
								
								
								
								//--------------------------------------------------------------------------------------------------------------------------------------
								$('#editprojectMasterdetailsForm').on('submit',function(event) {

													if (event.target.checkValidity()) {
														$('.editorganizationdatasubmit').prop("disabled",true);
														$('.editorganizationdatasubmit').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
														const formData = new FormData(document.querySelector("#editprojectMasterdetailsForm"));
														
														formData.append("followers",$("#followers").val());
														/* for (var pair of formData.entries()) {
														   console.log(pair); 
														} */
														$.ajax({
																	type : "POST",
																	url : "projectsavestage2",
																	processData : false,
																	contentType : false,
																	data : formData,
																	success : function(result) {
																		var bmobj = JSON.parse(JSON.stringify(result));
																		console.log(bmobj);
																			$('#Lbl_ProjectID').text("PROJECT ID :"+bmobj.projectID);
																			$('#Lbl_Title').text(bmobj.title);
																			$('#Lbl_Source').text(bmobj.source);
																			$('#Lbl_pipeline').text(bmobj.pipeline);
																			$('#Lbl_notes').text(bmobj.notes);
																			$('#Lbl_Reference').text(bmobj.referencename);
																			$("#Lbl_organization").text(bmobj.organizationName);
																			$("#Lbl_projectvalue").text(bmobj.projectvalue);
																			$("#Lbl_purpose").text(bmobj.purpose);
																			$("#Lbl_branchname").text(bmobj.branchname);
																			$("#Lbl_expectedclosingdate").text(bmobj.expectedclosingdateMMddYYY);
																			$("#Lbl_expectedstartdate").text(bmobj.expectedstartdateMMddYYY);
																			$("#Lbl_board").text(bmobj.boardName);	
																			
																			if (bmobj.label == "Hot") {
																				$('#Lbl_label').html("<span class='badge bg-danger'>Hot</span>");
																			} else if (bmobj.label == "Warm") {
																				$('#Lbl_label').html("<span class='badge bg-warning'>Warm</span>");
																			} else {
																				$('#Lbl_label').html("<span class='badge bg-primary'>Cold</span>");
																			}
																			
																			$("#Lbl_Status").text(bmobj.status);	
																			$("#Lbl_NatureofWork").text(bmobj.natureofWork);	
																			$("#Lbl_Area").text(bmobj.area);	
																			$("#Lbl_UNITS").text(bmobj.units);	
																			$("#Lbl_Location").text(bmobj.location);	
																			$("#Lbl_tdate").text(bmobj.tdateMMddYYY);	
																			
																			
																			$name ="";
																			
																			bmobj.projectFollowers.forEach((element, index, array) =>
																           	{
																           	    $name += element.followername+ "<br>";
																            });
																           	$('#Lbl_follower').html($name);
																           	
																			$('.editorganizationdataclose').click();
																			$('.editorganizationdatasubmit').prop("disabled",false);
																			$('.editorganizationdatasubmit').html("Submit");
																		

																	},
																	error : function(
																			e) {
																		console
																				.log("Error"
																						+ e);
																	}
																});
													} else {
														$(
																'.editorganizationdatasubmit')
																.prop(
																		"disabled",
																		false);
													}

												});
								// --------------------------------------------------------------------
								
								// --------------------------------------------------------------------
								$(".additem").click(function() {
									var name = $(this).attr('name');
									var labeltext = "";
									if (name == "addmodalcontacttype") {
										labeltext = "New Contact Type";
									} else if (name == "addmodaldocumenttype") {
										labeltext = "New Document Type";
									} else if (name == "addModel_Source") {
										labeltext = "New Industry Type";
									}else if (name == "addpurposedata") {
										labeltext = "New Purpose";
									}
									
									

									$('#additemalltxt').text(labeltext);
									$('#ItemStatusScrollable').modal('toggle');

								});

								$("#additemallsavebtn")
										.click(
												function() {
													if ($("#additemall").val() != '') {
														var name = $(
																'#additemalltxt')
																.text();
														var labeltext = "";
														if (name == "New Contact Type") {
															labeltext = "modalcontacttype";
														} else if (name == "New Document Type") {
															labeltext = "modalDocumenttype";
														} else if (name == "New Industry Type") {
															labeltext = "addModel_Source";
														} else if (name == "New Purpose") {
															labeltext = "addpurposedata";
														}

														$('.' + labeltext)
																.append(
																		"<option value='"
																				+ $(
																						"#additemall")
																						.val()
																				+ "'>"
																				+ $(
																						"#additemall")
																						.val()
																				+ "</option>");
														//$('.' + labeltext).val($("#additemall").val());
														$("#additemall")
																.val('');
														$(
																'#ItemStatusScrollable')
																.modal('toggle');
													}
												});

								// --------------------------------------------------------------------

								function validationformreset() {
									$('.editpeopledataclose').click();
									$('.editpeopledatasubmit').prop("disabled",
											false);
									$('.editpeopledatasubmit').html("Submit");
								}
								// ----------------------------------------------------------------------------------------------------------------------------------------
								function getinvoicelist() {
									
									var formData = {
										mastercategoryid : "[[${projectMaster['id']}]]"
									}
	
									$.ajax({
										type : "POST",
										url : "getprojectinvoicelist",
										data : formData,
										success : function(result) {
											var htmlop="";
											var bmobj = JSON.parse(JSON.stringify(result));
											var total=0;
											//console.log(bmobj);
											
											bmobj.forEach((element, index, array) =>
								           	{
								           		var sub_total=0;
								           	  
								           		element.invoiceItemMasterlist.forEach((elementx, indexx, arrayx) =>
									           	  {
									           		sub_total +=elementx.taxableAmount + elementx.cgstamount + elementx.sgstamount+ elementx.igstamount; 
									           	  });
									           	  
									           	 htmlop +="<tr><td class='text-nowrap editprojectprj' onclick='editinvoiceinfo(this)' id='"+element.invoiceid +"'>"+element.invoiceNo+"</td>";
									           	 htmlop +="<td class='text-nowrap'>"+element.invoiceType +"</td><td class='text-nowrap'>"+element.invoiceDateMMMddyyyy +"</td><td>"+element.dueDateMMMddyyyy +"</td>";
									           	 htmlop +="<td>"+sub_total.toFixed(2) +" <i class='bx bx-money  generatenewreceipt' onclick='generatereceipt("+element.invoiceid +")'  ></i></td></tr>";
									           	 total +=parseFloat(sub_total);
								            });
											
											 htmlop += "<tr> <td colspan='3' class='align-top px-4 py-3'> </td> <td class='text-end px-4 py-3'> <p class='mb-0'>Total:</p> </td>  <td class='px-4 py-3'> <p class='fw-semibold mb-0'>Rs. "+ total.toFixed(2) +"</p> </td> </tr>";
												
											$('#projectinvoicelist').html(htmlop);
										},
										error : function(e) {
											console.log("Error" + e);
	
										}
	
									});
	
								}
								
								
								// ----------------------------------------------------------------------------------------------------------------------------------------
								function getreceiptlist() {
									
									var formData = {
										mastercategoryid : "[[${projectMaster['id']}]]"
									}
	
									$.ajax({
										type : "POST",
										url : "getprojectreceiptlist",
										data : formData,
										success : function(result) {
											var htmlop="";
											var bmobj = JSON.parse(JSON.stringify(result));
											var total=0;
											//console.log(bmobj);
											
											bmobj.forEach((element, index, array) =>
								           	{
								           		var sub_total=0;
								           	  
								           		
									           	 htmlop +="<tr><td class='text-nowrap editprojectprj' onclick='editreceiptinfo(this)' id='"+element.recepitid +"'>"+element.recepitNo+"</td>";
									           	 htmlop +="<td class='text-nowrap'>"+element.invoiceNo +"</td><td class='text-nowrap'>"+element.recepitDateMMMddyyyy +"</td><td>"+element.depositedto_txt +"</td>";
									           	 htmlop +="<td>"+element.amount.toFixed(2) +"</td></tr>";
									           	 total +=parseFloat(element.amount);
								            });
											
											 htmlop += "<tr> <td colspan='3' class='align-top px-4 py-3'> </td> <td class='text-end px-4 py-3'> <p class='mb-0'>Total:</p> </td>  <td class='px-4 py-3'> <p class='fw-semibold mb-0'>Rs. "+ total.toFixed(2) +"</p> </td> </tr>";
												
											$('#receiptslist').html(htmlop);
										},
										error : function(e) {
											console.log("Error" + e);
	
										}
	
									});
	
								}
								// ----------------------------------------------------------------------------------------------------------------------------------------
								$('#editPeopledetailsForm')
										.on(
												'submit',
												function(event) {

													if (event.target
															.checkValidity()) {
														$(
																'.editpeopledatasubmit')
																.prop(
																		"disabled",
																		true);
														$(
																'.editpeopledatasubmit')
																.html(
																		'<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');

														var projectMasterID = $(
																'#projectMasterID')
																.val();
														var peoplename = $(
																'#Model_peoplename')
																.val();
														var phonenumber = $(
																'#Model_peoplecontact')
																.val();
														var branch = $(
																"#branch")
																.val();
														var followers = $(
																"#followers")
																.val();
														var organization = $(
																"#organization")
																.val();
														var formData = {
															id : projectMasterID,
															category : 'Project',
															organization : organization,
															branch : branch,
															peoplename : peoplename,
															phonenumber : phonenumber,
															followers : followers

														}
														$
																.ajax({
																	type : "POST",
																	url : "workcontactpersonsavejson",
																	data : formData,
																	success : function(
																			result) {
																		validationformreset();
																		var bmobj = JSON
																				.parse(JSON
																						.stringify(result));

																		let temphtml = '<div class="d-flex mb-3"> <div class="flex-grow-1 row dcon'+result+'"> <div class="col-6 mb-sm-0 mb-2"> <a href="contactpersonview?id='
																		+ bmobj
																		+ '" target="_blank"> <h6 class="mb-0">'
																		+ peoplename
																		+ '</h6></a> <small class="text-muted">'
																		+ phonenumber
																		+ '</small> </div> <div class="col-3 text-end"> <label class="switch me-0"> <input type="checkbox" class="switch-input" name="'
																		+ result
																		+ '" onclick="makeprimarycontactperson(this)"/> <span class="switch-toggle-slider"> <span class="switch-on"> <i class="bx bx-check"></i> </span> <span class="switch-off"> <i class="bx bx-x"></i> </span> </span> <span class="switch-label"></span> </label> </div> '
																		+ '<div class="col-3"> 		<div class="dropdown">   <button     class="btn p-0"     type="button"     id="salesReport"     data-bs-toggle="dropdown"     aria-haspopup="true"     aria-expanded="false"   >     <i class="bx bx-dots-vertical-rounded"></i>   </button>   <div class="dropdown-menu dropdown-menu-end" aria-labelledby="salesReport">     <a class="dropdown-item" name="' + result +'" 	onclick="removecontactperson(this)">Unlink</a>       </div>     </div> 	 </div>  </div> </div>';
																
																		$(
																				'#contactpeopprojectdidv')
																				.before(
																						temphtml);

																	},
																	error : function(
																			e) {
																		console
																				.log("Error"
																						+ e);

																	}

																});

													} else {
														$(
																'.editpeopledatasubmit')
																.prop(
																		"disabled",
																		false);
													}

												});
								// --------------------------------------------------------------------
								$('#linkPeopledetailsForm')
										.on(
												'submit',
												function(event) {

													if (event.target
															.checkValidity()) {
														$(
																'.linkpeopledatasubmit')
																.prop(
																		"disabled",
																		true);
														$(
																'.linkpeopledatasubmit')
																.html(
																		'<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
														var projectMasterID = $(
																'#projectMasterID')
																.val();
														var linkpeoplename = $(
																'#Model_linkpeoplename')
																.val();

														var formData = {
															id : projectMasterID,
															category : 'Project',
															linkpeoplename : linkpeoplename,

														}
														$
																.ajax({
																	type : "POST",
																	url : "workcontactlinkpersonsavejson",
																	data : formData,
																	success : function(
																			result) {

																		var bmobj = JSON
																				.parse(JSON
																						.stringify(result));
																		let primarymob = ""
																		if (bmobj.primarymob != null) {
																			primarymob = bmobj.primarymob;
																		}

																		let temphtml = '<div class="d-flex mb-3"> <div class="flex-grow-1 row dcon'+bmobj.id+'"> <div class="col-6 mb-sm-0 mb-2"> <a href="contactpersonview?id='
																		+ bmobj.id
																		+ '" target="_blank"> <h6 class="mb-0">'
																		+ bmobj.peoplename
																		+ '</h6></a> <small class="text-muted">'
																		+ primarymob
																		+ '</small> </div> <div class="col-3 text-end"> <label class="switch me-0"> <input type="checkbox" class="switch-input" name="'
																		+ bmobj.id
																		+ '" onclick="makeprimarycontactperson(this)"/> <span class="switch-toggle-slider"> <span class="switch-on"> <i class="bx bx-check"></i> </span> <span class="switch-off"> <i class="bx bx-x"></i> </span> </span> <span class="switch-label"></span> </label> </div> '
																		+ '<div class="col-3"> 		<div class="dropdown">   <button     class="btn p-0"     type="button"     id="salesReport"     data-bs-toggle="dropdown"     aria-haspopup="true"     aria-expanded="false"   >     <i class="bx bx-dots-vertical-rounded"></i>   </button>   <div class="dropdown-menu dropdown-menu-end" aria-labelledby="salesReport">     <a class="dropdown-item" name="' + bmobj.id +'" 	onclick="removecontactperson(this)">Unlink</a>       </div>     </div> 	 </div> </div> </div>';
																		$(
																				'#contactpeopprojectdidv')
																				.before(
																						temphtml);
																		validationlinkformreset();
																	},
																	error : function(
																			e) {
																		console
																				.log("Error"
																						+ e);

																	}

																});

													} else {
														$(
																'.linkpeopledatasubmit')
																.prop(
																		"disabled",
																		false);
													}

												});
								
								
								//-------------------------------------------
								function calctotalamount(){
									let modalQuantity=	$("#modalQuantity").val();
									let modalPrice=	$("#modalPrice").val();
									
									if(modalPrice !='' && modalQuantity!=''){
										$("#modalTotalamount").val((modalPrice * modalQuantity));	
									}
									
								}
								
								$("#modalQuantity").change(function(){
									
									calctotalamount();
								});
							
								
								$("#modalPrice").change(function(){
									calctotalamount();
								});
								//-------------------------------------------
								$(document).ready(function(){
								    setTimeout(function(){
								    	
								    	getinvoicelist();
								    	getreceiptlist();
								    	
								    	
								    	
								     },500); // milliseconds
								     
								   
								});
								//-------------------------------------------
								/* $('#receivable').change(function() {
									var currentDate = new Date();
									alert(currentDate);
									currentDate.setDate(currentDate.getDate() + $(this).val());
									var options = { year: 'numeric', month: '2-digit', day: '2-digit' };
									var formattedDate = currentDate.toLocaleDateString('en-CA', options).replace(/\//g, '-');

									alert(formattedDate);
									$("#dueDate").val(formattedDate);
								}); */
								//-------------------------------------------
								$('#sameasInvoiceto').change(function() {
							        if(this.checked) {
							         $("#billaddressline1").val($("#invoiceaddressline1").val());
							         $("#billaddressline2").val($("#invoiceaddressline2").val());
							         $("#billaddresscity").val($("#invoiceaddresscity").val());
							         $("#billaddressState").val($("#invoiceaddressState").val());
							         $("#billaddresspincode").val($("#invoiceaddresspincode").val());
							         $("#billGSTNo").val($("#invoiceGSTNo").val());
							        }							              
							    });

								
								//-------------------------------------------
								$('#payfull').change(function() {
							        if(this.checked) {
							        	$("#amount").val($('#invoiceBalancetxt').text());
							        	
							        }
								});
								//--------------------------------------------
								
								//$("#invoicemodel").modal('toggle');
							}); // Jquery

			//------------------------------------------------------
			function makeprimarycontactperson(elem) {

				var formData = {
					personid : elem.getAttribute("name"),
					primarystatus : elem.checked
				}
				$.ajax({
					type : "POST",
					url : "makeprimarycontactperson",
					data : formData,
					success : function(result) {

					},
					error : function(e) {
						console.log("Error" + e);
					}
				});
			}
			//------------------------------------------------------
			function removecontactperson(elem) {

				Swal.fire({
		             title: 'Are you sure?',
		             text: "You won't be able to revert this!",
		             icon: 'warning',
		             showCancelButton: true,
		             confirmButtonText: 'Yes, delete it!',
		             customClass: {
		               confirmButton: 'btn btn-primary me-3',
		               cancelButton: 'btn btn-label-secondary'
		             },
		             buttonsStyling: false
		           }).then(function (result) {
		             if (result.value) {
								var formData = {
									personid : elem.getAttribute("name"),
									projectMasterID: $("#projectMasterID").val(),
									module : "Project"
								}
								$.ajax({
									type : "POST",
									url : "unlinkcontactperson",
									data : formData,
									success : function(result) {
									 $(".dcon"+elem.getAttribute("name")).remove();
									},
									error : function(e) {
										console.log("Error" + e);
									}
								});
								
		             }
					});
			}
			//------------------------------------------------------    
			 // Date Format
			   const flatpickrFriendly = document.querySelector('#expectedclosingdate');
				 // Human Friendly
				  if (flatpickrFriendly) {
				    flatpickrFriendly.flatpickr({
				      altInput: true,
				      altFormat: 'F j, Y',
				      dateFormat: 'Y-m-d'
				    });
				  }
				 
				  const expectedstartdateX1 = document.querySelector('#startdateX1');
					 // Human Friendly
					  if (expectedstartdateX1) {
						  expectedstartdateX1.flatpickr({
					      altInput: true,
					      altFormat: 'F j, Y',
					      dateFormat: 'Y-m-d'
					    });
					  }
					 
					 //
					 
					 const tdate = document.querySelector('#tdate');
					 // Human Friendly
					  if (tdate) {
						  tdate.flatpickr({
					      altInput: true,
					      altFormat: 'F j, Y',
					      dateFormat: 'Y-m-d'
					    });
					  }
					 
					 
				  const invoiceDate = document.querySelector('#invoiceDatex');
					 // Human Friendly
					  if (invoiceDate) {
						  invoiceDate.flatpickr({
					      altInput: true,
					      altFormat: 'F j, Y',
					      dateFormat: 'Y-m-d'
					    });
					  }
						 
				  const duedate = document.querySelector('#dueDatex');
					 // Human Friendly
					  if (duedate) {
						  duedate.flatpickr({
					      altInput: true,
					      altFormat: 'F j, Y',
					      dateFormat: 'Y-m-d'
					    });
					  }
			//----------------------------------------------------------
			// Phone
			const phoneMask = document.querySelector('.phone-number-otp-mask');

			// Phone Number Input Mask
			if (phoneMask) {
				new Cleave(phoneMask, {
					phone : true,
					phoneRegionCode : 'US'
				});
			}
			
			//------------------------------------------------------    
			 
			 function editinvoiceinfo(e){
					var projectid= e.getAttribute("id");
					
						var formData = {
							projectid : projectid,
							mastercategoryid: "[[${projectMaster['id']}]]"
						}

						$.ajax({
							type : "POST",
							url : "getinvoiceitem",
							data : formData,
							success : function(result) {
								var bmobj = JSON.parse(JSON.stringify(result));
								//console.log(bmobj);
								
								$("#invoiceid").val(bmobj.invoiceid);
								$("#invoiceNo").val(bmobj.invoiceNo);
								$("#invoiceDate").val(bmobj.invoiceDate);
								$("#dueDate").val(bmobj.dueDate);
								$("#invoiceType").val(bmobj.invoiceType).change();
								$("#receivable").val(bmobj.receivable).change();
								$("#GSTCode").val(bmobj.gstcode).change();
								$("#invoiceaddressline1").val(bmobj.invoiceaddressline1);
								$("#invoiceaddressline2").val(bmobj.invoiceaddressline2);
								$("#invoiceaddresscity").val(bmobj.invoiceaddresscity);
								$("#invoiceaddressState").val(bmobj.invoiceaddressState);
								$("#invoiceaddresspincode").val(bmobj.invoiceaddresspincode);
								//$("#invoiceMobileno").val(bmobj.invoiceMobileno);
								//$("#invoiceEmail").val(bmobj.invoiceEmail);
								$("#invoiceGSTNo").val(bmobj.invoiceGSTNo);
								$("#billaddressline1").val(bmobj.billaddressline1);
								$("#billaddressline2").val(bmobj.billaddressline2);
								$("#billaddresscity").val(bmobj.billcity);
								$("#billaddressState").val(bmobj.billstate);
								$("#billaddresspincode").val(bmobj.billpincode);
								//$("#billMobileno").val(bmobj.billMobileno);
								//$("#billEmail").val(bmobj.billEmail);
								$("#billGSTNo").val(bmobj.billGSTNo);
								$("#note").val(bmobj.notes);

								invoiceIncre = 0 ;
								html="";
								bmobj.invoiceItemMasterlist.forEach((element, index, array) =>
					           	{
					           	 	invoiceIncre= invoiceIncre+1;
									html +='<div class="d-flex border rounded position-relative pe-0 incontact'+ invoiceIncre + '"> <div class="row w-100 m-0 p-3"> 	<div class="col-md-4 col-12 mb-md-0 mb-3 ps-md-0"> <p class="mb-2 repeater-title">Item Description</p> <input type="hidden" id="InvoiceItemid'+ invoiceIncre +'" name="InvoiceItemid'+ invoiceIncre +'" value="'+ element.invoiceitemid + '"/> <select class="form-select item-details mb-2" id="InvoiceItem'+ invoiceIncre +'" name="InvoiceItem'+ invoiceIncre +'" required> <option value="'+ element.invoiceItem + '">'+ element.invoiceItem + '</option> ' + NATUREOFWORK_temp + '</select> <textarea class="form-control" rows="2" id="Description'+ invoiceIncre +'" name="Description'+ invoiceIncre +'" placeholder="Item Information">'+ element.description + '</textarea> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Qty</p> <input type="number" step="any" class="form-control invoice-item-qty"  min="1" max="500" id="Quantity'+ invoiceIncre +'" value="'+ element.quantity + '" name="Quantity'+ invoiceIncre +'" onchange="invoiceamountCalculator()" required /> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Unit</p> <select class="form-select item-details mb-2" id="Unit'+ invoiceIncre +'" name="Unit'+ invoiceIncre +'" required> <option value="'+ element.unit + '">'+ element.unit + '</option> '+ UNITS_temp +'  </select> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Price</p> <input type="number" class="form-control invoice-item-price mb-2" onchange="invoiceamountCalculator()" id="Price'+ invoiceIncre +'" name="Price'+ invoiceIncre +'"  value="'+ element.price + '" required/> <input type="hidden" id="Discountperip'+ invoiceIncre +'" value="'+ element.discountper + '" name="Discountper'+ invoiceIncre +'" /> <input type="hidden" id="CGSTperip'+ invoiceIncre +'" value="'+ element.cgstper + '" name="CGSTper'+ invoiceIncre +'" /> <input type="hidden" id="IGSTperip'+ invoiceIncre +'" value="'+ element.igstper + '" name="IGSTper'+ invoiceIncre +'" /> <input type="hidden" id="SGSTperip'+ invoiceIncre +'" value="'+ element.sgstper + '" name="SGSTper'+ invoiceIncre +'" /> 	 <div>  <span  data-bs-toggle="tooltip" data-bs-placement="top" 	title="Discount %"	class="discount me-2" id="Discountpertxt'+  invoiceIncre +'">'+ element.discountper + '%</span> <span class="tax-1 me-2" data-bs-toggle="tooltip" 	data-bs-placement="top" title="CGST %" 	id="CGSTpertxt'+  invoiceIncre +'">'+ element.cgstper + '%</span> <span class="tax-2" 	data-bs-toggle="tooltip" data-bs-placement="top" 	title="SGST %" id="SGSTpertxt'+  invoiceIncre +'">'+ element.sgstper + '%</span> <span 	class="tax-2" data-bs-toggle="tooltip" 	data-bs-placement="top" title="IGST %" 	id="IGSTpertxt'+  invoiceIncre +'">'+ element.igstper + '%</span> </div> 	</div> 	<div class="col-md-2 col-12 pe-0"> <p class="mb-2 repeater-title">Taxable Amount</p> <p class="mb-0" id="taxableamount'+  invoiceIncre +'">'+ element.taxableAmount.toFixed(2) +'</p> 	</div> </div> <div 	class="d-flex flex-column align-items-center justify-content-between border-start p-2"> 	<i class="bx bx-x fs-4 text-muted cursor-pointer" onclick="deleteinvoiceItem('+ invoiceIncre +')"></i> 	<div class="dropdown"> <i class="bx bx-cog bx-xs text-muted cursor-pointer more-options-dropdown" role="button" id="dropdownMenuButton" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false"> </i> <div class="dropdown-menu dropdown-menu-end w-px-300 p-3" aria-labelledby="dropdownMenuButton"> <div class="row g-3"> 	<div class="col-12"> <label for="discountInput" class="form-label">Discount(%)</label> <input type="number" class="form-control" id="Discountper'+ invoiceIncre +'" min="0" max="100" value="'+ element.discountper+'" /> 	</div> 	<div class="col-md-6"> <label for="taxInput1" class="form-label">CGST % 1</label> <select id="CGSTper'+ invoiceIncre +'" class="form-select tax-select CGST"> <option value="'+ element.cgstper +'" >'+ element.cgstper +'%</option> <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> 	<div class="col-md-6"> <label for="taxInput2" class="form-label">SGST % 2</label> <select id="SGSTper'+ invoiceIncre +'" class="form-select tax-select SGST"><option value="'+ element.sgstper +'" >'+ element.sgstper +'%</option>  <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> 	<div class="col-md-12"> <label for="taxInput2" class="form-label">IGST % 2</label> <select id="IGSTper'+ invoiceIncre +'" class="form-select tax-select IGST"  onchange="IGSTchange('+ invoiceIncre +')"><option value="'+ element.igstper +'" >'+ element.igstper +'%</option>  <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> </div> <div class="dropdown-divider my-3"></div> <button type="button" onclick="applydiscountandtax(this)" name="'+ invoiceIncre + '"	class="btn btn-label-primary btn-apply-changes">Apply</button> </div> 	</div> </div> </div>';
					           	});
					           	
								$('#invoiceitemlist').html(html);
								invoiceamountCalculator();
								$('#invoicemodel').modal('show');
							},
							error : function(e) {
								console.log("Error" + e);
							}
						});
					
				}
			//------------------------------------------------------
			//
			// 
			$('.invoice-item-qty').on('change',function(event) {
				invoiceamountCalculator();
				
			});
			$('.invoice-item-price').on('change',function(event) {
				invoiceamountCalculator();
				
			});
			
			//------------------------------------------------------------------------------------
			function IGSTchange(id){
				if($("#IGSTper"+ id).val()>0)
				{
					$("#CGSTper"+ id).val("0").change();
					$("#SGSTper"+ id).val("0").change();		
				}
		
			}
			//------------------------------------------------------------------------------------
			function applydiscountandtax(e){
				var rowid= e.getAttribute("name");
				
				Discountper =$("#Discountper"+ rowid).val();
				if(Discountper ==""){
					$("#Discountperip"+ rowid).val(0);
					$("#Discountpertxt"+ rowid).text("0%");
				}else{
					$("#Discountperip"+ rowid).val($("#Discountper"+ rowid).val());	
					$("#Discountpertxt"+ rowid).text($("#Discountper"+ rowid).val()+ "%");
				}
				$("#CGSTperip"+ rowid).val($("#CGSTper"+ rowid).val());
				$("#IGSTperip"+ rowid).val($("#IGSTper"+ rowid).val());
				$("#SGSTperip"+ rowid).val($("#SGSTper"+ rowid).val());
				
				
				$("#CGSTpertxt"+ rowid).text($("#CGSTper"+ rowid).val()+ "%");
				$("#IGSTpertxt"+ rowid).text($("#IGSTper"+ rowid).val()+ "%");
				$("#SGSTpertxt"+ rowid).text($("#SGSTper"+ rowid).val()+ "%");
				$('.more-options-dropdown').click();
				invoiceamountCalculator();
			}
			//------------------------------------------------------
			function generatereceipt(invoiceid)
			{
				
				$("#recepitid").val("");
				
				var formData = {
						invoiceid : invoiceid,
						mastercategoryid: "[[${projectMaster['id']}]]"
					}

					$.ajax({
						type : "POST",
						url : "getinvoicereceiptitem",
						data : formData,
						success : function(result) {
							var bmobj = JSON.parse(JSON.stringify(result));
							//console.log(bmobj);
							
							$("#invoiceNotxt").text(bmobj.Invoiceno);
							$("#duedatetxt").text(bmobj.duedate);
							$("#invoiceamounttxt").text(bmobj.amount);
							$("#invoicetotalpaidNotxt").text(bmobj.totalpaidamount);
							$("#invoiceBalancetxt").text(bmobj.balanceamount);
							$("#recinvoiceid").val(bmobj.invoiceid);
							
							$('#receiptmodel').modal('show');
						},
						error : function(e) {
							console.log("Error" + e);
						}
					});
				
			}
			//------------------------------------------------------------------------------------
			function invoiceamountCalculator(){
				totalamtwithouttax =0.00;
				totalCGST =0.00;
				totalSGST =0.00;
				totalIGST =0.00;
				totalamount =0.00;
				totaldiscountamount =0.00;
				for( i =1; i<=invoiceIncre;i++)
				{
					 price = $("#Price"+i).val();
					 qty = $("#Quantity"+i).val();
					 taxableAmount =price *  qty ;
					 
					 CGSTper = $("#CGSTperip"+i).val();
					 IGSTper = $("#IGSTperip"+i).val();
					 SGSTper = $("#SGSTperip"+i).val();
					 Discountper = $("#Discountperip"+i).val();
					 
					 Discountamt =taxableAmount * (Discountper/100);
					 afetdiscountamount =  taxableAmount -Discountamt;
					$('#taxableamount'+i).text(afetdiscountamount.toFixed(2));
					
					IGSTamount =afetdiscountamount * (IGSTper/100);
					SGSTamount =afetdiscountamount * (SGSTper/100);
					CGSTamount=afetdiscountamount * (CGSTper/100);
					
					
					totalamtwithouttax = totalamtwithouttax+afetdiscountamount;
					totalCGST =totalCGST+CGSTamount;
					totalSGST = totalSGST+SGSTamount;
					totalIGST = totalIGST+IGSTamount;
					totaldiscountamount = totaldiscountamount+Discountamt;
					
				}
				//-------------------------------------------------
				if(totaldiscountamount.toFixed(2)>0)
				{
					$('.totaldiscountamountdiv').css("visibility","visible");
					$('#totaldiscountamount').text(totaldiscountamount.toFixed(2));
				}else
				{
					$('.totaldiscountamountdiv').css("visibility","hidden");
				}
				//-------------------------------------------------
				if(totalCGST.toFixed(2)>0)
				{
					$('.totalCGSTdiv').css("visibility","visible");
					$('#totalCGST').text(totalCGST.toFixed(2));
				}else
				{
					$('.totalCGSTdiv').css("visibility","hidden");
				}
				//-------------------------------------------------
				if(totalSGST.toFixed(2)>0)
				{
					$('.totalSGSTdiv').css("visibility","visible");
					$('#totalSGST').text(totalSGST.toFixed(2));
				}else
				{
					$('.totalSGSTdiv').css("visibility","hidden");
				}
				//-------------------------------------------------
				if(totalIGST.toFixed(2)>0)
				{
					$('.totalIGSTdiv').css("visibility","visible");
					$('#totalIGST').text(totalIGST.toFixed(2));
				}else
				{
					$('.totalIGSTdiv').css("visibility","hidden");
				}
				//-------------------------------------------------
				
			
				$('#totalamount').text((totalamtwithouttax+ totalCGST + totalSGST + totalIGST).toFixed(2));
				$('#totalamtwithouttax').text(totalamtwithouttax.toFixed(2));
				
				
									
			}
			//------------------------------------------------------------------------------------
			function deleteinvoiceItem(id){
				
				 Swal.fire({
		             title: 'Are you sure?',
		             text: "You won't be able to revert this!",
		             icon: 'warning',
		             showCancelButton: true,
		             confirmButtonText: 'Yes, delete it!',
		             customClass: {
		               confirmButton: 'btn btn-primary me-3',
		               cancelButton: 'btn btn-label-secondary'
		             },
		             buttonsStyling: false
		           }).then(function (result) {
		             if (result.value) {
		            	 $(".incontact"+id).remove();
		            	 invoiceIncre=invoiceIncre-1;
		            	 invoiceamountCalculator();
				   			
		               }
		           });
				
			}
			
			//------------------------------------------------------------------------------------
			
			 function editreceiptinfo(e){
					var projectid= e.getAttribute("id");
					
						var formData = {
							projectid : projectid,
							mastercategoryid: "[[${projectMaster['id']}]]"
						}

						$.ajax({
							type : "POST",
							url : "getreceiptitem",
							data : formData,
							success : function(result) {
								var bmobj = JSON.parse(JSON.stringify(result));
							//	console.log(bmobj);
								
								$("#recepitid").val(bmobj.recepitid);
								$("#recepitNo").val(bmobj.recepitNo);
								$("#recepitDate").val(bmobj.recepitDate);
								$("#recinvoiceid").val(bmobj.invoiceid);
								$("#depositedto").val(bmobj.depositedto).change();
								$("#modeofPayment").val(bmobj.modeofPayment).change();
								$("#amount").val(bmobj.amount);
								$("#notes").val(bmobj.notes);
								
							
								var formData = {
										invoiceid : bmobj.invoiceid,
										mastercategoryid: "[[${projectMaster['id']}]]"
									}

									$.ajax({
										type : "POST",
										url : "getinvoicereceiptitem",
										data : formData,
										success : function(result) {
											var bmobj = JSON.parse(JSON.stringify(result));
											//console.log(bmobj);
											
											$("#invoiceNotxt").text(bmobj.Invoiceno);
											$("#duedatetxt").text(bmobj.duedate);
											$("#invoiceamounttxt").text(bmobj.amount);
											$("#invoicetotalpaidNotxt").text(bmobj.totalpaidamount);
											$("#invoiceBalancetxt").text(bmobj.balanceamount);
											$("#recinvoiceid").val(bmobj.invoiceid);
											
											$('#receiptmodel').modal('show');
										},
										error : function(e) {
											console.log("Error" + e);
										}
									});
								
							},
							error : function(e) {
								console.log("Error" + e);
							}
						});
					
				}
			//------------------------------------------------------
			$('#invoiceType').on('change',function(event) {
				
				
				if($(this).val() == "Bill"){
					$(".CGST").val("0").change();
					$(".SGST").val("0").change();
					$(".IGST").val("0").change();
					$('.CGST').prop("disabled", true);
					$('.SGST').prop("disabled", true);
					$('.IGST').prop("disabled", true);
					
				}else
				{
					
					const elementsWithClassInv = document.querySelectorAll(".CGST");
					 const elementsArrayInv = Array.from(elementsWithClassInv);
					  elementsArrayInv.forEach((element) => {
					     let tempid = element.id.replace("CGSTper","");
					   
					     	if($("#CGSTper"+tempid).val() == 0 && $("#IGSTper"+tempid).val()== 0)
							{
					     		$("#CGSTper"+tempid).val("9").change();
					    	}
							if($("#SGSTper"+tempid).val() == 0 && $("#IGSTper"+tempid).val()== 0)
							{
								$("#SGSTper"+tempid).val("9").change();
							}
							if($("#SGSTper"+tempid).val() != 0 && $("#CGSTper"+tempid).val()!= 0)
							{
								$("#IGSTper"+tempid).val("0").change();
							}
					     
					  });
					$('.CGST').prop("disabled", false);
					$('.SGST').prop("disabled", false);
					$('.IGST').prop("disabled", false);
				}
				
				$(".btn-apply-changes").click();
				
			});
		//------------------------------------------------------
		</script>
</body>
</html>