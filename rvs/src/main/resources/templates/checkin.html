<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" lang="en"
	class="light-style layout-navbar-fixed layout-menu-fixed" dir="ltr"
	data-theme="theme-default" th:data-assets-path="@{/assets/}"
	data-template="vertical-menu-template">
<head>
<meta name="_csrf" th:content="${_csrf.token}" />
<!-- default header name is X-CSRF-TOKEN -->
<meta name="_csrf_header" th:content="${_csrf.headerName}" />

<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

<title>Checkout List</title>

<meta name="description" content="" />

<!-- Favicon -->
<link rel="icon" type="image/x-icon"
	th:href="@{/assets/img/favicon/favicon.ico}" />

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
	href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Rubik:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
	rel="stylesheet" type="text/css" />

<!-- Icons -->
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/fonts/boxicons.css}" />
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/fonts/fontawesome.css}" />
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/fonts/flag-icons.css}" />

<!-- Core CSS -->
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/css/rtl/core.css}"
	class="template-customizer-core-css" />
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/css/rtl/theme-default.css}"
	class="template-customizer-theme-css" />
<link rel="stylesheet" type="text/css" th:href="@{/assets/css/demo.css}" />

<!-- Vendors CSS -->
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css}" />
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/libs/typeahead-js/typeahead.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-bs5/datatables.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-checkboxes-jquery/datatables.checkboxes.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/sweetalert2/sweetalert2.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/flatpickr/flatpickr.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/jquery-timepicker/jquery-timepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/pickr/pickr-themes.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/tagify/tagify.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/bootstrap-select/bootstrap-select.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/select2/select2.css}" />

<!-- Row Group CSS -->
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-rowgroup-bs5/rowgroup.bootstrap5.css}" />
<!-- Form Validation -->
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/formvalidation/dist/css/formValidation.min.css}" />


<!-- Page CSS -->

<!-- Helpers -->
<script th:src="@{/assets/vendor/js/helpers.js}"></script>

<!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
<!--? Template customizer: To hide customizer set displayCustomizer value false in config.js.  -->
<script th:src="@{/assets/vendor/js/template-customizer.js}"></script>
<!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
<script th:src="@{/assets/js/config.js}"></script>
</head>
<body>
	<div class="layout-wrapper layout-content-navbar">
		<div class="layout-container">
			<!-- Menu -->
			<div th:insert="menu"></div>
			<!-- / Menu -->

			<!-- Layout container -->
			<div class="layout-page">
				<!-- Navbar -->

				<div th:insert="header"></div>

				<!-- / Navbar -->

				<!-- Content wrapper -->
				<div class="content-wrapper">
					<!-- Content -->
					<div class="container-xxl flex-grow-1 container-p-y">
						<h4 class="py-3 breadcrumb-wrapper mb-4">
							<span class="text-muted fw-light">Administration/Asset/ </span>Check
							In
						</h4>

						<div class="card">




							<div class="card-body">

								<div th:if="${printstr}" class="form-group col-12">
									<button type="button"
										class="btn mb-1 btn-success btn-lg btn-block">Check
										In details are saved successfully</button>
									<form th:action="@{/checkinprint}" target="blank" method="POST"
										class="wizard-horizontal" enctype="multipart/form-data">

										<center>
											<button type="submit" class="btn btn-primary mr-1 mb-1"
												style="width: 200px">Print Receipt</button>
										</center>
									</form>
								</div>

								<form class="g-3" id="form1" th:action="@{/checkinsave}"
									method="POST" enctype="multipart/form-data">
									<div class="row">
										<div class="col-sm-3">
											<label class="form-label">Branch</label> <select
												class="form-select" id="Branch" name="Branch" required>
												<option value="">--Select--</option>
												<th:block th:each="emp : ${branchls}">
													<option th:value="${emp.id}" th:text="${emp.BRANCH_NAME}"></option>
												</th:block>
											</select>
										</div>

										<div class="col-sm-3">
											<label class="form-label">Custodian</label> <select
												class="form-select" id="StaffID" name="StaffID" required>
												<option value="">--Select--</option>
												<th:block th:if="${emp}">
													<th:block th:if="${emp.empMasterid} >0 ">
														<option th:value="${emp.empMasterid}"
															th:text="${emp.StaffName} + ' (RVS000' + ${emp.empMasterid} +')'"></option>
													</th:block>
												</th:block>
											</select>
										</div>

										<div class="col-sm-3">
											<label class="form-label">Check In Date</label> <input
												type="text" class="form-control flatpickr"
												name="CheckInDate" id="CheckInDate" th:value="${today}"
												placeholder="Apr 3 2022" required>
										</div>

										<div class="col-sm-3">
											<button type="button" id="Search"
												class="btn btn-block btn-primary mt-4">Search</button>
										</div>




										<div class="row">


											<div class="col-sm-12">
												<div class="table-responsive mt-4">
													<table class="datatables-basic table">
														<thead>

															<tr>
																<th></th>
																<th></th>
																
																<th>ASSET</th>
																<th>Condition</th>
																<th>Status</th>
																<th>Photo</th>
																<th>Comments</th>
															</tr>

														</thead>
														<tbody class="tblbody">

															<tr th:each="selasset, stat: ${selectedasset}">
																<td></td>
																<td><input type="checkbox" class="form-check-input"
																	th:id="'checkboxGlow'+ ${stat.index+1} "
																	name="checkbox" checked=""> <label
																	th:for="'checkboxGlow'+ ${stat.index+1}"></label></td>
																
																<td><input type="hidden"
																	th:value="${selasset.AssetId}" name="AssetName" /> <span
																	th:text="'&nbsp;'+ ${selasset.AssetName} + '&nbsp;'"></span>
																</td>

																<td><select required="" id="ACondition"
																	name="ACondition" class="form-select select">
																		<option th:value="${selasset.ACondition}"
																			th:text="${selasset.ACondition}"></option>
																		<option value="Fair">Fair</option>
																		<option value="Good">Good</option>
																		<option value="New">New</option>
																		<option value="Poor">Poor</option>
																</select></td>
																<td><select required id="Status" name="Status"
																	class="form-select selectstatus">
																		<option value="In Stock">Return</option>
																		<option value="Scrap">Scrap</option>
																</select></td>
																<td class="Photo_Attach"><input type='file'
																	name='Photo_Attach' class="form-control Photo_Attach"
																	accept="image/*" multiple /></td>
																<td><input type='text' name='Comments'
																	class="form-control" /></td>
															</tr>

														</tbody>

													</table>
												</div>
											</div>
										</div>


										<div class="col-sm-12 text-center">
											<label class="switch"> <input type="checkbox"
												class="switch-input" name="receipt" checked> <span
												class="switch-toggle-slider"> <span class="switch-on">
														<i class="bx bx-check"></i>
												</span> <span class="switch-off"> <i class="bx bx-x"></i>
												</span>
											</span> <span class="switch-label">SHOW RECEIPT AFTER CHECK
													IN?</span>
											</label>
										</div>

										<div class="col-sm-12 text-center mt-4">
											<button type="submit" class="btn btn-primary me-sm-3 me-1">Check
												In</button>

										</div>
								</form>



							</div>
						</div>

					</div>

				</div>
				<!-- Footer -->
				<footer class="content-footer footer bg-footer-theme"> </footer>
				<!-- / Footer -->

				<div class="content-backdrop fade"></div>


			</div>
		</div>
	</div>

	<!-- Core JS -->
	<!-- build:js assets/vendor/js/core.js -->
	<script th:src="@{/assets/vendor/libs/jquery/jquery.js}"></script>
	<script th:src="@{/assets/vendor/libs/popper/popper.js}"></script>
	<script th:src="@{/assets/vendor/js/bootstrap.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js}"></script>

	<script th:src="@{/assets/vendor/libs/hammer/hammer.js}"></script>

	<script th:src="@{/assets/vendor/libs/i18n/i18n.js}"></script>
	<script th:src="@{/assets/vendor/libs/typeahead-js/typeahead.js}"></script>

	<script th:src="@{/assets/vendor/js/menu.js}"></script>
	<!-- endbuild -->

	<!-- Vendors JS -->
	<script th:src="@{/assets/vendor/libs/select2/select2.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/bootstrap-select/bootstrap-select.js}"></script>
	<script th:src="@{/assets/vendor/libs/datatables/jquery.dataTables.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-bs5/datatables-bootstrap5.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-responsive/datatables.responsive.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-checkboxes-jquery/datatables.checkboxes.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-buttons/datatables-buttons.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.js}"></script>
	<script th:src="@{/assets/vendor/libs/jszip/jszip.js}"></script>
	<script th:src="@{/assets/vendor/libs/pdfmake/pdfmake.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-buttons/buttons.html5.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-buttons/buttons.print.js}"></script>
	<!-- Flat Picker -->
	<script th:src="@{/assets/vendor/libs/moment/moment.js}"></script>
	<script th:src="@{/assets/vendor/libs/flatpickr/flatpickr.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/jquery-timepicker/jquery-timepicker.js}"></script>
	<script th:src="@{/assets/vendor/libs/pickr/pickr.js}"></script>

	<!-- Row Group JS -->
	<script
		th:src="@{/assets/vendor/libs/datatables-rowgroup/datatables.rowgroup.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-rowgroup-bs5/rowgroup.bootstrap5.js}"></script>
	<script th:src="@{/assets/vendor/libs/sweetalert2/sweetalert2.js}"></script>
	<script th:src="@{/assets/vendor/libs/tagify/tagify.js}"></script>
	<!-- Form Validation -->
	<script
		th:src="@{/assets/vendor/libs/formvalidation/dist/js/FormValidation.min.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/formvalidation/dist/js/plugins/Bootstrap5.min.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/formvalidation/dist/js/plugins/AutoFocus.min.js}"></script>

	<!-- Main JS -->
	<script th:src="@{/assets/js/main.js}"></script>
	<script>
		var token = $("meta[name='_csrf']").attr("content");
		var header = $("meta[name='_csrf_header']").attr("content");
		$(document).ajaxSend(function(e, xhr, options) {
			xhr.setRequestHeader(header, token);
		});

		$(".flatpickr").each(function(index) {
			$(this).flatpickr({
				altInput : true,
				altFormat : 'F j, Y',
				dateFormat : 'Y-m-d',
			});
		})

		const dt_basic_table = $(`.datatables-basic`)
				.DataTable(
						{

							columnDefs : [
									{
										// For Responsive
										className : 'control',
										orderable : false,
										responsivePriority : 1,
										searchable : false,
										targets : 0,
										render : function(data, type, full,
												meta) {
											return '';
										}
									},
									{
										// For Checkboxes
										targets : 1,
										orderable : false,
										responsivePriority : 2,
										searchable : false,
										checkboxes : true,
										render : function() {
											return '<input type="checkbox" class="dt-checkboxes form-check-input" name="checkbox">';
										},
										checkboxes : {
											selectAllRender : '<input type="checkbox" class="form-check-input">'
										}
									}, ],

							
							responsive : {
								details : {
									display : $.fn.dataTable.Responsive.display
											.modal({
												header : function(a) {
													return "Details of "
															+ a.data().full_name
												}
											}),
									type : "column",
									renderer : function(a, t, e) {
										e = $
												.map(
														e,
														function(a, t) {
															return "" !== a.title ? '<tr data-dt-row="' + a.rowIndex + '" data-dt-column="' + a.columnIndex + '"><td>'
																	+ a.title
																	+ ":</td> <td>"
																	+ a.data
																	+ "</td></tr>"
																	: ""
														}).join("");
										return !!e
												&& $(
														'<table class="table"/><tbody />')
														.append(e)
									}
								}
							}
						});

		console.log(dt_basic_table.row);
		
		
		$("#Branch").change(function() {
			  var branch = $("#Branch").val();
			  $('#StaffID').html("");

			  if (branch != "") {
			    var branchname = $("#Branch option:selected").text();
			    $(".Custodianloding").css("visibility", "visible");
			    $('#StaffID').html("");

			    $.ajax({
			      type: "POST",
			      url: "getEmployeelistbasedonbranch",
			      data: { branchname: branchname },
			      success: function(result) {
			        $('#StaffID').html(result);
			        $(".Custodianloding").css("visibility", "hidden");
			      },
			      error: function(e) {
			        alert("Error: " + e);
			        $(".Custodianloding").css("visibility", "hidden");
			      }
			    });

			    $('.tblbody').html("<tr class='loadingrow'><td colspan='6' align='center'><br/> <br/></td></tr></tr>");
			  }
			});

		
		

		$("#Search").click(function() {
			  var StaffID = $("#StaffID").val();
			  if (StaffID != '') {
			    $.post("getCheckoutlistfromassetMaster", { StaffID: StaffID })
			      .done(function(result) {
			        if (result) {
			          $('.tblbody').html(result);
			        } else {
			          // $('.tblbody').html("<tr class='loadingrow'><td colspan='6' align='center'><br/> No Item Found<br/></td></tr></tr>");
			        }
			      })
			      .fail(function(e) {
			        alert("Error: " + e);
			        console.log(e);
			      });
			  }
			});

	</script>
</body>
</html>