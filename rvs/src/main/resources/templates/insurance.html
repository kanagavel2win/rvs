<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" lang="en"
	class="light-style layout-navbar-fixed layout-menu-fixed" dir="ltr"
	data-theme="theme-default" th:data-assets-path="@{/assets/}"
	data-template="vertical-menu-template">
<head>
<meta name="_csrf" th:content="${_csrf.token}" />
<!-- default header name is X-CSRF-TOKEN -->
<meta name="_csrf_header" th:content="${_csrf.headerName}" />

<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

<title>Insurance</title>

<meta name="description" content="" />

<!-- Favicon -->
<link rel="icon" type="image/x-icon"
	th:href="@{/assets/img/favicon/favicon.ico}" />

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
	href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Rubik:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
	rel="stylesheet" />

<!-- Icons -->
<link rel="stylesheet" th:href="@{/assets/vendor/fonts/boxicons.css}" />
<link rel="stylesheet" th:href="@{/assets/vendor/fonts/fontawesome.css}" />
<link rel="stylesheet" th:href="@{/assets/vendor/fonts/flag-icons.css}" />

<!-- Core CSS -->
<link rel="stylesheet" th:href="@{/assets/vendor/css/rtl/core.css}"
	class="template-customizer-core-css" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/css/rtl/theme-default.css}"
	class="template-customizer-theme-css" />
<link rel="stylesheet" th:href="@{/assets/css/demo.css}" />

<!-- Vendors CSS -->
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/typeahead-js/typeahead.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-bs5/datatables.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/animate-css/animate.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/sweetalert2/sweetalert2.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/flatpickr/flatpickr.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/jquery-timepicker/jquery-timepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/select2/select2.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/formvalidation/dist/css/formValidation.min.css}" />

<!-- Page CSS -->
<link rel="stylesheet"
	th:href="@{/assets/vendor/css/pages/page-profile.css}" />
<!-- Helpers -->
<script th:src="@{/assets/vendor/js/helpers.js}"></script>

<!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
<!--? Template customizer: To hide customizer set displayCustomizer value false in config.js.  -->
<script th:src="@{/assets/vendor/js/template-customizer.js}"></script>
<!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
<script th:src="@{/assets/js/config.js}"></script>


<style>
.bx-check-circle {
	color: green;
}

.pop_cursor {
	cursor: pointer;
}

.pop_cursor:hover {
	font-weight: bold;
}

.contacteditbtn {
	cursor: pointer;
}

.bx-donate-heart {
	font-size: 100px;
}

.emptitle {
	color: #527a00;
	font-size: 15px;
	line-height: 20px;
	font-weight: 600;
	font-family: Fira Sans, Trebuchet MS, sans-serif;
	cursor: pointer;
}

.policyedit
{
	
	cursor: pointer
}
</style>
</head>

<body>
	<!-- Layout wrapper -->
	<div class="layout-wrapper layout-content-navbar">
		<div class="layout-container">
			<!-- Menu -->
			<div th:insert="menu"></div>
			<!-- / Menu -->

			<!-- Layout container -->
			<div class="layout-page">
				<!-- Navbar -->

				<div th:insert="header"></div>

				<!-- / Navbar -->

				<!-- Content wrapper -->
				<div class="content-wrapper">
					<!-- Content -->

					<div class="container-xxl flex-grow-1 container-p-y">
						<h4 class="py-3 breadcrumb-wrapper mb-4">
							<span class="text-muted fw-light">Insurance</span>
						</h4>

						<!-- Header -->
						<div class="row">
							<div class="col-12">
								<div class="card mb-4">
									<div class="user-profile-header-banner">
										<img th:src="@{/assets/img/pages/profile-banner.png}"
											alt="Banner image" class="rounded-top" />
									</div>
									<div
										class="user-profile-header d-flex flex-column flex-sm-row text-sm-start text-center mb-4">
										<div class="flex-shrink-0 mt-n2 mx-sm-0 mx-auto">
											<i
												class='bx bx-donate-heart d-block h-auto ms-0 ms-sm-4 rounded-3 user-profile-img'></i>

										</div>
										<div class="flex-grow-1 mt-3 mt-sm-5">
											<div
												class="d-flex align-items-md-end align-items-sm-start align-items-center justify-content-md-between justify-content-start mx-4 flex-md-row flex-column gap-4">
												<div class="user-profile-info">
													<h4 th:if="${am}"
														th:text="${am.AssetName}"></h4>
													<h4 th:if="${em}"
														th:text="${em.StaffName}"></h4>
													<ul
														class="list-inline mb-0 d-flex align-items-center flex-wrap justify-content-sm-start justify-content-center gap-2">
														<li class="list-inline-item fw-semibold"><i
															class="bx bx-pen"></i> <th:block
																th:text="${insurancemaster.InsuranceTo}"></th:block></li>


													</ul>
												</div>

											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<!--/ Header -->


						<!-- User Profile Content -->
						<div class="row">

							<!-- <div class="col-xl-4 col-lg-5 col-md-5"> -->
							<div class="col-xl-12 col-lg-12 col-md-12 order-0 order-md-1">

								<!-- Billing Address -->
								<div class="card card-action mb-4">
									<div class="card-header align-items-center">
										<h5 class="card-action-title mb-0">Policy Details</h5>
										<div class="card-action-element" style="float: right">
											<button class="btn btn-primary btn-sm addNewpolicyDetails"
												type="button" data-bs-toggle="modal"
												data-bs-target="#addNewpolicyDetails">
												<i class="bx bx-plus bx-xs me-1"></i>
											</button>
										</div>
									</div>
									<div class="card-body" id="policydetailslist"></div>
								</div>
								<!--/ Billing Address -->
								 <!-- Bordered Table -->
					              <div class="card card-action mb-4">
					                <div class="card-header align-items-center">
										<h5 class="card-action-title mb-0">Claim History</h5>
										<div class="card-action-element" style="float: right">
											<button class="btn btn-primary btn-sm addNewpolicyHistoryDetails"
												type="button" data-bs-toggle="modal"
												data-bs-target="#addNewpolicyHistoryDetails">
												<i class="bx bx-plus bx-xs me-1"></i>
											</button>
										</div>
									</div>
					                <div class="card-body">
					                  <div class="table-responsive text-nowrap">
					                    <table class="table table-bordered">
					                      <thead>
					                        <tr>
					                          <th>Policy No</th>
					                          <th>Claim Date</th>
					                          <th>Amount</th>
					                          <th>Reason</th>
					                          
					                        </tr>
					                      </thead>
					                      <tbody class="table-border-bottom-0" id="policyClaimdetailslist">
					                        <tr>
					                         
					                        </tr>
					                      </tbody>
					                    </table>
					                  </div>
					                </div>
					              </div>
					              <!--/ Bordered Table -->
								
							</div>


						</div>
						<!--/ User Profile Content -->


						<!-- Modal -->

						<!-- Add New Policy Address Modal -->
						<div class="modal fade" id="addNewpolicyDetails" tabindex="-1"
							aria-hidden="true">
							<div
								class="modal-dialog modal-lg modal-simple modal-add-new-address">
								<div class="modal-content p-3 p-md-5">
									<div class="modal-body">
										<button type="button" class="btn-close"
											data-bs-dismiss="modal" aria-label="Close"></button>
										<div class="text-center mb-4">
											<h3 class="address-title">Policy</h3>
											<p class="address-subtitle">Policy details</p>
										</div>
										<form id="addpolicydetailsForm" class="row g-3"
											onsubmit="return false">
											<div class="col-12 col-md-6">
												<label class="form-label" for="modalEmg_Name">Vendor
													Name</label> <select class="form-control" id="VendorName" name="VendorName">
													<option value="">-</option>
													<th:block th:each="vmobj :${vm}">
														<option th:value="${vmobj.id}"
															th:text="${vmobj.orgname}"></option>
													</th:block>

												</select> <input type="hidden" id="InsuranceDetailsid"
													name="InsuranceDetailsid" />
											</div>
											<div class="col-12 col-md-6">
												<label class="form-label" for="PolicyName">Policy
													Name</label> <input type="text" id="PolicyName"
													class="form-control" name="PolicyName" />
											</div>
											<div class="col-12 col-md-6">
												<label class="form-label" for="PolicyNo">Policy No</label> <input
													type="text" id="PolicyNo" class="form-control"
													name="PolicyNo" />
											</div>
											<div class="col-12 col-md-6">
												<label class="form-label" for="Premium">Premium</label> <input
													type="text" id="Premium" class="form-control"
													name="Premium" />
											</div>
											<div class="col-12 col-md-6">
												<label class="form-label" for="Cover">Cover 
												</label> <select class="form-control addCoverdata" id="Cover"
													name="Cover">
													<option value="">-</option>
													<th:block th:each="str :${PolicyCover}">
														<option th:value="${str}" th:text="${str}"></option>

													</th:block>
												</select>
											</div>
											<div class="col-12 col-md-6">
												<label class="form-label" for="PFrom">Start Date</label> <input
													type="date" id="PFrom" class="form-control" name="PFrom" />
											</div>
											<div class="col-12 col-md-6">
												<label class="form-label" for="PTo">End Date</label> <input
													type="date" id="PTo" class="form-control" name="PTo" />
											</div>
											<div class="col-12 col-md-6">
												<label class="form-label" for="CoverageAmount">Coverage
													Amount </label> <input type="text" id="CoverageAmount"
													class="form-control" name="CoverageAmount" />
											</div>
											<div class="col-12 col-md-6">
												<label class="form-label" for="Notes">Notes </label> <input
													type="text" id="Notes" class="form-control" name="Notes" />
											</div>
											<div class="col-12 col-md-6">
												<label class="form-label" for="status">status</label> <select
													class="form-control" name="status" id="status">
													<option value="Display">Display</option>
													<option value="Move to Archive">Move to Archive</option>

												</select>
											</div>
											<div class="col-12 col-md-6">

												<label class="form-label" for="Nominee">Nominee</label> <select
													class="form-control employeenomineedetails" name="Nominee" id="Nominee">
													<option value="">-</option>
													<th:block th:each="emglsnewobj :${ememgcontact}">
														<option th:value="${emglsnewobj.empEmgContactid}"
															th:text="${emglsnewobj.Emg_Name} + '(' + ${emglsnewobj.Emg_Relation} +')'"></option>

													</th:block>
												</select>
											</div>
											<div class="col-12 col-md-6">
												<label class="form-label" for="Nominee">Policy File
													Copy</label> <input type="file"
														id="modalFile" class="form-control"
														accept="image/jpeg,image/png,image/jpg,application/pdf" />
											</div>


											<div class="col-12 text-center mt-4">
												<button type="submit"
													class="btn btn-primary me-sm-3 me-1 editpolicyDetailsdatasubmit"
													onclick="">Submit</button>
												<button type="reset"
													class="btn btn-label-secondary editpolicyDetailsdataclose"
													data-bs-dismiss="modal" aria-label="Close">Cancel</button>
											</div>
										</form>
									</div>
								</div>
							</div>
						</div>
						<!--/ Add New Policy Address Modal -->

						<!-- Add New Policy History Modal -->
						<div class="modal fade" id="addNewpolicyHistoryDetails" tabindex="-1"
							aria-hidden="true">
							<div
								class="modal-dialog modal-lg modal-simple modal-add-new-address">
								<div class="modal-content p-3 p-md-5">
									<div class="modal-body">
										<button type="button" class="btn-close"
											data-bs-dismiss="modal" aria-label="Close"></button>
										<div class="text-center mb-4">
											<h3 class="address-title">Claim Details</h3>
											
										</div>
										<form id="addpolicyClaimdetailsForm" class="row g-3"
											onsubmit="return false">
											<div class="col-12 col-md-6">
												<label class="form-label" for="modalEmg_Name">Policy No
													</label> <select class="form-control" id="policyNo" name="policyNo">
													<option value="">-</option>
													<th:block th:each="vmobj :${insurancemaster.InsuranceDetails}">
														<option th:value="${vmobj.PolicyNo}"
															th:text="${vmobj.PolicyNo}"></option>
													</th:block>

												</select> <input type="hidden" id="InsuranceClaimDetailsid"
													name="InsuranceClaimDetailsid" />
											</div>
										
											
											
											<div class="col-12 col-md-6">
												<label class="form-label" for="claimDate">Claim Date</label> <input
													type="date" id="claimDate" class="form-control" name="claimDate" />
											</div>
											
											<div class="col-12 col-md-6">
												<label class="form-label" for="claimAmount">
													Amount </label> <input type="text" id="claimAmount"
													class="form-control" name="claimAmount" />
											</div>
											<div class="col-12 col-md-6">
												<label class="form-label" for="reason">Reason </label> <input
													type="text" id="reason" class="form-control" name="reason" />
											</div>
											


											<div class="col-12 text-center mt-4">
												<button type="submit"
													class="btn btn-primary me-sm-3 me-1 editpolicyClaimDetailsdatasubmit"
													onclick="">Submit</button>
												<button type="reset"
													class="btn btn-label-secondary editpolicyClaimDetailsdataclose"
													data-bs-dismiss="modal" aria-label="Close">Cancel</button>
											</div>
										</form>
									</div>
								</div>
							</div>
						</div>
						<!--/ Add New Policy History Modal -->

						<!--scrolling content Modal -->
						<div class="modal fade" id="ItemStatusScrollable" tabindex="-1"
							role="dialog" aria-labelledby="ItemStatusScrollableTitle"
							aria-hidden="true">
							<div class="modal-dialog modal-dialog-scrollable" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title white" id="ItemStatusScrollableTitle"></h5>
										<button type="button" class="btn-close"
											data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<div class="col-md-12">
											<div class="form-group">
												<label for="addmodel" id="additemalltxt"></label>
												<div class="position-relative">
													<fieldset class="form-group">
														<input type="text" id="additemall" name="addmodel"
															class="form-control capitalize">
													</fieldset>
												</div>
											</div>
										</div>

									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-light-secondary"
											data-bs-dismiss="modal">
											<i class="bx bx-x d-block d-sm-none"></i> <span
												class="d-none d-sm-block">Close</span>
										</button>
										<button type="button" class="btn btn-primary ml-1"
											id="additemallsavebtn">
											<i class="bx bx-check d-block d-sm-none"></i> <span
												class="d-none d-sm-block">ADD</span>
										</button>
									</div>
								</div>
							</div>
						</div>
						<!--scrolling content Modal -->

						<!-- /Modal -->
					</div>
					<!-- / Content -->

					<!-- Footer -->
					<!-- / Footer -->

					<div class="content-backdrop fade"></div>
				</div>
				<!-- Content wrapper -->
			</div>
			<!-- / Layout page -->
		</div>

		<!-- Overlay -->
		<div class="layout-overlay layout-menu-toggle"></div>

		<!-- Drag Target Area To SlideIn Menu On Small Screens -->
		<div class="drag-target"></div>
	</div>
	<!-- / Layout wrapper -->

	<!-- Core JS -->
	<script th:src="@{/assets/vendor/libs/jquery/jquery.js}"></script>
	<script th:src="@{/assets/vendor/libs/popper/popper.js}"></script>
	<script th:src="@{/assets/vendor/js/bootstrap.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js}"></script>

	<script th:src="@{/assets/vendor/libs/hammer/hammer.js}"></script>

	<script th:src="@{/assets/vendor/libs/i18n/i18n.js}"></script>
	<script th:src="@{/assets/vendor/libs/typeahead-js/typeahead.js}"></script>

	<script th:src="@{/assets/vendor/js/menu.js}"></script>
	<!-- endbuild -->

	<!-- Vendors JS -->
	<script th:src="@{/assets/vendor/libs/moment/moment.js}"></script>
	<script th:src="@{/assets/vendor/libs/datatables/jquery.dataTables.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-bs5/datatables-bootstrap5.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-responsive/datatables.responsive.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-buttons/datatables-buttons.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.js}"></script>
	<script th:src="@{/assets/vendor/libs/jszip/jszip.js}"></script>
	<script th:src="@{/assets/vendor/libs/pdfmake/pdfmake.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-buttons/buttons.html5.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/datatables-buttons/buttons.print.js}"></script>
	<script th:src="@{/assets/vendor/libs/sweetalert2/sweetalert2.js}"></script>
	<script th:src="@{/assets/vendor/libs/cleavejs/cleave.js}"></script>
	<script th:src="@{/assets/vendor/libs/cleavejs/cleave-phone.js}"></script>
	<script th:src="@{/assets/vendor/libs/select2/select2.js}"></script>
	<!-- Form Validation -->
	<script
		th:src="@{/assets/vendor/libs/formvalidation/dist/js/FormValidation.min.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/formvalidation/dist/js/plugins/Bootstrap5.min.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/formvalidation/dist/js/plugins/AutoFocus.min.js}"></script>

	<!-- Main JS -->
	<script th:src="@{/assets/js/main.js}"></script>

	<!-- Flat Picker -->
	<script th:src="@{/assets/vendor/libs/moment/moment.js}"></script>
	<script th:src="@{/assets/vendor/libs/flatpickr/flatpickr.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.js}"></script>
	<script
		th:src="@{/assets/vendor/libs/jquery-timepicker/jquery-timepicker.js}"></script>
	<script th:src="@{/assets/vendor/libs/pickr/pickr.js}"></script>

	<!-- Page JS -->
	<!-- <script th:src="@{/assets/js/modal-edit-user.js}"></script> -->
	<script th:src="@{/assets/js/app-user-view.js}"></script>
	<script th:src="@{/assets/js/app-user-view-account.js}"></script>

	
	
	<script>
	
	const Experiencefrom = flatpickr("#PFrom1", {
		  altInput: true,
	      altFormat: 'F j, Y',
	      dateFormat: 'Y-m-d'
	     });
	
	const Experiencento = flatpickr("#PTo1", {
		  altInput: true,
	      altFormat: 'F j, Y',
	      dateFormat: 'Y-m-d'
	     });
	
    $(document).ready(function() {  
    	//--------------------------------------------------------------------------------------------------------------------------------------
    	 	$('#addpolicydetailsForm').on('submit', function(event){
    	 		
    	 	   if(event.target.checkValidity()){
    	 		   
    	 		  $('.documentsave').prop("disabled",true);
				  $('.documentsave').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
					
					
    	 		  let formdata= new FormData(document.querySelector("#addpolicydetailsForm"));
    	 		  const modalFile =document.getElementById("modalFile");
    	 		  formdata.append("File_Attach",modalFile.files[0]);
    	 		  formdata.append("Insuranceid","[[${insurancemaster['Insuranceid']}]]");
    	 		 
    	 		 
    	 		  $.ajax({
	   					type : "POST",url : "policydetailsavejson",
	   					data : formdata,
	   					contentType: false,
	   	                processData: false,
	   					success : function(result) {
	   						
	   						getpolicydetaillist();
	   						validationformfilereset();
	   					},
    	 			 error : function(e) {
						console.log("Error" + e);

					}
    	 		  });
    	 		  
    	 	   }
    	 	});   
    	 	//--------------------------------------------------------------------------------------------------------------------------------------
    	 	$('#addpolicyClaimdetailsForm').on('submit', function(event){
    	 		
    	 	   if(event.target.checkValidity()){
    	 		   
    	 		  $('.editpolicyClaimDetailsdatasubmit').prop("disabled",true);
				  $('.editpolicyClaimDetailsdatasubmit').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
					
					
    	 		  let formdata= new FormData(document.querySelector("#addpolicyClaimdetailsForm"));
    	 		  formdata.append("Insuranceid","[[${insurancemaster['Insuranceid']}]]");
    	 		 
    	 		  $.ajax({
	   					type : "POST",url : "policyClaimdetailsavejson",
	   					data : formdata,
	   					contentType: false,
	   	                processData: false,
	   					success : function(result) {
	   						
	   						getinsuranceclaimdetailslist();
	   						validationformclaimreset();
	   					},
    	 			 error : function(e) {
						console.log("Error" + e);

					}
    	 		  });
    	 		  
    	 	   }
    	 	});   
    	//--------------------------------------------------------------------------------------------------------------------------------------
   		function validationformfilereset()
			   {
		   				$('.editpolicyDetailsdataclose').click();
		   				$('.editpolicyDetailsdatasubmit').prop("disabled",false);
			   			$('.editpolicyDetailsdatasubmit').html("Submit");
			   }
    	
   		function validationformclaimreset()
		   {
	   				$('.editpolicyClaimDetailsdataclose').click();
	   				$('.editpolicyClaimDetailsdatasubmit').prop("disabled",false);
		   			$('.editpolicyClaimDetailsdatasubmit').html("Submit");
		   }
    	//--------------------------------------------------------------------------------------------------------------------------------------
   		$(document).on("click", ".addNewpolicyDetails", function() {
   			document.getElementById("addpolicydetailsForm").reset();
   		
   		});
    	
   		$(document).on("click", ".addNewpolicyHistoryDetails", function() {
   			document.getElementById("addpolicyClaimdetailsForm").reset();
   		
   		});
    	
    	$(document).on("click", ".additem", function() {
			
				var name = $(this).attr('name');
				var labeltext = "";
				if (name == "addCoverdata") {
					labeltext = "New Cover Type";
				}
				
				$('#additemalltxt').text(labeltext);
				$('#ItemStatusScrollable').modal('toggle');

			});

			$("#additemallsavebtn").click(
			function() {
				if ($("#additemall").val() != '') {
					var name = $('#additemalltxt').text();
					var labeltext = "";
					if (name == "New Cover Type") {
						labeltext = "addCoverdata";
					}
					
					$('.' + labeltext).append(
							"<option value='"
									+ $("#additemall").val()
									+ "'>"
									+ $("#additemall").val()
									+ "</option>");
					
					$("#additemall").val('');
					$('#ItemStatusScrollable').modal(
							'toggle');
				}
			});
			
			//--------------------------------------------------------------------------------------------------------------------------------------
			
			function getpolicydetaillist() {
				
				var formData = {
					id : "[[${insurancemaster['Insuranceid']}]]"
				}

				$.ajax({
					type : "POST",
					url : "getpolicydetailslist",
					data : formData,
					success : function(result) {
						var htmlop="";
						var bmobj = JSON.parse(JSON.stringify(result));
						console.log(bmobj);
						
						bmobj.forEach((element, index, array) =>
			           	{
			           		if(element.status != 'Move to Archive')
			           		{
			           			
				           		htmlop += '<div class="row editemg"><hr /><div class="col-xl-7 col-12">	<dl class="row mb-0">		<dt class="col-sm-4 mb-3 text-nowrap">Vendor Name:</dt>		<dd class="col-sm-8 policyedit " onClick="policyeditfunction('+ element.insuranceDetailsid +')"><span class="badge bg-label-primary me-1">'+ element.vendorNamestr + '</span></dd>				<dt class="col-sm-4 mb-3 text-nowrap">Policy Name:</dt>		<dd class="col-sm-8">'+ element.policyName + '</dd>		<dt class="col-sm-4 mb-3 text-nowrap">Premium:</dt>		<dd class="col-sm-8">'+ element.premium + '</dd>				<dt class="col-sm-4 mb-3 text-nowrap">From :</dt>		<dd class="col-sm-8">'+ element.pfrom_str + '</dd>				<dt class="col-sm-4 mb-3 text-nowrap">To:</dt>		<dd class="col-sm-8">'+ element.pto_str + '</dd>		<dt class="col-sm-4 mb-3 text-nowrap">Status:</dt>		<dd class="col-sm-8">'+ element.status + '</dd>	</dl></div><div class="col-xl-5 col-12">	<dl class="row mb-0">		<dt class="col-sm-4 mb-3 text-nowrap">Policy No:</dt>		<dd class="col-sm-8">'+ element.policyNo + '</dd>				<dt class="col-sm-4 mb-3 text-nowrap">Cover:</dt>		<dd class="col-sm-8">'+ element.cover + '</dd>				<dt class="col-sm-4 mb-3 text-nowrap">Coverage Amount:</dt>		<dd class="col-sm-8">'+ element.coverageAmount + '</dd>		<dt class="col-sm-4 mb-3 text-nowrap">Nominee:</dt>		<dd class="col-sm-8">'+ element.nominee_name_str + '</dd>		<dt class="col-sm-4 mb-3 text-nowrap">Notes:</dt>		<dd class="col-sm-8">'+ element.notes + '</dd>		<dt class="col-sm-4 mb-3 text-nowrap">Files:</dt>		<dd class="col-sm-8">';
				         	 	htmlop += '<a href="'+ element.doc_Attach +'" target="_blank">';
				         	 	if(element.doc_Attach != '')
				         	 	{
					         	 	if(element.doc_Attach.split(".")[1] == 'pdf')
									{
					         	 		htmlop += '<img src="assets/img/icons/misc/pdf.png" alt="PDF image" width="20" class="me-2">';
									}else
									{
										htmlop += '<img src="assets/img/icons/misc/jpg.png" alt="jp image" width="20" class="me-2">';
									}
				         	 	}
				         	 	htmlop += '</a></dd>	</dl></div> </div>';
			           		}
			         	 	
			            });
						
						$('#policydetailslist').html(htmlop);
						
					},
					error : function(e) {
						console.log("Error" + e);

					}

				});

			}
			

			//--------------------------------------------------------------------------------------------------------------------------------------
			
			function getinsuranceclaimdetailslist() {
				
				var formData = {
					id : "[[${insurancemaster['Insuranceid']}]]"
				}

				$.ajax({
					type : "POST",
					url : "insuranceclaimdetails",
					data : formData,
					success : function(result) {
						var htmlop="";
						var bmobj = JSON.parse(JSON.stringify(result));
						//console.log(bmobj);
						
						bmobj.forEach((element, index, array) =>
			           	{
			           		htmlop +='<tr><td class="policyedit" onClick="policyclaimeditfunction('+ element.insuranceClaimid +')"><span class="badge bg-label-primary me-1">'+element.policyNo +'</span></td><td>'+element.claimDateMMMddYYYFormate +'</td><td>'+element.claimAmount +'</td><td>'+element.reason +'</td></tr>';
			         	 	
			            });
						
						$('#policyClaimdetailslist').html(htmlop);
						
					},
					error : function(e) {
						console.log("Error" + e);

					}

				});

			}
			
		//--------------------------------------------------------------------------------------------------------------------------------------		 		
		$(document).ready(function(){
		    setTimeout(function(){
		    	getpolicydetaillist();
		    	getinsuranceclaimdetailslist();
		     },500); // milliseconds
		});
		//--------------------------------------------------------------------------------------------------------------------------------------		 		
		$(function() {
			var token = $("meta[name='_csrf']").attr("content");
			var header = $("meta[name='_csrf_header']").attr("content");
			$(document).ajaxSend(function(e, xhr, options) {
				xhr.setRequestHeader(header, token);
			});
		});
		
		
    });
    
    
  //--------------------------------------------------------------------------------------------------------------------------------------
	
	function policyeditfunction(id) {
		var policyid = id;
		
		var formData = {
				id : "[[${insurancemaster['Insuranceid']}]]",
				policyid: policyid
			}

		$.ajax({
			type : "POST",
			url : "getpolicydetails",
			data : formData,
			success : function(result) {
				var htmlop="";
				var bmobj = JSON.parse(JSON.stringify(result));
				console.log(bmobj);
				
				$("#PFrom").val(bmobj.pfrom);
				$("#PTo").val(bmobj.pto);
				$("#InsuranceDetailsid").val(bmobj.insuranceDetailsid);
				$("#VendorName").val(bmobj.vendorName).change();
				$("#PolicyName").val(bmobj.policyName);
				$("#PolicyNo").val(bmobj.policyNo);
				$("#Premium").val(bmobj.premium);
				$("#Cover").val(bmobj.cover).change();
				
				$("#CoverageAmount").val(bmobj.coverageAmount);
				$("#Notes").val(bmobj.notes);
				$("#status").val(bmobj.status);
				$("#Nominee").val(bmobj.nominee).change();
				
				$('#addNewpolicyDetails').modal('toggle');
			},
			error : function(e) {
				console.log("Error" + e);

			}

		});

		
	}
  
	//--------------------------------------------------------------------------------------------------------------------------------------
	
	function policyclaimeditfunction(id) {
		var claimid = id;
		
		var formData = {
				id : "[[${insurancemaster['Insuranceid']}]]",
				claimid: claimid
			}

		$.ajax({
			type : "POST",
			url : "getclaimpolicydetails",
			data : formData,
			success : function(result) {
				var htmlop="";
				var bmobj = JSON.parse(JSON.stringify(result));
				//console.log(bmobj);
				
				$("#InsuranceClaimDetailsid").val(bmobj.insuranceClaimid);
				$("#policyNo").val(bmobj.policyNo);
				$("#claimDate").val(bmobj.claimDate);
				$("#claimAmount").val(bmobj.claimAmount).change();
				$("#reason").val(bmobj.reason);
				
				
				$('#addNewpolicyHistoryDetails').modal('toggle');
			},
			error : function(e) {
				console.log("Error" + e);

			}

		});

		
	}
	//--------------------------------------------------------------------------------------------------------------------------------------
	
</script>
</body>
</html>