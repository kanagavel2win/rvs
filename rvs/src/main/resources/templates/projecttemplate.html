<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" lang="en"
	class="light-style layout-navbar-fixed layout-menu-fixed" dir="ltr"
	data-theme="theme-default" th:data-assets-path="@{/assets/}"
	data-template="vertical-menu-template">
<head>
<meta name="_csrf" th:content="${_csrf.token}" />
<!-- default header name is X-CSRF-TOKEN -->
<meta name="_csrf_header" th:content="${_csrf.headerName}" />

<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

<title>Project Template View</title>

<meta name="description" content="" />



<!-- Favicon -->
<link rel="icon" type="image/x-icon"
	th:href="@{/assets/img/favicon/favicon.ico}" />

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
	href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Rubik:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
	rel="stylesheet" />

<!-- Icons -->
<link rel="stylesheet" th:href="@{/assets/vendor/fonts/boxicons.css}" />
<link rel="stylesheet" th:href="@{/assets/vendor/fonts/fontawesome.css}" />
<link rel="stylesheet" th:href="@{/assets/vendor/fonts/flag-icons.css}" />

<!-- Core CSS -->
<link rel="stylesheet" th:href="@{/assets/vendor/css/rtl/core.css}"
	class="template-customizer-core-css" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/css/rtl/theme-default.css}"
	class="template-customizer-theme-css" />
<link rel="stylesheet" th:href="@{/assets/css/demo.css}" />

<!-- Vendors CSS -->
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/typeahead-js/typeahead.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-bs5/datatables.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/animate-css/animate.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/sweetalert2/sweetalert2.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/flatpickr/flatpickr.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/jquery-timepicker/jquery-timepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/select2/select2.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/tagify/tagify.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/formvalidation/dist/css/formValidation.min.css}" />

<!-- Page CSS -->

<link rel="stylesheet"
	th:href="@{/assets/vendor/css/pages/page-user-view.css}" />
<!-- Helpers -->
<script th:src="@{/assets/vendor/js/helpers.js}"></script>

<!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
<!--? Template customizer: To hide customizer set displayCustomizer value false in config.js.  -->
<script th:src="@{/assets/vendor/js/template-customizer.js}"></script>
<!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
<script th:src="@{/assets/js/config.js}"></script>

<style type="text/css">
.contacteditbtn {
	cursor: pointer;
}

.activitytypeicon {
	position: relative;
	margin-left: -10px;
}

.guestdetailslist, .followerdetailslist {
	top: 10px;
	font-size: 14px;
	left: -20px;
}

.tooltipx {
	position: relative;
	display: inline-block;
}

.tooltipx .tooltiptextx {
	visibility: hidden;
	font-size: 12px;
	min-width: 120px;
	background-color: black;
	color: #fff;
	text-align: center;
	border-radius: 6px;
	padding: 5px 1px;
	/* Position the tooltip */
	position: absolute;
	left: 50px;
	z-index: 1;
}

.tooltipx:hover .tooltiptextx {
	visibility: visible;
}

.btn-iconx {
	padding: 1px;
	display: inline-flex;
	margin-right: 2px;
	margin-top: -3px;
	width: 15px;
	height: 15px;
}

.editactivity {
	cursor: pointer;
}

.editnoteactivity {
	cursor: pointer;
}

.addactivity {
	cursor: pointer;
	color: #0000FF;
	
}

.acticon
{
	
	padding-right: 20px;
	color:green;
}


</style>
<script th:inline="javascript">
	var emplanstat = 0;
	var emgstat = 0;
	var languagelist = "";
	var educationdegreelist = "";
	var Nomineerelationshiplist = "";
	
	function optionshandle(radio)
	{
		
		$(".ActivityTitle").attr('placeholder',radio.title +' details...');
		$(".activitytype").removeClass("active");
		$(".activitytype"+radio.title).addClass("active");
	}	
	
	
</script>
</head>

<body>
	<!-- Layout wrapper -->
	<div class="layout-wrapper layout-content-navbar">
		<div class="layout-container">
			<!-- Menu -->
			<div th:insert="menu"></div>
			<!-- / Menu -->

			<!-- Layout container -->
			<div class="layout-page">
				<!-- Navbar -->
				<div th:insert="header"></div>
				<!-- / Navbar -->

				<!-- Content wrapper -->
				<div class="content-wrapper">
					<!-- Content -->

					<div class="container-xxl flex-grow-1 container-p-y">
						<h4 class="py-3 breadcrumb-wrapper mb-4">
							<span class="text-muted fw-light">Works /<a
								href="leadlist">Project Template</a>/
							</span> View
						</h4>
						<div class="row gy-4">
							<!-- User Sidebar -->
							<div class="col-xl-12 col-lg-5 col-md-5 order-1 order-md-0">
								<!-- User Card -->
								<div class="card mb-4">
									<div class="card-body">

										<div class="d-flex justify-content-around flex-wrap">
											<div class="d-flex align-items-start me-4 mt-3 gap-3">

												<div>
													<h5>
														Board : <span id="Lbl_BoardName"
															th:text="${projectTemplateBoard.boardName}"></span> <input
															type="hidden" id="boardid"
															th:value="${projectTemplateBoard.id}" />
													</h5>

												</div>
											</div>

										</div>
										<h5 class="pb-2 border-bottom mb-4">Phases</h5>
										<div class="info-container">
											<!-- Accordion Header Color -->
											<div class="col-md">
												<div class="accordion mt-3 accordion-header-primary"
													id="accordionStyle1">
													
													
													
												</div>
											</div>
											<!--/ Accordion Header Color -->

											<div class="d-flex justify-content-center pt-3">
												<a href="javascript:;" class="btn btn-primary me-3"
													data-bs-target="#addNewBoard" data-bs-toggle="modal"
													id="addNewBoardbtn">Add Phase</a>

											</div>
										</div>
									</div>
								</div>
								<!-- /User Card -->

							</div>
							<!--/ User Sidebar -->

							<!-- Edit Phases Modal -->
							<div class="modal fade" id="addNewBoard" tabindex="-1"
								aria-hidden="true">
								<div
									class="modal-dialog modal-dialog-centered1 modal-simple modal-add-new-cc">
									<div class="modal-content p-3 p-md-5">

										<div class="modal-body">
											<button type="button" class="btn-close"
												data-bs-dismiss="modal" aria-label="Close"></button>
											<div class="text-center mb-4">
												<h5>Phase Details</h5>

											</div>
											<form id="editPhasedetailsForm"
												class="row g-3 needs-validation" onsubmit="return false">

												<div class="col-12 ">
													<label class="form-label" for="Model_Phasename">Name</label>
													<input type="text" class="form-control"
														id="Model_Phasename" name="Model_Phasename" required /> <input
														type="hidden" id="Model_phase_id" name="Model_phase_id" />
												</div>
												<div class="col-12 ">
													<label class="form-label" for="Model_orderID">Order
														No</label> <input type="number" class="form-control"
														id="Model_orderID" name="Model_orderID" required />
												</div>
												<div class="col-12 text-center mt-4">
													<button type="submit"
														class="btn btn-primary editPhasedatasubmit me-sm-3 me-1">ADD</button>
													<button type="reset"
														class="btn btn-label-secondary editPhasedataclose"
														data-bs-dismiss="modal" aria-label="Close">
														Cancel</button>
												</div>
											</form>
										</div>
									</div>
								</div>
							</div>
							<!--/ Edit Phase Modal -->

							<!--scrolling content Modal -->
							<div class="modal fade" id="ItemStatusScrollable" tabindex="-1"
								role="dialog" aria-labelledby="ItemStatusScrollableTitle"
								aria-hidden="true">
								<div class="modal-dialog modal-dialog-scrollable"
									role="document">
									<div class="modal-content">
										<div class="modal-header">
											<h5 class="modal-title white" id="ItemStatusScrollableTitle"></h5>
											<button type="button" class="btn-close"
												data-bs-dismiss="modal" aria-label="Close"></button>
										</div>
										<div class="modal-body">
											<div class="col-md-12">
												<div class="form-group">
													<label for="addmodel" id="additemalltxt"></label>
													<div class="position-relative">
														<fieldset class="form-group">
															<input type="text" id="additemall" name="addmodel"
																class="form-control capitalize">
														</fieldset>
													</div>
												</div>
											</div>

										</div>
										<div class="modal-footer">
											<button type="button" class="btn btn-light-secondary"
												data-bs-dismiss="modal">
												<i class="bx bx-x d-block d-sm-none"></i> <span
													class="d-none d-sm-block">Close</span>
											</button>
											<button type="button" class="btn btn-primary ml-1"
												id="additemallsavebtn">
												<i class="bx bx-check d-block d-sm-none"></i> <span
													class="d-none d-sm-block">ADD</span>
											</button>
										</div>
									</div>
								</div>
							</div>
							<!--scrolling content Modal -->

							<!-- Edit Activity Modal -->
							<div class="modal fade" id="addevent" tabindex="-1"
								aria-hidden="true">
								<div
									class="modal-dialog modal-lg modal-dialog-centered modal-simple">
									<div class="modal-content p-3 p-md-5">

										<div class="modal-body">
											<button type="button"
												class="btn-close activityMasterformclose"
												data-bs-dismiss="modal" aria-label="Close"></button>
											<div class="text-center mb-4">
												<h3>Activity Information</h3>
												<p>Update Activity Basic Information</p>
											</div>
											<form id="activityMasterform"
												th:object="${projectTemplateactivityMaster}"
												class="wizard-horizontal" onsubmit="return false"
												enctype="multipart/form-data">
												<!-- ------------------------------------------ -->
												<div class="row">
													<div class="col-md-12">
														<label for="addmodel">Activity Title</label>
														<div class="form-group">
															<div class="position-relative">
																<input type="hidden" id="phaseid" name="phaseid" /> <input
																	type="hidden" name="boardid"  id="boardidA"
																	th:value="${projectTemplateBoard.id}" /> <input
																	type="hidden" th:field="*{projectactivityid}"
																	id="projectactivityid"
																	th:value="${projectTemplateactivityMaster['projectactivityid']}" />

																<input type="text"
																	class="form-control   capitalize ActivityTitle"
																	placeholder="Task details..."
																	th:field="*{activitytitle}" id="activitytitle"
																	th:value="${projectTemplateactivityMaster['activitytitle']}"
																	required />

															</div>
														</div>
													</div>
													<div class="col-12">
														<div class="form-group">
															<div class="btn-group btn-group-toggle mb-1"
																data-toggle="buttons">
																<label
																	th:class="'btn btn-outline-primary activitytypedefault activitytype activitytypeTask '+ ${projectTemplateactivityMaster['activitytype']=='Task' ? 'active' :''} "
																	onclick="optionshandle(this);" title="Task"> <input
																	type="radio" name="options"
																	onclick="optionshandle(this);"
																	th:field="*{activitytype}" value="Task" id="radio1"
																	style="visibility: hidden" required><i
																	class="bx bx-alarm-add activitytypeicon"></i>
																</label> <label
																	th:class="'btn btn-outline-primary activitytype activitytypeCall '+ ${projectTemplateactivityMaster['activitytype']=='Call' ? 'active' :''} "
																	onclick="optionshandle(this);" title="Call"> <input
																	type="radio" name="options"
																	onclick="optionshandle(this);"
																	th:field="*{activitytype}" value="Call" id="radio2"
																	style="visibility: hidden" required><i
																	class="bx bx-phone-call activitytypeicon"></i>
																</label> <label
																	th:class="'btn btn-outline-primary activitytype activitytypeMeetings '+ ${projectTemplateactivityMaster['activitytype']=='Meetings' ? 'active' :''} "
																	onclick="optionshandle(this);" title="Meetings">
																	<input type="radio" onclick="optionshandle(this);"
																	name="options" th:field="*{activitytype}"
																	value="Meetings" id="radio3" style="visibility: hidden"
																	required><i
																	class="bx bx-group activitytypeicon"></i>
																</label>
															</div>
														</div>


													</div>

													<div class="col-md-6">
														<div class="form-group">
															<label for="addmodel">days from project start
																date</label>
															<div class="position-relative has-icon-left">
																<input type="number" class="form-control  "
																	th:field="*{daysfromprojectstartdate}"
																	id="daysfromprojectstartdate"
																	th:value="${projectTemplateactivityMaster['daysfromprojectstartdate']}"
																	required />


															</div>
														</div>
													</div>
													<div class="col-md-6">
														<div class="form-group">
															<label for="addmodel">Activity Order
																</label>
															<div class="position-relative has-icon-left">
																<input type="number" class="form-control  "
																	th:field="*{activityorder}"
																	id="activityorder"
																	th:value="${projectTemplateactivityMaster['activityorder']}"
																	required />


															</div>
														</div>
													</div>

													<div class="col-md-12">
														<div class="form-group">
															<label for="addmodel">Note </label><span class="notes-sm">(Note
																visible only For You)</span>
															<div class="position-relative  has-icon-left">
																<fieldset class="form-group">
																	<textarea class="form-control " rows="4"
																		th:field="*{notes}" id="notes"
																		th:value="${projectTemplateactivityMaster['notes']}"
																		required>
																							</textarea>

																</fieldset>
															</div>
														</div>

													</div>


												</div>

												<div class="col-md-12">
													<div class="form-group">
														<label for="addmodel">Followers</label>
														<div class="position-relative  has-icon-left">
															<fieldset class="form-group">
																<select class="select2 form-control "
																	id="activityfollowers" name="activityfollowers" required>
																	<th:block th:each="str :${employeelist}">
																		<option th:value="${str.empMasterid}"
																			th:text="${str.StaffName}"></option>
																	</th:block>
																</select>

															</fieldset>
														</div>
													</div>
												</div>


												<div class="col-md-12">
													<br />
													<button type="reset"
														class="btn btn-secondary mr-1 mb-1 activityMasterformreset"
														style="padding-right: 20px;">Reset</button>
													<button type="submit"
														class="btn btn-primary mr-1 mb-1 activityMasterformsubmit"
														style="float: right">Save</button>


												</div>
												<!-- ------------------------------------------ -->
											</form>
										</div>
									</div>
								</div>
							</div>

							<!--/ Edit Activity Modal -->
							<!-- /Modal -->
						</div>
						<!-- / Content -->

						<!-- Footer -->
						<footer class="content-footer footer bg-footer-theme">
							<div
								class="container-fluid d-flex flex-wrap justify-content-between py-2 flex-md-row flex-column">
								<div class="mb-2 mb-md-0"></div>
								<div></div>
							</div>
						</footer>
						<!-- / Footer -->

						<div class="content-backdrop fade"></div>
					</div>
					<!-- Content wrapper -->
				</div>
				<!-- / Layout page -->
			</div>

			<!-- Overlay -->
			<div class="layout-overlay layout-menu-toggle"></div>

			<!-- Drag Target Area To SlideIn Menu On Small Screens -->
			<div class="drag-target"></div>
		</div>
		<!-- / Layout wrapper -->


		<!-- Core JS -->
		<!-- build:js assets/vendor/js/core.js -->
		<script th:src="@{/assets/vendor/libs/jquery/jquery.js}"></script>
		<script th:src="@{/assets/vendor/libs/popper/popper.js}"></script>
		<script th:src="@{/assets/vendor/js/bootstrap.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js}"></script>

		<script th:src="@{/assets/vendor/libs/hammer/hammer.js}"></script>

		<script th:src="@{/assets/vendor/libs/i18n/i18n.js}"></script>
		<script th:src="@{/assets/vendor/libs/typeahead-js/typeahead.js}"></script>

		<script th:src="@{/assets/vendor/js/menu.js}"></script>
		<!-- endbuild -->

		<!-- Vendors JS -->
		<script th:src="@{/assets/vendor/libs/moment/moment.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables/jquery.dataTables.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-bs5/datatables-bootstrap5.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-responsive/datatables.responsive.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons/datatables-buttons.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.js}"></script>
		<script th:src="@{/assets/vendor/libs/jszip/jszip.js}"></script>
		<script th:src="@{/assets/vendor/libs/pdfmake/pdfmake.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons/buttons.html5.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons/buttons.print.js}"></script>
		<script th:src="@{/assets/vendor/libs/sweetalert2/sweetalert2.js}"></script>
		<script th:src="@{/assets/vendor/libs/cleavejs/cleave.js}"></script>
		<script th:src="@{/assets/vendor/libs/cleavejs/cleave-phone.js}"></script>
		<script th:src="@{/assets/vendor/libs/select2/select2.js}"></script>




		<!-- Main JS -->
		<script th:src="@{/assets/js/main.js}"></script>

		<!-- Flat Picker -->
		<script th:src="@{/assets/vendor/libs/moment/moment.js}"></script>
		<script th:src="@{/assets/vendor/libs/flatpickr/flatpickr.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/jquery-timepicker/jquery-timepicker.js}"></script>
		<script th:src="@{/assets/vendor/libs/pickr/pickr.js}"></script>
		<script th:src="@{/assets/vendor/libs/tagify/tagify.js}"></script>
		<script th:src="@{/assets/js/forms-selects.js}"></script>
		<!-- Page JS -->
		<!-- <script th:src="@{/assets/js/modal-edit-user.js}"></script> -->
		<script th:src="@{/assets/js/app-user-view.js}"></script>
		<script th:src="@{/assets/js/app-user-view-account.js}"></script>



		<script>
			$(document)
					.ready(
							function() {
								
								
								//--------------------------------------------------------------------------------------------------------------------------------------		 		

								$(function() {
									var token = $("meta[name='_csrf']").attr(
											"content");
									var header = $("meta[name='_csrf_header']")
											.attr("content");
									$(document).ajaxSend(
											function(e, xhr, options) {
												xhr.setRequestHeader(header,
														token);
											});
								});
								//--------------------------------------------------------------------------------------------------------------------------------------
								function validationphaseformreset() {
									$('.editPhasedataclose').click();
									$("#Model_phase_id").val(0);
									$('.editPhasedatasubmit').prop("disabled",false);
									$('.editPhasedatasubmit').html("Save");
								}
								$("#addNewBoardbtn").click(function() {
									$('.editPhasedataclose').click();
									$("#Model_phase_id").val(0);
									$('.editPhasedatasubmit').prop("disabled",false);
									$('.editPhasedatasubmit').html("Save");
								});
								$(document).on("click",".addactivity", function() {
									$('.activityMasterformreset').click();
									$('.activityMasterformsubmit').prop("disabled",
											false);
									$('.activityMasterformsubmit').html("Save");
									$("#activityId").val(0);
									
									$("input[name=activitytype][value=Task]").attr('checked', true);
									$(".activitytype").removeClass("active");
									$(".activitytypeTask").addClass("active");
									$("#phaseid").val($(this).attr("name"));
									$("#addevent").modal('show');
								});
								//--------------------------------------------------------------------------------------------------------------------------------------
								$('#editPhasedetailsForm').on('submit',function(event) {
											if (event.target.checkValidity()) {
												$('.editPhasedatasubmit').prop("disabled",true);
												$('.editPhasedatasubmit').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
												const formData = new FormData(document.querySelector("#editPhasedetailsForm"));
												formData.append("boardid",$("#boardid").val());
												formData.append("phaseid",$("#phaseid").val());
												
												$.ajax({
													type : "POST",
													url : "projecttemplatesave",
													processData : false,
													contentType : false,
													data : formData,
													success : function(
															result) {
														
														validationphaseformreset();
														
														Swal.fire({
													        title: '',
													        text: 'Your Phase event Updated',
													        imageUrl: assetsPath + 'img/backgrounds/15.jpg',
													        imageWidth: 400,
													        imageAlt: 'Custom image',
													        confirmButtonText: 'Ok',
													        customClass: {
													          confirmButton: 'btn btn-primary'
													        },
													        buttonsStyling: false
													      });
														
														getphaseandactivitydetails();

													},
													error : function(e) {
														console.log("Error"+ e);
													}
												});
											} else {
												$('.editPhasedatasubmit').prop("disabled",false);
											}

										});
								// --------------------------------------------------------------------
								function validationactivityeventformreset() {
									$('.activityMasterformreset').click();
									$('.activityMasterformclose').click();									
									$('.activityMasterformsubmit').prop("disabled",
											false);
									$('.activityMasterformsubmit').html("Save");
								}
								
								// --------------------------------------------------------------------
								$('#activityMasterform').on('submit',function(event) {
									
									if (event.target.checkValidity()) {
										$('.activityMasterformsubmit').prop("disabled",true);
										$('.activityMasterformsubmit').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
										const formData = new FormData(
												document
														.querySelector("#activityMasterform"));
										//formData.append("mastercategoryid",$("#mastercategoryid").val());
										
										$.ajax({
											type : "POST",
											url : "projecttemplateactivitysave",
											processData : false,
											contentType : false,
											data : formData,
											success : function(
													result) {
												
												
												Swal.fire({
											        title: '',
											        text: 'Your Activity event added',
											        imageUrl: assetsPath + 'img/backgrounds/15.jpg',
											        imageWidth: 400,
											        imageAlt: 'Custom image',
											        confirmButtonText: 'Ok',
											        customClass: {
											          confirmButton: 'btn btn-primary'
											        },
											        buttonsStyling: false
											      });
												
												getphaseandactivitydetails_part($("#phaseid").val());
												validationactivityeventformreset();
												
											},
											error : function(e) {
												console.log("Error"+ e);
											}
										});
									} else {
										$('.activityMasterformsubmit').prop("disabled",false);
									}

								});
								//--------------------------------------------------------------------------------
								function getphaseandactivitydetails_part(phaseid) {
									
									var formData = {
											boardid : "[[${projectTemplateBoard.id}]]",
										}
		
										$.ajax({
											type : "POST",
											url : "getboarddetails",
											data : formData,
											success : function(result) {
												console.log(result);
												html = "";
												result.projectTemplatePhase.forEach(function (obj) {
												
													if(obj.id == phaseid)
													{
													   obj.projecttemplateactivityMaster.forEach(function (Actobj) {
															let tempicon="";
															if(Actobj.activitytype =='Task'){
																tempicon ='<i class="bx bx-alarm-add activitytypeicon acticon "></i>';
															}else if(Actobj.activitytype =='Call'){
																tempicon ='<i class="bx bx-phone-call activitytypeicon acticon"></i>';
															}else if(Actobj.activitytype =='Meetings'){
																tempicon ='<i class="bx bx-group activitytypeicon acticon"></i>';
															}
															html +='  <tr>	<td>'+ tempicon +'   <span class="editactivity" id="actid'+ Actobj.projectactivityid+'" onclick="editactivity(this)">' + Actobj.activitytitle +'</span></td> <td>'+ Actobj.daysfromprojectstartdate +'</td> <td>'+ Actobj.activityorder +'</td><td>'+ Actobj.notes +'</td> </tr>';
															
													   	}); 
													}	
													
												});
													
											
											$(".activitycontainer"+ phaseid).html(html);
											
											},
											error : function(e) {
												console.log("Error" + e);
		
											}
		
										});
									
								}
								
								//--------------------------------------------------------------------------------
								//function load the history events
								function getphaseandactivitydetails() {
									
									var formData = {
										boardid : "[[${projectTemplateBoard.id}]]",
										
									}
	
									$.ajax({
										type : "POST",
										url : "getboarddetails",
										data : formData,
										success : function(result) {
											//console.log(result);
											html = "";
											let i=0;
											result.projectTemplatePhase.forEach(function (obj) {
											   i++;
											   html +='<div class="accordion-item card"><h2 class="accordion-header"><button type="button" class="accordion-button collapsed" ';
												html +=`style="background-color: #f2f2f6;" data-bs-toggle="collapse" data-bs-target="#accordionStyle-${obj.id}" id="accordionStyle${obj.id}" aria-expanded="false"> ${obj.phaseName}</button> </h2>`;
												html +=`<div id="accordionStyle-${obj.id}" class="accordion-collapse collapse" data-bs-parent="#accordionStyle${obj.id}">`;
												html +=' <table class="table"><thead><tr><th>Activity Name</th><th>Start Day</th><th>Order</th><th>Notes</th></tr></thead><tbody class="table-border-bottom-0 activitycontainer'+ obj.id +'">';
												obj.projecttemplateactivityMaster.forEach(function (Actobj) {
													
													let tempicon="";
													if(Actobj.activitytype =='Task'){
														tempicon ='<i class="bx bx-alarm-add activitytypeicon acticon "></i>';
													}else if(Actobj.activitytype =='Call'){
														tempicon ='<i class="bx bx-phone-call activitytypeicon acticon"></i>';
													}else if(Actobj.activitytype =='Meetings'){
														tempicon ='<i class="bx bx-group activitytypeicon acticon"></i>';
													}
													
														html +='  <tr>	<td>'+ tempicon +'   <span class="editactivity" id="actid'+ Actobj.projectactivityid+'" onclick="editactivity(this)">' + Actobj.activitytitle +'</span></td> <td>'+ Actobj.daysfromprojectstartdate +'</td> <td>'+ Actobj.activityorder +'</td><td>'+ Actobj.notes +'</td> </tr>';
												
												}); 
												
												html += `</tbody></table> <br /><span class="addactivity col-12"name="${obj.id}">+ Add Activity</span></div></div></div>`;
												
											});
												
										
										$("#accordionStyle1").html(html);
										
										},
										error : function(e) {
											console.log("Error" + e);
	
										}
	
									});
	
								}
								// --------------------------------------------------------------------
								$(document).ready(function(){
								    setTimeout(function(){
								    	getphaseandactivitydetails();
								    	
								     },500); // milliseconds
								});
							}); // Jquery
			// --------------------------------------------------------------------
			//--------------------------
			function editactivity(e){
				var activityid= e.getAttribute("id").replace("actid","");
				var formData = {
						id : activityid,
						boardid: $("#boardid").val()
					}

					$.ajax({
						type : "POST",
						url : "getProjectTemplateActivityMaster",
						data : formData,
						success : function(result) {
							var bmobj = JSON.parse(JSON.stringify(result));
							//console.log(bmobj);
							
							$("#phaseid").val(bmobj.tempphaseid);
							$("#boardidA").val($("#boardid").val());
							$("#projectactivityid").val(bmobj.projectactivityid);
							$("#activitytitle").val(bmobj.activitytitle);
							$("#daysfromprojectstartdate").val(bmobj.daysfromprojectstartdate);
							$("#activityorder").val(bmobj.activityorder);
							$("#notes").val(bmobj.notes);
							$("#activityfollowers").val(bmobj.activityfollowers).change();
							$("input[name=activitytype][value="+ bmobj.activitytype +"]").attr('checked', true);
							$(".activitytype").removeClass("active");
							$(".activitytype"+bmobj.activitytype).addClass("active");
							$('#addevent').modal('show'); 
						},
						error : function(e) {
							console.log("Error" + e);
						}
					});
			};
			
		</script>
</body>
</html>
