<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" lang="en"
	class="light-style layout-navbar-fixed layout-menu-fixed" dir="ltr"
	data-theme="theme-default" th:data-assets-path="@{/assets/}"
	data-template="vertical-menu-template">
<head>
<meta name="_csrf" th:content="${_csrf.token}" />
<!-- default header name is X-CSRF-TOKEN -->
<meta name="_csrf_header" th:content="${_csrf.headerName}" />

<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

<title>Project List</title>

<meta name="description" content="" />

<!-- Favicon -->
<link rel="icon" type="image/x-icon"
	th:href="@{/assets/img/favicon/favicon.ico}" />

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
	href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Rubik:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
	rel="stylesheet" type="text/css" />

<!-- Icons -->
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/fonts/boxicons.css}" />
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/fonts/fontawesome.css}" />
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/fonts/flag-icons.css}" />

<!-- Core CSS -->
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/css/rtl/core.css}"
	class="template-customizer-core-css" />
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/css/rtl/theme-default.css}"
	class="template-customizer-theme-css" />
<link rel="stylesheet" type="text/css" th:href="@{/assets/css/demo.css}" />

<!-- Vendors CSS -->
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css}" />
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/libs/typeahead-js/typeahead.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-bs5/datatables.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-checkboxes-jquery/datatables.checkboxes.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/sweetalert2/sweetalert2.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/flatpickr/flatpickr.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/jquery-timepicker/jquery-timepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/pickr/pickr-themes.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/tagify/tagify.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/select2/select2.css}" />

<!-- Row Group CSS -->
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-rowgroup-bs5/rowgroup.bootstrap5.css}" />
<!-- Form Validation -->
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/formvalidation/dist/css/formValidation.min.css}" />


<!-- Page CSS -->

<!-- Helpers -->
<script th:src="@{/assets/vendor/js/helpers.js}"></script>

<!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
<!--? Template customizer: To hide customizer set displayCustomizer value false in config.js.  -->
<script th:src="@{/assets/vendor/js/template-customizer.js}"></script>
<!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
<script th:src="@{/assets/js/config.js}"></script>
<style>
#branchName, #branchemail, #branch_startdate {
	border-right: solid 1px #d4d8dd;
}

.tooltipx .tooltiptextx {
	visibility: hidden;
	font-size: 12px;
	min-width: 120px;
	background-color: black;
	color: #fff;
	text-align: center;
	border-radius: 6px;
	padding: 5px 0;
	/* Position the tooltip */
	position: absolute;
	z-index: 1;
}

.tooltipx:hover .tooltiptextx {
	visibility: visible;
}

.innertablefollowers td {
	border: none;
	padding-left: 0.1rem;
	padding-right: 0.1rem;
	margin: none;
}

.tooltipx {
	position: relative;
	display: inline-block;
}

.tooltipx .tooltiptextx {
	visibility: hidden;
	font-size: 12px;
	min-width: 120px;
	background-color: black;
	color: #fff;
	text-align: center;
	border-radius: 6px;
	padding: 5px 0;
	/* Position the tooltip */
	position: absolute;
	z-index: 1;
}

.tooltipx:hover .tooltiptextx {
	visibility: visible;
}

td {
	line-height: 20px;
}
</style>
</head>

<body>
	<!-- Layout wrapper -->
	<div class="layout-wrapper layout-content-navbar">
		<div class="layout-container">
			<!-- Menu -->
			<div th:insert="menu"></div>
			<!-- / Menu -->

			<!-- Layout container -->
			<div class="layout-page">
				<!-- Navbar -->

				<div th:insert="header"></div>

				<!-- / Navbar -->

				<!-- Content wrapper -->
				<div class="content-wrapper">
					<!-- Content -->
					<div class="container-xxl flex-grow-1 container-p-y">
						<h4 class="py-3 breadcrumb-wrapper mb-4">
							<span class="text-muted fw-light">Works / </span>Projects
						</h4>



						<!-- DataTable with Buttons -->
						<div class="card">
							<div class="card-datatable table-responsive pt-0">
								<table class="datatables-basic table table-bordered">
									<thead>
										<tr>
											<th></th>
											<th></th>
											<th>id</th>
											<th>Title</th>
											<th>Activity</th>
											<th>Followers</th>
											<th>Phase</th>
											<th>Source</th>
											<th>Purpose</th>
											<th>Branch</th>
											<th>Value</th>
											<th>Project In</th>

										</tr>
									</thead>
								</table>
							</div>
						</div>

						<!-- start Offcanvas -->
						<button class="btnoffcanvas btn btn-primary" type="button"
							data-bs-toggle="offcanvas" data-bs-target="#offcanvasEnd"
							aria-controls="offcanvasEnd" style="visibility: hidden"></button>
						<div class="offcanvas offcanvas-end" tabindex="-1"
							id="offcanvasEnd" aria-labelledby="offcanvasEndLabel">
							<div class="offcanvas-header">
								<h5 id="offcanvasEndLabel" class="offcanvas-title">New
									Project</h5>
								<button type="button" class="btn-close text-reset"
									data-bs-dismiss="offcanvas" aria-label="Close"></button>
							</div>
							<div class="offcanvas-body flex-grow-1">
								<form class="add-new-record pt-0 row g-2 addnewproject"
									id="form-add-new-record" onsubmit="return false">
									<div class="col-sm-12">
										<label class="form-label" for="ContactPersonTagify">CONTACT
											PERSON
											<div class="spinner-border spinner-border-sm text-primary"
												role="status" style="visibility: hidden">
												<span class="sr-only">Loading...</span>
											</div>
										</label>
										<div>

											<!-- Custom Suggestions: Inline -->
											<div class="col-sm-12">
												<input id="ContactPersonTagify" name="ContactPersonTagify"
													class="form-control" required />
											</div>
											<!-- Custom Suggestions: List -->


										</div>
									</div>
									<div class="col-sm-12">
										<label class="form-label" for="organization">organization</label>
										<div>
											<input id="organization" name="organization"
												class="form-control" />
										</div>

									</div>
									<div class="col-sm-12">
										<label class="form-label" for="phonenumber">WORK PHONE</label>
										<div>
											<input type="text" id="phonenumber"
												class="form-control phone-number-otp-mask"
												name="phonenumber" required />


										</div>
									</div>
									<div class="col-sm-12">
										<label class="form-label" for="Title">TITLE</label>
										<div>
											<input type="text" id="Title" name="Title"
												class="form-control  capitalize" required>

										</div>

									</div>
									<div class="col-sm-12">
										<label class="form-label" for="startDate">Project In
											Date</label>
										<div>
											<input type="text" id="startDate" name="startDate"
												class="form-control " required="required">

										</div>

									</div>
									<div class="col-sm-12">
										<label class="form-label" for="pipeline">Phase </label>
										<div>
											<select class="form-control " id="pipeline" name="pipeline">
												<th:block th:each="str :${Phase}">
													<option th:value="${str}" th:text="${str}"></option>
												</th:block>
											</select>
										</div>
									</div>
									<div class="col-sm-12">
										<label class="form-label" for="Purpose">Nature of Work</label>
										<div>

											<select class="form-control" id="NatureofWork"
												name="NatureofWork">
												<option value="">-</option>
												<th:block th:each="str :${NATUREOFWORK}">
													<option th:value="${str}" th:text="${str}"></option>
												</th:block>
											</select>

										</div>

									</div>
									<div class="col-sm-12">
										<label class="form-label" for="Area">Area</label>
										<div>
											<input type="number" id="Area" name="Area" step="any"
												class="form-control " required="required">

										</div>

									</div>
									<div class="col-sm-12">
										<label class="form-label" for="">Unit</label>
										<div>

											<select class="form-control" id="UNITS" name="UNITS">
												<th:block th:each="str :${UNITS}">
													<option th:value="${str}" th:text="${str}"></option>
												</th:block>
											</select>

										</div>

									</div>
									<div class="col-sm-12">
										<label class="form-label" for="Location">Location</label>
										<div>
											<input type="text" id="Location" name="Location"
												class="form-control " required="required">

										</div>

									</div>
									<div class="col-sm-12">
										<label class="form-label" for="tdate">T Date</label>
										<div>
											<input type="text" id="tdate" name="tdate"
												class="form-control " required="required">

										</div>

									</div>
									<div class="col-sm-12">
										<label class="form-label" for="projectValue">T.
											Estimate</label>
										<div>
											<input type="number" id="projectValue" name="projectValue"
												step="any" class="form-control  capitalize">

										</div>

									</div>

									<div class="col-sm-12">
										<label class="form-label" for="Purpose">PURPOSE</label>
										<div>

											<select class="form-control  addPurposedata" id="Purpose"
												name="Purpose">
												<th:block th:each="str :${PURPOSE}">
													<option th:value="${str}" th:text="${str}"></option>
												</th:block>
											</select>

										</div>

									</div>


									<div class="col-sm-12">
										<label class="form-label" for="Source">SOURCE</label>
										<div>
											<select class="form-control  addsourcedata" id="Source"
												name="Source">
												<th:block th:each="str :${SOURCE}">
													<option th:value="${str}" th:text="${str}"></option>
												</th:block>
											</select>
										</div>

									</div>

									<div class="col-sm-12 Referencediv">
										<label class="form-label" for="Reference">REFERENCE</label>
										<div>

											<select class="form-control " id="Reference" name="Reference">
												<option value="">-</option>
												<th:block th:each="str :${personlist}">
													<option th:value="${str.id}" th:text="${str.peoplename}"></option>
												</th:block>
											</select>
										</div>

									</div>
									<div class="col-sm-12">
										<label class="form-label" for="label">Label</label>
										<div>
											<select class="form-select  form-control " id="label"
												name="label" required>
												<th:block th:each="str :${Label}">
													<option th:value="${str}" th:text="${str}"></option>
												</th:block>
											</select>

										</div>
									</div>
									<div class="col-sm-12">
										<label class="form-label" for="branch">BRANCH</label>
										<div>
											<select class="form-select  form-control " id="branch"
												name="branch" required>
												<th:block th:each="str :${branchlist}">
													<option th:value="${str.id}" th:text="${str.BRANCH_NAME}"></option>
												</th:block>
											</select>

										</div>
									</div>
									<div class="col-sm-12">
										<label class="form-label" for="followers">Follower</label>
										<div>
											<select class="form-select followers form-control "
												id="followers" name="followers" required>
												<th:block th:each="str :${employeelist}">
													<option th:value="${str.empMasterid}"
														th:text="${str.StaffName}"></option>
												</th:block>
											</select>

											<div class="invalid-feedback">Please select follower.</div>
										</div>
									</div>
									<div class="col-sm-12">
										<label class="form-label" for="Status">Status</label>
										<div>
											<select class="form-control " id="Status" name="Status">
												<option value="">-</option>
												</th:block>
												<th:block th:each="str :${ProjectStatus}">
													<option th:value="${str}" th:text="${str}"></option>
												</th:block>
											</select>
										</div>

									</div>




									<div class="col-sm-12">
										<button type="submit"
											class="btn btn-primary newprojectdatasubmit me-sm-3 me-1">Submit</button>
										<button type="reset"
											class="btn btn-outline-secondary newprojectdataclose"
											data-bs-dismiss="offcanvas">Cancel</button>
									</div>
								</form>
							</div>
						</div>
						<!-- start Offcanvas -->

						<!--scrolling content Modal -->
						<div class="modal fade" id="additemStatusScrollable" tabindex="-1"
							role="dialog" aria-labelledby="additemStatusScrollableTitle"
							aria-hidden="true">
							<div class="modal-dialog modal-dialog-scrollable" role="document">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title white" id="ItemStatusScrollableTitle"></h5>
										<button type="button" class="btn-close"
											data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<div class="col-md-12">
											<div class="form-group">
												<label for="addmodel" id="additemalltxt"></label>
												<div class="position-relative">
													<fieldset class="form-group">
														<input type="text" id="additemtxt" name="addmodel"
															class="form-control capitalize">
													</fieldset>
												</div>
											</div>
										</div>

									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-light-secondary"
											data-dismiss="modal">
											<i class="bx bx-x d-block d-sm-none"></i> <span
												class="d-none d-sm-block">Close</span>
										</button>
										<button type="button" class="btn btn-primary ml-1"
											id="additemallsavebtn">
											<i class="bx bx-check d-block d-sm-none"></i> <span
												class="d-none d-sm-block">ADD</span>
										</button>
									</div>
								</div>
							</div>
						</div>
						<!--scrolling content Modal -->
						<!-- / Content -->

						<!-- Footer -->
						<footer class="content-footer footer bg-footer-theme"> </footer>
						<!-- / Footer -->

						<div class="content-backdrop fade"></div>
					</div>
					<!-- Content wrapper -->
				</div>
				<!-- / Layout page -->
			</div>

			<!-- Overlay -->
			<div class="layout-overlay layout-menu-toggle"></div>

			<!-- Drag Target Area To SlideIn Menu On Small Screens -->
			<div class="drag-target"></div>
		</div>
		<!-- / Layout wrapper -->

		<!-- Core JS -->
		<!-- build:js assets/vendor/js/core.js -->
		<script th:src="@{/assets/vendor/libs/jquery/jquery.js}"></script>
		<script th:src="@{/assets/vendor/libs/popper/popper.js}"></script>
		<script th:src="@{/assets/vendor/js/bootstrap.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js}"></script>

		<script th:src="@{/assets/vendor/libs/hammer/hammer.js}"></script>

		<script th:src="@{/assets/vendor/libs/i18n/i18n.js}"></script>
		<script th:src="@{/assets/vendor/libs/typeahead-js/typeahead.js}"></script>

		<script th:src="@{/assets/vendor/js/menu.js}"></script>
		<!-- endbuild -->

		<!-- Vendors JS -->
		<script
			th:src="@{/assets/vendor/libs/datatables/jquery.dataTables.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-bs5/datatables-bootstrap5.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-responsive/datatables.responsive.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-checkboxes-jquery/datatables.checkboxes.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons/datatables-buttons.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.js}"></script>
		<script th:src="@{/assets/vendor/libs/jszip/jszip.js}"></script>
		<script th:src="@{/assets/vendor/libs/pdfmake/pdfmake.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons/buttons.html5.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons/buttons.print.js}"></script>
		<!-- Flat Picker -->
		<script th:src="@{/assets/vendor/libs/moment/moment.js}"></script>
		<script th:src="@{/assets/vendor/libs/flatpickr/flatpickr.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/jquery-timepicker/jquery-timepicker.js}"></script>
		<script th:src="@{/assets/vendor/libs/pickr/pickr.js}"></script>

		<!-- Row Group JS -->
		<script
			th:src="@{/assets/vendor/libs/datatables-rowgroup/datatables.rowgroup.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-rowgroup-bs5/rowgroup.bootstrap5.js}"></script>
		<script th:src="@{/assets/vendor/libs/sweetalert2/sweetalert2.js}"></script>
		<script th:src="@{/assets/vendor/libs/tagify/tagify.js}"></script>
		<script th:src="@{/assets/vendor/libs/cleavejs/cleave.js}"></script>
		<script th:src="@{/assets/vendor/libs/cleavejs/cleave-phone.js}"></script>
		<script th:src="@{/assets/vendor/libs/select2/select2.js}"></script>
		<!-- Form Validation -->
		<script
			th:src="@{/assets/vendor/libs/formvalidation/dist/js/FormValidation.min.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/formvalidation/dist/js/plugins/Bootstrap5.min.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/formvalidation/dist/js/plugins/AutoFocus.min.js}"></script>

		<!-- Main JS -->
		<script th:src="@{/assets/js/main.js}"></script>

		<!-- Page JS -->
		<!-- <script th:src="@{/assets/js/tables-datatables-basic.js}"></script> -->
		<script th:src="@{/assets/js/form-validation.js}"></script>
		<script>
    $(document).ready(function() {  
    	//--------------------------------------------------------------------------------------------------------------------------------------
    	let fv;
    	
    	//--------------------------------------------------------------------------------------------------------------------------------------
    	// Custom list & inline suggestion
	  //------------------------------------------------------
	   $.ajax({
							type : "GET",url : "leadcplist",
							data : "", success : function(result) {
								
								const ContactPersonTagifyEl = document.querySelector('#ContactPersonTagify');
								 
								  const whitelist = result;
								  // Inline
								  let ContactPersonTagify = new Tagify(ContactPersonTagifyEl, {
								    whitelist: whitelist,
								    maxTags: 1,
								    dropdown: {
								      maxItems: 20,
								      classname: 'tags-inline',
								      enabled: 0,
								      closeOnSelect: false
								    }
								  });
								
							}
	   });
	 //--------------------------------------------------------------------------------------  
	   const TagifyCustomListSuggestionEl = document.querySelector('#organization');

	  $.ajax({
				type : "GET",url : "organizationNameListtype1",
				data : '', success : function(result) {
					
					 // List
				    let TagifyCustomListSuggestion = new Tagify(TagifyCustomListSuggestionEl, {
				      whitelist: result,
				      maxTags: 1,
				      dropdown: {
				        maxItems: 20,
				        classname: 'tags-inline',
				        enabled: 0,
				        closeOnSelect: false
				      }
				    });
					 
				}
	  });
		//--------------------------------------------------------------------------------------------------------------------------------------		
			$(".Referencediv").hide();

			$('#Source').change(function(){
				
				if($(this).val()=='Referral')
				{
					$(".Referencediv").show();
				}else
				{
					$(".Referencediv").hide();
				}
			});
		//--------------------------------------------------------------------------------------------------------------------------------------
		$(document).on("click", ".additem", function() {

			var name = $(this).attr('name');
			var labeltext = "";
			if (name == "addsourcedata") {
				labeltext = "New Source";
			}else if (name == "addPurposedata") {
				labeltext = "New Purpose";
			}

			$('#additemalltxt').text(labeltext);
			$('#additemStatusScrollable').modal('toggle');

		});
		//-----------------------------------------------------------
		$("#additemallsavebtn").click(
				function() {
					if ($("#additemall").val() != '') {
						var name = $('#additemalltxt').text();
						var labeltext = "";
						if (name == "New Source") {
							labeltext = "addsourcedata";
						}else if (name == "New Purpose") {
							labeltext = "addPurposedata";
						}

						$('.' + labeltext).append(
								"<option value='"
										+ $("#additemtxt").val()
										+ "'>"
										+ $("#additemtxt").val()
										+ "</option>");
						$("#additemall").val('');
						$('#additemStatusScrollable').modal(
								'toggle');
					}
				});

		//-----------------------------------------------------------
    	$(document).on("click", ".create-new", function() {	
    		
    		$('.btnoffcanvas').click();
    	});
    	
    	//--------------------------------------------------------------------------------------------------------------------------------------		 		

		$(function() {
			var token = $("meta[name='_csrf']").attr("content");
			var header = $("meta[name='_csrf_header']").attr("content");
			$(document).ajaxSend(function(e, xhr, options) {
				xhr.setRequestHeader(header, token);
			});
		});
		//--------------------------------------------------------------------------------------------------------------------------------------		 
		

    	  var dt_basic_table = $('.datatables-basic');

    	  	// DataTable with buttons
    	  	// --------------------------------------------------------------------

    	  	// --------------------------------------------------------------------

			  if (dt_basic_table.length) {
			    var dt_basic = dt_basic_table.DataTable({
			    	 ajax: {
			             "url": "projectlistjson",
			             "type": "GET",
			             "dataSrc": "",
			         },
			      columns: [
			        { data: '' },
			        { data: 'id' },
			        { data: 'id' },
			        { data: 'title' },
			        { data: 'nextactivity' },
			        { data: '' },
			        { data: 'pipeline' },
			        { data: 'source' },
			        { data: 'purpose' },	
			        { data: 'branchname' },
			        { data: 'projectvalue' },			        
			        { data: 'expectedstartdateMMddYYY' },
			      
			      ],
			      columnDefs: [
			        {
			          // For Responsive
			          className: 'control',
			          orderable: false,
			          responsivePriority: 2,
			          searchable: false,
			          targets: 0,
			          render: function(data, type, full, meta) {
			            return '';
			          }
			        },
			        {
			          // For Checkboxes
			          targets: 1,
			          orderable: false,
			          responsivePriority: 3,
			          searchable: false,
			          checkboxes: true,
			          render: function() {
			            return '<input type="checkbox" class="dt-checkboxes form-check-input">';
			          },
			          checkboxes: {
			            selectAllRender: '<input type="checkbox" class="form-check-input">'
			          }
			        },
			        {
			          targets: 2,
			          searchable: false,
			          visible: false
			        },
			        {
				           targets:3,
				           render: function(data, type, full, meta) {
				           	 if(full['projectID'] ==null)
				           		 {
				           		full['projectID']="";
				           		 }
				           	 return '<a href="projectview?id='+ full['id'] +'">'+ full['title'] +'</a><br/><small class="emp_post text-truncate text-muted">'+ full['projectID'] +'</small>';
				           }
				     },
			         
			        
			          
			          
			        {
			          // Label
			          targets: -2,
			          render: function(data, type, full, meta) {
			            var $status_number = full['t_currentStatus'];
			            var $status = {
			              1: { title: 'Current', class: 'bg-label-primary' },
			              2: { title: 'Professional', class: ' bg-label-success' },
			              3: { title: 'Rejected', class: ' bg-label-danger' },
			              4: { title: 'Resigned', class: ' bg-label-warning' },
			              5: { title: 'Applied', class: ' bg-label-info' }
			            };
			            if (typeof $status[$status_number] === 'undefined') {
			              return data;
			            }
			            return (
			              '<span class="badge rounded-pill ' +
			              $status[$status_number].class +
			              '">' +
			              $status[$status_number].title +
			              '</span>'
			            );
			          }
			        },
			        {
				           targets:5,
				           render: function(data, type, full, meta) {
				           	 $projectFollowerslist = full['projectFollowers'];
				           	 
				           	 var $row_output='';
				          		$row_output += ' <ul class="list-unstyled m-0 d-flex align-items-center avatar-group ">';
				          		
				          		
				          		
				          		var $output ="";
				          		var $empMasterid="";
				          		var   $name ="";
				           	 $projectFollowerslist.forEach((element, index, array) =>
				           	 {
				           		
				           		 var $user_img = element.followerimg ,
				              	  $name = element.followername;
				              	  $empMasterid=element.empid;
				               
				              if ($user_img != "" && $user_img != null) {
				               // For Avatar image
				                 $output =
				                  '<img src="' + $user_img + '" alt="Avatar" class="rounded-circle">';
				              } else {
				                // For Avatar badge
				                var stateNum = Math.floor(Math.random() * 6);
				                var states = ['success', 'danger', 'warning', 'info', 'dark', 'primary', 'secondary'];
				                var $state = states[stateNum],
				                  $name = $name,
				                  $initials = $name.match(/\b\w/g) || [];
				                $initials = (($initials.shift() || '') + ($initials.pop() || '')).toUpperCase();
				                $output = '<span class="avatar-initial rounded-circle bg-label-' + $state + '">' + $initials + '</span>';
				              }
				              // Creates full output for row
				              
				              $row_output +=
					                '<li data-bs-toggle="tooltip"  data-popup="tooltip-custom"  data-bs-placement="top" title="' + $name + '"  class="avatar pull-up" >'+
					                '<div class="avatar me-2 tooltipx"><a href="emp?id='+ $empMasterid +'">'+ $output + '</a><span class="tooltiptextx">' + $name + '</span></div></li>';
				           	 });
				           	 
				           	 return $row_output;
				           }
				         },{
					           targets:9,
					           render: function(data, type, full, meta) {
					           	 
					           	 return 	  '<a href="editbranch?id='+ full['branch'] +'">'+ full["branchname"] +'</a>'; 
					           }
					     }
				         
				        
				         
			      ],
			      
			      dom:
			        '<"card-header"<"head-label text-center"><"dt-action-buttons text-end"B>><"d-flex justify-content-between align-items-center row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6"f>>t<"d-flex justify-content-between row"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',
			      displayLength: 10,
			      lengthMenu: [10, 25, 50, 75, 100],
			      buttons: [
			        {
			          extend: 'collection',
			          className: 'btn btn-label-primary dropdown-toggle me-2',
			          text: '<i class="bx bx-show me-2"></i>Export',
			          buttons: [
			            {
			              extend: 'print',
			              text: '<i class="bx bx-printer me-2" ></i>Print',
			              className: 'dropdown-item',
			              exportOptions: { columns: [3, 4, 5, 6, 7] }
			            },
			            {
			              extend: 'csv',
			              text: '<i class="bx bx-file me-2" ></i>Csv',
			              className: 'dropdown-item',
			              exportOptions: { columns: [3, 4, 5, 6, 7] }
			            },
			            {
			              extend: 'excel',
			              text: 'Excel',
			              className: 'dropdown-item',
			              exportOptions: { columns: [3, 4, 5, 6, 7] }
			            },
			            {
			              extend: 'pdf',
			              text: '<i class="bx bxs-file-pdf me-2"></i>Pdf',
			              className: 'dropdown-item',
			              exportOptions: { columns: [3, 4, 5, 6, 7] }
			            },
			            {
			              extend: 'copy',
			              text: '<i class="bx bx-copy me-2" ></i>Copy',
			              className: 'dropdown-item',
			              exportOptions: { columns: [3, 4, 5, 6, 7] }
			            }
			          ]
			        },
			        {
			          text: '<i class="bx bx-plus me-2"></i> <span class="d-none d-lg-inline-block" >Project </span>',
			          className: 'create-new btn btn-primary'
			        }
			      ],
			      responsive: {
			        details: {
			          display: $.fn.dataTable.Responsive.display.modal({
			            header: function(row) {
			              var data = row.data();
			              return 'Details of ' + data['staffName'];
			            }
			          }),
			          type: 'column',
			          renderer: function(api, rowIdx, columns) {
			            var data = $.map(columns, function(col, i) {
			              return col.title !== '' // ? Do not show row in modal popup if title is blank (for check box)
			                ? '<tr data-dt-row="' +
			                    col.rowIndex +
			                    '" data-dt-column="' +
			                    col.columnIndex +
			                    '">' +
			                    '<td>' +
			                    col.title +
			                    ':' +
			                    '</td> ' +
			                    '<td>' +
			                    col.data +
			                    '</td>' +
			                    '</tr>'
			                : '';
			            }).join('');
			
			            return data ? $('<table class="table"/><tbody />').append(data) : false;
			          }
			        }
			      }
			    });
			    $('div.head-label').html('<h5 class="card-title mb-0">Projects</h5>');
  		}
   // --------------------------------------------------------------------
   		function validationformreset()
	   {
   				$('.newprojectdataclose').click();
   				$('.newprojectdatasubmit').prop("disabled",false);
	   			$('.needs-validation').removeClass("was-validated");
	   			$('.needs-validation').trigger("reset");
	   			$('.newprojectdatasubmit').html("Submit");
	   }
   	// --------------------------------------------------------------------
        $('#form-add-new-record').on('submit', function(event){
        	/*const formData= new FormData(document.querySelector("#form-add-new-record"));
        	 for (var pair of formData.entries()) {
        	    console.log(pair); 
        	}  */
          $('.newprojectdatasubmit').prop("disabled",true);	
      	  if(event.target.checkValidity() && $("#startDate").val() != "")
      	 	{
      		$('.newprojectdatasubmit').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
        	   var ContactPersonTagify = $("#ContactPersonTagify").val();
        	   var Organization =$("#organization").val();
			   var Title= $("#Title").val();
			   var Source= $("#Source").val();
			   var startDate= $("#startDate").val();
			   var Reference= $("#Reference").val();
			   var Purpose= $("#Purpose").val();
			   var pipeline= $("#pipeline").val();
			   //var notes= $("#notes").val();
			   var followers= $("#followers").val();
			   var phonenumber= $("#phonenumber").val(); 
			   var branch=$("#branch").val(); 
			   var projectValue=$("#projectValue").val();
			  // var board=$("#board").val();
			   
			   var Status=$('#Status').val();
			   var label=$('#label').val();
			   var tdate=$('#tdate').val();
			   var Location=$('#Location').val();
			   var UNITS=$('#UNITS').val();
			   var Area=$('#Area').val();
			   var NatureofWork=$('#NatureofWork').val();
			   
			   var formData = {
					   ContactPerson: String(ContactPersonTagify),
					   Organization : String(Organization),
					   Title : Title,
					   Source : Source,
					   Reference:Reference,
					   Pipeline : pipeline,
					   followers : followers,
					   phonenumber : phonenumber,
					   branch:branch,
					   Purpose:Purpose,
					   projectValue: projectValue,
					   startDate: startDate,
					   Status:Status,
					   label:label,
					   tdate:tdate,
					   Location:Location,
					   UNITS:UNITS,
					   Area:Area,
					   NatureofWork:NatureofWork
				 }
			   
			   
        	$.ajax({
				type : "POST",url : "projectsavestage1",
				data : formData, success : function(result) {
					validationformreset();
					 Swal.fire({
				        title: 'Congratulations!',
				        text: 'Now Write A New Success Story',
				        imageUrl: assetsPath + 'img/bg_rvs/New Project Added.jpg',
				        imageWidth: 400,
				        imageAlt: 'Custom image',
				        confirmButtonText: 'Ok',
				        customClass: {
				          confirmButton: 'btn btn-primary'
				        },
				        buttonsStyling: false
				      });
					
					$('.datatables-basic').DataTable().ajax.reload();
					 
					
				},
				error : function(e) {
					console.log("Error" + e);
					
				}
				
			});
      	 }else
    	{
      		$('.newprojectdatasubmit').prop("disabled",false);
      		
			    		Swal.fire({
			        title: '',
			        text: 'Please enter the Start date ',
			        
			        confirmButtonText: 'Ok',
			        customClass: {
			          confirmButton: 'btn btn-primary'
			        },
			        buttonsStyling: false
			      });
    		 }
        	//------------------------------------------------------------------------
	    });
    //------------------------------------------------------------------------
    
			$("#ContactPersonTagify").change(function(){
				
				var selectval = $(this).val();
				
				if(selectval != "")
				{
				 $(".spinner-border").css("visibility","visible");
				 //---------------------------------------------------------------------------
				 var formData = {
						 selectval : selectval
				 }
				 $.ajax({
						type : "POST",url : "contactpersondetails",
						data : formData, success : function(result) {
						
							var bmobj = JSON.parse(JSON.stringify(result));
							
							//console.log(bmobj);
							if(bmobj.id !=0)
							{
								$("#phonenumber").val(bmobj.primarymob);
								$("#followers").val(bmobj.followers);
								$('#organization').val(bmobj.organizationname).change();	
							}
							  $(".spinner-border").css("visibility","hidden");
						},
						error : function(e) {
							console.log("Error" + e);
							$(".spinner-border").css("visibility","hidden");
						}
						
					});
				 //---------------------------------------------------------------------------
				}
			});
			
			$("#organization").change(function(){
				var st1= $(this).val().replace("[{\"value\":\"", "").replace("\"code\":\"", "").replace("\"}]", "").replace("\"", "").split(",");
				
				$('#Title').val(st1[0] + ' Project');
				
			});
			//------------------------------------------------------------
					
    	});
  //------------------------------------------------------------------------
 
    // Users List suggestion
    //------------------------------------------------------
   // Phone
		 const phoneMask = document.querySelector('.phone-number-otp-mask');

	    // Phone Number Input Mask
	    if (phoneMask) {
	      new Cleave(phoneMask, {
	        phone: true,
	        phoneRegionCode: 'US'
	      });
	    }
	    //------------------------------------------------------
	    // Date Format
		   const flatpickrFriendly = document.querySelector('#startDate');
			 // Human Friendly
			  if (flatpickrFriendly) {
			    flatpickrFriendly.flatpickr({
			      altInput: true,
			      altFormat: 'F j, Y',
			      dateFormat: 'Y-m-d'
			    });
			  }
			 
			  const flatpickrFriendlyx = document.querySelector('#tdate');
				 // Human Friendly
				  if (flatpickrFriendlyx) {
				    flatpickrFriendlyx.flatpickr({
				      altInput: true,
				      altFormat: 'F j, Y',
				      dateFormat: 'Y-m-d'
				    });
				  }
			//------------------------------------------------------ 
	    
    </script>
</body>
</html>