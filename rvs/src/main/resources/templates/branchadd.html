<!DOCTYPE html>

<html
  xmlns:th="http://www.thymeleaf.org" 
  lang="en"
  class="light-style layout-navbar-fixed layout-menu-fixed"
  dir="ltr"
  data-theme="theme-default"
  th:data-assets-path="@{/assets/}"
  data-template="vertical-menu-template"
  
>
  <head>
  	<meta name="_csrf" th:content="${_csrf.token}" />
	<!-- default header name is X-CSRF-TOKEN -->
	<meta name="_csrf_header" th:content="${_csrf.headerName}" />
  
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />

    <title>Branch View</title>

	  <meta name="description" content="" />
	  
	  

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" th:href="@{/assets/img/favicon/favicon.ico}" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Rubik:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
      rel="stylesheet"
    />

    <!-- Icons -->
    <link rel="stylesheet" th:href="@{/assets/vendor/fonts/boxicons.css}" />
    <link rel="stylesheet" th:href="@{/assets/vendor/fonts/fontawesome.css}" />
    <link rel="stylesheet" th:href="@{/assets/vendor/fonts/flag-icons.css}" />

    <!-- Core CSS -->
    <link rel="stylesheet" th:href="@{/assets/vendor/css/rtl/core.css}" class="template-customizer-core-css" />
    <link rel="stylesheet" th:href="@{/assets/vendor/css/rtl/theme-default.css}" class="template-customizer-theme-css" />
    <link rel="stylesheet" th:href="@{/assets/css/demo.css}" />

    <!-- Vendors CSS -->
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css}" />
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/typeahead-js/typeahead.css}" />
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/datatables-bs5/datatables.bootstrap5.css}" />
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.css}" />
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.css}" />
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/animate-css/animate.css}" />
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/sweetalert2/sweetalert2.css}" />
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/flatpickr/flatpickr.css}" />
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.css}" />
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.css}" />
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/jquery-timepicker/jquery-timepicker.css}" />
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/select2/select2.css}" />
    <link rel="stylesheet" th:href="@{/assets/vendor/libs/formvalidation/dist/css/formValidation.min.css}" />

    <!-- Page CSS -->

    <link rel="stylesheet" th:href="@{/assets/vendor/css/pages/page-user-view.css}" />
    <!-- Helpers -->
    <script th:src="@{/assets/vendor/js/helpers.js}"></script>

    <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
    <!--? Template customizer: To hide customizer set displayCustomizer value false in config.js.  -->
    <script th:src="@{/assets/vendor/js/template-customizer.js}"></script>
    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
    <script th:src="@{/assets/js/config.js}"></script>

<style type="text/css">

.contacteditbtn
{
cursor:pointer;
}

</style>
<script>

var Accountsheadsexpenseitems = [];

</script>
  </head>

  <body>
    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar">
      <div class="layout-container">
        <!-- Menu -->
		<div th:insert="menu"></div>
        <!-- / Menu -->

        <!-- Layout container -->
        <div class="layout-page">
          <!-- Navbar -->
			<div th:insert="header"></div>
          <!-- / Navbar -->

          <!-- Content wrapper -->
          <div class="content-wrapper">
            <!-- Content -->

            <div class="container-xxl flex-grow-1 container-p-y">
              <h4 class="py-3 breadcrumb-wrapper mb-4">
                <span class="text-muted fw-light">Administration/<a href="branchlist">Branches</a>/</span> View
              </h4>
              <th:block th:each="obj : ${expenselist}">
					<script type="text/javascript" th:inline="javascript">
					Accountsheadsexpenseitems.push("[(${obj})]");
					</script>
				</th:block>
								
              <div class="row gy-4">
                <!-- User Sidebar -->
                <div class="col-xl-4 col-lg-5 col-md-5 order-1 order-md-0">
                  <!-- User Card -->
                  <div class="card mb-4">
                    <div class="card-body">
                      <div class="user-avatar-section">
                        <div class="d-flex align-items-center flex-column">
                          <img
                            class="img-fluid rounded my-4"
                            th:src="@{/assets/img/logo/rvslogo1.png}" 
                            height="110"
                            width="110"
                            alt="User avatar"
                          />
                          <div class="user-info text-center">
                            <h5 class="mb-2" th:text="${BranchMaster.BRANCH_NAME}"></h5>
                            <span class="badge bg-label-secondary"  th:text="${BranchMaster.BranchCode} +'-'+ ${BranchMaster.id}"></span>
                          </div>
                        </div>
                      </div>
                      <div class="d-flex justify-content-around flex-wrap my-4 py-3">
                        <div class="d-flex align-items-start me-4 mt-3 gap-3">
                          <span class="badge bg-label-primary p-2 rounded"><i class="bx bx-user bx-sm"></i></span>
                          <div>
                            <h5 class="mb-0">0</h5>
                            <span>Active Staff</span>
                          </div>
                        </div>
                        <div class="d-flex align-items-start mt-3 gap-3">
                          <span class="badge bg-label-primary p-2 rounded"><i class="bx bx-detail bx-sm"></i></span>
                          <div>
                            <h5 class="mb-0">0</h5>
                            <span>Projects Done</span>
                          </div>
                        </div>
                      </div>
                      <h5 class="pb-2 border-bottom mb-4">Details</h5>
                      <div class="info-container">
                        <ul class="list-unstyled">
                          <li class="mb-3">
                            <span class="fw-bold me-2">Type:</span>
                            <span th:text="${BranchMaster.B_TYPE}" id="Lbl_B_TYPE"></span>
                          </li>
                          <li class="mb-3">
                            <span class="fw-bold me-2">Branch Name:</span>
                            <span  th:text="${BranchMaster.BRANCH_NAME}" id="Lbl_BRANCH_NAME"></span>
                          </li>
                          <li class="mb-3">
                            <span class="fw-bold me-2">Branch Code:</span>
                            <span  th:text="${BranchMaster.BranchCode}" id="Lbl_BranchCode"></span>
                          </li>
                          
                          <li class="mb-3">
                            <span class="fw-bold me-2">In-Charge Name:</span>
                            <span th:text="${BranchMaster.BRANCH_IN_CHARGE_name}"  id="Lbl_BRANCH_IN_CHARGE"></span>
                          </li>
                          <li class="mb-3">
                            <span class="fw-bold me-2">Started On :</span>
                            <span th:text="${BranchMaster.startdateMMformat}" id="Lbl_STATED_DATE"></span>
                          </li>
                          <li class="mb-3">
                            <span class="fw-bold me-2">Hierarchy:</span>
                            <span th:text="${BranchMaster.COMES_UNDER_name}"  id="Lbl_COMES_UNDER"></span>
                          </li>
                          <li class="mb-3">
                            <span class="fw-bold me-2">Status:</span>
                            <span  id="Lbl_CURRENT_STATUS">
	                            <span  th:if="${BranchMaster.CURRENT_STATUS} =='Active'" class="badge bg-label-success">Active</span>
	                            <span  th:unless="${BranchMaster.CURRENT_STATUS} =='Active'" class="badge bg-label-danger">In Active</span>
                            </span>
                          </li>
                          <li class="mb-3">
                            <span class="fw-bold me-2">Effect On :</span>
                            <span th:text="${BranchMaster.effectiveonMMformat}" id="Lbl_effectiveon"></span>
                          </li>
                        
                        </ul>
                        <div class="d-flex justify-content-center pt-3">
                          <a
                            href="javascript:;"
                            class="btn btn-primary me-3"
                            data-bs-target="#editBranchdetails"
                            data-bs-toggle="modal"
                            id="editBranchdetailsbtn"
                            >Edit</a
                          >
                          
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- /User Card -->
                  
                   <!-- Address Card -->
                  
                  <div class="card mb-4">
                    <div class="card-body">
                      <h5 class="pb-2 border-bottom mb-4">Address</h5>
                      <div class="info-container">
                        <ul class="list-unstyled">
                          <li class="mb-3">
                            <span class="fw-bold me-2">Country:</span>
                            <span th:text="${BranchMaster.COUNTRY}" id="Lbl_AddressCountry"></span>
                          </li>
                          <li class="mb-3">
                            <span class="fw-bold me-2">Address Line 1:</span>
                            <span  th:text="${BranchMaster.BRANCH_ADDRESSLINE1}"  id="Lbl_AddressAddress1"></span>
                          </li>
                          <li class="mb-3">
                            <span class="fw-bold me-2">Address Line 2:</span>
                            <span  th:text="${BranchMaster.BRANCH_ADDRESSLINE2}"  id="Lbl_AddressAddress2"></span>
                          </li>
                          <li class="mb-3">
                            <span class="fw-bold me-2">Landmark:</span>
                            <span th:text="${BranchMaster.BRANCH_ADDRESSLandMark}"  id="Lbl_AddressLandmark"></span>
                          </li>
                          <li class="mb-3">
                            <span class="fw-bold me-2">Village:</span>
                            <span th:text="${BranchMaster.BRANCH_ADDRESSVillage}" id="Lbl_AddressVillage"></span>
                          </li>
                          <li class="mb-3">
                            <span class="fw-bold me-2">City/Town:</span>
                            <span th:text="${BranchMaster.CITY}"  id="Lbl_AddressCity"></span>
                          </li>
                          <li class="mb-3">
                            <span class="fw-bold me-2">State:</span>
                            <span th:text="${BranchMaster.STATE}" id="Lbl_AddressState"></span>
                          </li>
                        <li class="mb-3">
                            <span class="fw-bold me-2">Pin code:</span>
                            <span th:text="${BranchMaster.ZIP_CODE}" id="Lbl_AddressZipCode"></span>
                          </li>
                        </ul>
                        <div class="d-flex justify-content-center pt-3">
                          <a
                            href="javascript:;"
                            class="btn btn-primary me-3"
                            data-bs-target="#addNewAddress"
                            data-bs-toggle="modal"
                            >Edit</a
                          >
                          
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- /Address Card -->
                  <!-- Contact Card -->
                  <div class="card  mb-4">
                    <div class="card-body1">
                      <div class="card-header align-items-center">
                      <h5 class="card-action-title mb-0">Contacts
                      <div class="card-action-element" style="float:right">
                        <button
                          class="btn btn-primary btn-sm addcontactbtn"
                          type="button"
                          name="-"
                          data-bs-toggle="modal"
                          data-bs-target="#addNewContact"
                        >
                          <i class="bx bx-plus bx-xs me-1"></i>
                        </button>
                      	</div>
                        </h5>
                      
                    </div>
                    <div class="card-body">
                      <div class="added-cards">
                      	<th:block th:each="contactObj : ${BranchMaster.branchContact}">
                        <div th:class="'cardMaster border p-3 rounded mb-3 card'+ ${contactObj.branchcontactid}">
                          <div class="d-flex justify-content-between flex-sm-row flex-column">
                            <div class="card-information">
                              <input type="hidden" th:class="' primarycontact'+ ${contactObj.branchcontactid}" th:value="${contactObj.primarycontact}"/>
                              <h6 th:class="'mb-3 contacteditbtn contacttype'+ ${contactObj.branchcontactid} " alt="edit" th:name="${contactObj.branchcontactid}"  th:text="${contactObj.Department}"></h6>
                              <h6 th:class="'mb-1 phonenumber'+ ${contactObj.branchcontactid}" th:text="${contactObj.Phonenumber}"></h6>
                              <span th:class="'card-number email'+ ${contactObj.branchcontactid}" th:text="${contactObj.Email}"></span
                              >
                             <span th:class="'primarycontactlablecontainer'+ ${contactObj.branchcontactid}"> <span th:if="${contactObj.primarycontact}" class="badge bg-label-primary">Primary</span></span>
                            </div>
                            <div class="d-flex flex-column text-start text-lg-end">
                              <div class="d-flex order-sm-0 order-1 mt-3">
                                
                                <button class="btn btn-label-secondary contactdeletebtn" th:name="${contactObj.branchcontactid}"><i class='bx bxs-trash-alt'></i></button>
                                
                              </div>
                              
                            </div>
                          </div>
                        </div>
                       	</th:block>
                       	<span id="contactaddidv"></span>
                       </div>
                    </div>
                    </div>
                  </div>
                  <!-- /Contact Card -->
                  <!-- Document   Card -->
                   <div class="card  mb-4">
                    <div class="card-body1">
                      <div class="card-header align-items-center">
                      <h5 class="card-action-title mb-0">Documents  
                      <div class="card-action-element" style="float:right">
                        <button
                          class="btn btn-primary btn-sm"
                          type="button"
                          data-bs-toggle="modal"
                          data-bs-target="#addNewDocument"
                        >
                          <i class="bx bx-plus bx-xs me-1"></i> 
                        </button>
                      	</div>
                        </h5>
                      
                    </div>
                    <div class="card-body">
                      <div class="added-cards">
                        <th:block th:each="fileObj : ${BranchMaster.branchFiles}">
	                        <div th:class="'cardMaster border p-3 rounded mb-3 filecard' + ${fileObj.branchfilesid}">
	                          <div class="d-flex justify-content-between flex-sm-row flex-column">
	                            <div class="card-information">
	                              
	                              <h6 class="mb-1" th:text="${fileObj.DocumentType}"></h6>
	                              <span class="card-number" th:text="${fileObj.DocumentNo}"></span>
                              	
                              	<th:block th:if="${fileObj.FilePath != ''}">
                              	<br/>
                                	<a th:href="${fileObj.FilePath}" target="_blank">
                                		<th:block th:if="${#strings.arraySplit(fileObj.FilePath,'.')[1]} == 'pdf'">
                                			<img th:src="@{/assets/img/icons/misc/pdf.png}" alt="PDF image" width="20" class="me-2">
                                		</th:block>
                                		<th:block th:unless="${#strings.arraySplit(fileObj.FilePath,'.')[1]} == 'pdf'">
                                			<img th:src="@{/assets/img/icons/misc/jpg.png}" alt="PDF image" width="20" class="me-2">
                                		</th:block>
                                		<small class="text-body" th:text="${#strings.substring(#strings.arraySplit(fileObj.FilePath,'/')[1],15)}">
                                		</small>
                                	</a>
                                </th:block>
	                                
	                            </div>
	                            <div class="d-flex flex-column text-start text-lg-end">
	                              <div class="d-flex order-sm-0 order-1 mt-3">
	                                
	                                <button class="btn btn-label-secondary filedeletebtn" th:name="${fileObj.branchfilesid}"><i class='bx bxs-trash-alt'></i></button>
	                              </div>
	                              
	                            </div>
	                          </div>
	                        </div>
                       
                       	</th:block>
                       	<span id="fileaddidv"></span>
                       </div>
                    </div>
                    </div>
                  </div>
               
                  <!-- /Document   Card -->
                 <!-- Bank Account Card -->
                  <div class="card mb-4">
                    <div class="card-body">
                      <h5 class="pb-2 border-bottom mb-4">Bank Details
                       
                        <div class="card-action-element" style="float:right">
                        <button
                          class="btn btn-primary btn-sm collapsetogglebtn"
                          type="button"
                          data-bs-toggle="collapse"
                          href="#bankdetailscollapseExample"
                          aria-expanded="false"
                          aria-controls="bankdetailscollapseExample"
                        >
                          <i id="collapsetoggleicon" class="bx bx-chevron-down bx-xs me-1"></i>
                        </button>
                      	</div>
                      </h5>
                      
                      <div class="info-container collapse" id="bankdetailscollapseExample">
                      
                      
                         <ul class="list-unstyled" th:with ="accobj = ${BranchMaster.branchAccNo[0]}">
	                          <li class="mb-3">
	                            <span class="fw-bold me-2">A.C.No:</span>
	                            <span th:text="${accobj.acno}" id="Lbl_acno"></span>
	                          </li>
	                          <li class="mb-3">
	                            <span class="fw-bold me-2">Account Name:</span>
	                            <span  th:text="${accobj.acname}"  id="Lbl_acname"></span>
	                          </li>
	                          <li class="mb-3">
	                            <span class="fw-bold me-2">Bank Name:</span>
	                            <span  th:text="${accobj.bankname}"  id="Lbl_bankname"></span>
	                          </li>
	                          <li class="mb-3">
	                            <span class="fw-bold me-2">Branch Name:</span>
	                            <span th:text="${accobj.branchname}"  id="Lbl_branchname"></span>
	                          </li>
	                          <li class="mb-3">
	                            <span class="fw-bold me-2">IFSC Code:</span>
	                            <span th:text="${accobj.ifsccode}" id="Lbl_ifsccode"></span>
	                          </li>
	                        </ul>
                        
                        <div class="d-flex justify-content-center pt-3">
                          <a
                            href="javascript:;"
                            class="btn btn-primary me-3"
                            data-bs-target="#addNewBankDetails"
                            data-bs-toggle="modal"
                            >Edit</a
                          >
                          
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- /Bank Account Card -->
                
                </div>
                <!--/ User Sidebar -->

               <!-- User Content -->
				<div class="col-xl-8 col-lg-7 col-md-7 order-0 order-md-1">
					<!-- User Pills -->
					<ul class="nav nav-pills flex-column flex-md-row mb-3">
								
						<li class="nav-item"><a class="nav-link active">
							<i
								class="menu-icon tf-icons bx bx-food-menu me-1"></i>Purchase</a></li>
						<li class="nav-item"><a class="nav-link" th:href="'branchexpense?id='+${BranchMaster.id}"><i
								class="menu-icon tf-icons bx bx-food-menu me-1"></i>Expense</a></li>
					</ul>
					<!--/ User Pills -->

					<!-- Project   Card -->
					<div class="card  mb-4">
						<div class="card-body1">
							<div class="card-header align-items-center">
								<h5 class="card-action-title mb-0">
									Purchase List
									<div class="card-action-element" style="float: right">
										<button class="btn btn-primary btn-sm addNewPurchasebtn"
											type="button" data-bs-toggle="modal"
											data-bs-target="#Purchasemodel">
											<i class="bx bx-plus bx-xs me-1"></i>
										</button>
									</div>
								</h5>
							</div>
							<div class="table-responsive">
								<table class="table border-top m-0">
									<thead>
										<tr>
											<th>Purchase #</th>
											<th>Type</th>
											<th>Date</th>
											<th>Due Date</th>
											<th>Amount</th>
										</tr>
									</thead>
									<tbody id="branchPurchaselist">

									</tbody>
								</table>
							</div>
						</div>
					</div>
					<!-- /Project   Card -->

					<!-- Receipts   Card -->
					<div class="card  mb-4">
						<div class="card-body1">
							<div class="card-header align-items-center">
								<h5 class="card-action-title mb-0">
									Payment Receipts List
									
								</h5>
							</div>
							<div class="table-responsive">
								<table class="table border-top m-0">
									<thead>
										<tr>
											<th>Ref #</th>
											<th>Purchase #</th>
											<th>Date</th>
											<th>Account</th>
											
											<th>Amount Paid</th>
										</tr>
									</thead>
									<tbody id="receiptslist">

									</tbody>
								</table>
							</div>
						</div>
					</div>
					<!-- /Receipts   Card -->
				</div>
				<!-- User Content -->
              </div>

              <!-- Modal -->
              <!-- Add Purchase -->
				<div class="modal fade" id="Purchasemodel" tabindex="-1"
					aria-hidden="true">
	
					
						<div
							class="modal-dialog modal-xl modal-simple modal-add-new-cc">
							<div class="modal-content p-3 p-md-5">
								<div class="modal-bodyx">
									<button type="button" class="btn-close"
										data-bs-dismiss="modal" aria-label="Close"></button>
									<form  class="row g-3 needs-validation"  id="editPurchaseformx"
							onsubmit="return false">
									<!-- -------- -->
									<!-- Purchase Add-->
									<div class="col-lg-12 col-12 mb-lg-0 mb-4">
										<div class="card invoice-preview-card">
											<div class="card-body">
												<div class="row p-sm-3 p-0">
													<div class="col-md-6 mb-md-0 mb-4">
														<dl class="row mb-2">
															
															<dt class="col-sm-6 mb-2 mb-sm-0 text-md-end">
																<span class="fw-normal">Supplier:</span>
															</dt>
															<dd class="col-sm-6 d-flex justify-content-md-end">
																<div class="w-px-150">
																	<select class="form-select followers form-control "
																		id="purchase_supplierid" name="purchase_supplierid" >
																		<option value="">-</option>
																		<th:block th:each="str :${supplierlist}">
																			<option th:value="${str.id}" th:text="${str.orgname}"></option>
																		</th:block>
																	</select>
																</div>
															</dd>
															<dt class="col-sm-6 mb-2 mb-sm-0 text-md-end">
																<span class="text-capitalize mb-0 text-nowrap">
																	Supplier Ref#</span>
															</dt>
															<dd class="col-sm-6 d-flex justify-content-md-end">
																<div class="w-px-150">
																	<input type="text" class="form-control"
																		id="branchpurchaseNo" name="branchpurchaseNo" required /> <input
																		type="hidden" class="form-control" id="branchpurchaseid"
																		name="branchpurchaseid" />
																</div>
															</dd>
															
															<dt class="col-sm-6 mb-2 mb-sm-0 text-md-end">
																<span class="fw-normal">Submitted by:</span>
															</dt>
															<dd class="col-sm-6 d-flex justify-content-md-end">
																<div class="w-px-150">
																	<select
																		class="form-select  form-control "
																		id="purchase_employeeid" name="purchase_employeeid" 
																		required>
																		<option value="">-</option>
																		<th:block th:each="str :${EffectiveEmployee}">
																			<option th:value="${str.empMasterid}"
																				th:text="${str.StaffName}"></option>
																		</th:block>
																	</select>
																</div>
															</dd>
															
															
														</dl>
													</div>
													<div class="col-md-6">
														<dl class="row mb-2">
															<dt class="col-sm-6 mb-2 mb-sm-0 text-md-end">
																<span class="fw-normal">Bill Type:</span>
															</dt>
															<dd class="col-sm-6 d-flex justify-content-md-end">
																<div class="w-px-150">
																	<select id="branchpurchaseType" name="branchpurchaseType"
																		class="form-select"
																		aria-label="Default select example" required>
																		<option value="">-</option>
																		<option value="Tax Invoice">Tax Invoice</option>
																		<option value="Proforma Invoice">Proforma
																			Invoice</option>
																		<option value="Bill">Bill</option>
																	</select>
																</div>
															</dd>
															<dt class="col-sm-6 mb-2 mb-sm-0 text-md-end">
																<span class=" text-capitalize mb-0 text-nowrap">
																	Date:</span>
															</dt>
															<dd class="col-sm-6 d-flex justify-content-md-end">
																<div class="w-px-150">
																	<input type="date" class="form-control"
																		id="branchpurchaseDate" name="branchpurchaseDate" required />
																</div>
															</dd>
															
															<dt class="col-sm-6 mb-2 mb-sm-0 text-md-end">
																<span class="fw-normal">Due Date:</span>
															</dt>
															<dd class="col-sm-6 d-flex justify-content-md-end">
																<div class="w-px-150">
																	<input type="date" class="form-control date-picker"
																		id="dueDate" name="dueDate" required/>
																</div>
															</dd>
															
														</dl>
													</div>
												</div>
	
												<hr />
	
											
												<div class="mb-3" data-repeater-list="group-a">
													<div class="repeater-wrapper pt-0 pt-md-4"
														id="purchaseitemlist">
												 </div>
												</div>
												<div class="row">
													<div class="col-12">
														<button type="button" class="btn btn-primary" id="addnewpurchaseitem"
															>Add Item</button>
													</div>
												</div>
	
	
												<hr class="my-4 mx-n4" />
	
												<div class="row py-sm-3">
													<div class="col-6">
														<div class="mb-3">
															<label for="note" class="form-label fw-semibold">Note:</label>
															<textarea class="form-control" rows="2" id="note" name="note"
																placeholder="Purchase note"></textarea>
														</div>
													</div>
													<div class="col-md-6 d-flex justify-content-end">
														<div class="invoice-calculations">
															<div class="d-flex justify-content-between mb-2">
																<span class="w-px-100">Total:</span> <span
																	class="fw-semibold" id="totalamtwithouttax">0.00</span>
															</div>
															<div class="d-flex justify-content-between mb-2 totaldiscountamountdiv">
																<span class="w-px-100">Discount:</span> <span
																	class="fw-semibold"  id=totaldiscountamount>0.00</span>
															</div>
															<div class="d-flex justify-content-between mb-2 totalCGSTdiv">
																<span class="w-px-100">CGST:</span> <span
																	class="fw-semibold"  id="totalCGST">0.00</span>
															</div>
															<div class="d-flex justify-content-between mb-2 totalSGSTdiv">
																<span class="w-px-100">SGST:</span> <span
																	class="fw-semibold" id="totalSGST">0.00</span>
															</div>
															<div class="d-flex justify-content-between mb-2 totalIGSTdiv">
																<span class="w-px-100">IGST:</span> <span
																	class="fw-semibold" id="totalIGST">0.00</span>
															</div>
															<hr />
															<div class="d-flex justify-content-between">
																<span class="w-px-100">Total Amount:</span> <span
																	class="fw-semibold" id="totalamount">0.00</span>
															</div>
	
														</div>
													</div>
												</div>
												<div align="center">
													<button type="submit"
														class="btn btn-primary editPurchasesubmit me-sm-3 me-1">Save
														The Purchase</button>
	
													<button type="reset"
														class="btn btn-label-secondary editPurchaseclose"
														data-bs-dismiss="modal" aria-label="Close">
														Cancel</button>
	
												</div>
											</div>
										</div>
									</div>
									<!-- /Invoice Add-->
									<!-- -------- -->
								</form>
								</div>
							</div>
						</div>
					
				</div>
				<!--/ Add Invoice -->
				<!-- Edit Receipt Modal -->
				<div class="modal fade" id="receiptmodel" tabindex="-1"
					aria-hidden="true">
					<div class="modal-dialog modal-lg modal-simple modal-edit-user">
						<div class="modal-content p-3 p-md-5">
							<div class="modal-body">
								<button type="button" class="btn-close"
									data-bs-dismiss="modal" aria-label="Close"></button>
								<div class="text-center mb-4">
									<h5>Payment Receipt</h5>
								</div>
								<form  class="row g-3 needs-validation"  id="editreceiptformx"
							onsubmit="return false">
									<div class="row p-sm-3 p-0">
												<div class="col-md-6 mb-md-0 mb-4">
													
													<p class="mb-1"><b>Invoice No# :</b>     <span id="branchpurchaseNotxt"></span>
													<input type="hidden" id="recepitid" name="recepitid" />
													<input type="hidden" id="recbranchpurchaseid" name="recbranchpurchaseid" required/>
													</p>
													<p class="mb-1"><b>Due Date :</b>     <span id="duedatetxt"></span></p>
													<p class="mb-0"></p>
												</div>
												<div class="col-md-6">
													<p class="mb-1"><b>Amount :</b>     <span id="purpaymentamounttxt"></span></p>
													<p class="mb-1"><b>Total paid :</b>     <span id="purpaymenttotalpaidNotxt"></span></p>
													<p class="mb-0"><b>Balance Due :</b>     <span id="purpaymentBalancetxt"></span></p>
												</div>
												
											</div>
								
								
									<div class="col-12 col-md-6">
										<label class="form-label" for="recepitNo">Ref #</label> <input type="text" id="recepitNo"
											name="recepitNo" class="form-control" required/>
									</div>
								
									<div class="col-12 col-md-6">
										<label class="form-label" for="recepitDate">Date</label> <input type="date" id="recepitDate"
											name="recepitDate" class="form-control" required/>
									</div>
									
									<div class="col-12 col-md-6">
										<label class="form-label" for="depitedfrom">Paid From</label>
										<select id="depitedfrom" name="depitedfrom"
											class="form-select" aria-label="Default select example" required>
											<option value="">-</option>
											<th:block  th:each="obj1 : ${accountlist}" >
												<option th:value="${obj1.accountheadid}" th:text="${obj1.category}"></option>
											</th:block>
											
										</select>
									</div>
									<div class="col-12 col-md-6">
										<label class="form-label" for="modeofPayment">Mode of Payment</label>
										<select id="modeofPayment" name="modeofPayment"
											class="form-select" aria-label="Default select example" required>
											<option value="">-</option>
											<option value="NEFT">NEFT</option>
											<option value="RTGS">RTGS</option>
											<option value="Cash">Cash</option>
											<option value="Paypal">Paypal</option>
											<option value="Paytm">Paytm</option>
											<option value="Gpay">Gpay</option>
											<option value="Other UPI">Other UPI</option>
										</select>
									</div>
									<div class="col-12 col-md-6">
										<label class="form-label" for="amount">Amount
											</label> <input type="text" id="amount"
											name="amount"
											class="form-control modal-edit-tax-id" required
											 />
									</div>
									<div class="col-12 col-md-6">
									<br/>
										<label class="switch"> <input type="checkbox"
											class="switch-input"  id="payfull"/> <span
											class="switch-toggle-slider"> <span
												class="switch-on"></span> <span class="switch-off"></span>
										</span> <span class="switch-label">Pay in Full</span>
										</label>
									</div>
									<div class="col-12">
										<label class="form-label" for="notes">Notes
											</label> <input type="text" id="notes" 
											name="notes"
											class="form-control modal-edit-tax-id"
											/>
									</div>
									
									<div class="col-12 text-center mt-4">
										<button type="submit"
														class="btn btn-primary editReceiptsubmit me-sm-3 me-1">Save
														The Receipt</button>
	
										<button type="reset"
											class="btn btn-label-secondary editReceiptclose"
											data-bs-dismiss="modal" aria-label="Close">
											Cancel</button>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
				
				<!-- /Edit Receipt Modal -->
							
							
              <!-- Edit User Modal -->
              <div class="modal fade" id="editBranchdetails" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-simple modal-edit-user">
                  <div class="modal-content p-3 p-md-5">
                  
                    <div class="modal-body">
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      <div class="text-center mb-4">
                        <h3>Edit Branch Information</h3>
                        <p>Update Branch Basic Information</p>
                      </div>
                      <form id="editBranchdetailsForm" th:object="${BranchMaster}" class="row g-3 needs-validation" onsubmit="return false">
						<input type="hidden" th:value="${BranchMaster['id']}" id="BranchID" th:field="*{id}"/>
	                    
	                    	<div class="col-12 col-md-3">
	                          <div class="form-check custom-option custom-option-icon"
	                          data-bs-toggle="tooltip"
	                          data-bs-offset="0,4"
	                          data-bs-placement="bottom"
	                          data-bs-html="true"
	                          title="<span>Controls B.O & S.O & T.O.</span>"
	                        
	                          >
	                            <label class="form-check-label custom-option-content" for="radioHead-Office">
	                              <span class="custom-option-body">
	                                <i class="bx bx-building"></i>
	                                <span class="custom-option-title">Head Office</span>
	                                <!-- <small> Controls B.O & S.O & T.O.</small> -->
	                              </span>
	                              <input
	                                name="Model_B_TYPE"
	                                
	                                type="radio"
	                                value="Head-Office"
	                                id="radioHead-Office"
	                                required
	                              />
	                            </label>
	                          </div>
	                        </div>
	                        <div class="col-12 col-md-3">
	                          <div class="form-check custom-option custom-option-icon"
	                          data-bs-toggle="tooltip"
	                          data-bs-offset="0,4"
	                          data-bs-placement="bottom"
	                          data-bs-html="true"
	                          title="<span>Subordinate to the Head Office</span>"
	                          >
	                            <label class="form-check-label custom-option-content" for="radioBranch">
	                              <span class="custom-option-body">
	                                <i class="bx bx-buildings"></i>
	                                <span class="custom-option-title">Branch Office</span>
	                                <!-- <small> Subordinate to the Head Office. </small> -->
	                              </span>
	                              <input
	                                name="Model_B_TYPE"
	                                
	                                type="radio"
	                                value="Branch-Office"
	                                id="radioBranch-Office"
	                                required
	                              />
	                            </label>
	                          </div>
	                        </div>
	                        <div class="col-12 col-md-3">
	                          <div class="form-check custom-option custom-option-icon"
	                          data-bs-toggle="tooltip"
	                          data-bs-offset="0,4"
	                          data-bs-placement="bottom"
	                          data-bs-html="true"
	                          title="<span>Comes under HO or BO and reports to the latter office.</span>"
	                          >
	                            <label class="form-check-label custom-option-content" for="radioSub-Branch">
	                              <span class="custom-option-body">
	                                <i class="bx bx-building-house"></i>
	                                <span class="custom-option-title">Sub Office</span>
	                                <!-- <small>Small Unit Reports to H.O/B.O.</small> -->
	                              </span>
	                              <input
	                                name="Model_B_TYPE"
	                                type="radio"
	                                value="Sub-Office"
	                                id="radioSub-Office"
	                                required
	                              />
	                            </label>
	                          </div>
	                        </div>
	                        <div class="col-12 col-md-3">
	                          <div class="form-check custom-option custom-option-icon"
	                          data-bs-toggle="tooltip"
	                          data-bs-offset="0,4"
	                          data-bs-placement="bottom"
	                          data-bs-html="true"
	                          title="<span>A Temporary office serves only to concern projects.</span>"
	                          >
	                            <label class="form-check-label custom-option-content" for="radioField-Branch">
	                              <span class="custom-option-body">
	                                <i class="bx bx-hard-hat"></i>
	                                <span class="custom-option-title">Field Office</span>
	                                <!-- <small>A Temporary office for  projects.</small> -->
	                              </span>
	                              <input
	                                name="Model_B_TYPE"
	                                
	                                type="radio"
	                                value="Field-Office"
	                                id="radioField-Office"
	                                required
	                              />
	                              
	                            </label>
	                          </div>
	                        </div>
	                    	
	                    
	                    
                        <div class="col-12 col-md-6">
                                
	                              
                          <label class="form-label" for="modaleditBranchdetailsFirstName">Branch Name</label>
                          <input
                            type="text"
                            class="form-control"
                            id="Model_BRANCH_NAME"
                            th:value="${BranchMaster['BRANCH_NAME']}"
                            required
                          />
                          <div class="invalid-feedback">Please enter Branch Name.</div>
                        </div>
                        <div class="col-12 col-md-6">
                                
	                              
                          <label class="form-label" for="modaleditBranchdetailsFirstName">Branch Code</label>
                          <input
                            type="text"
                            class="form-control"
                            id="Model_BranchCode"
                            th:value="${BranchMaster['BranchCode']}"
                            required
                          />
                          <div class="invalid-feedback">Please enter Branch Code.</div>
                        </div>
                        <div class="col-12 col-md-6">
                          <label class="form-label" for="Model_BRANCH_IN_CHARGE">In-Charge Name</label>
                          <select
                            class="form-select"
                            aria-label="Default select example" 
                            id="Model_BRANCH_IN_CHARGE"
                            th:field="*{BRANCH_IN_CHARGE}" 
                            th:value="${BranchMaster['BRANCH_IN_CHARGE']}"
                            required
                          >
                             <option value="">Select In-Charge</option>
                             <option th:each="emp :${EffectiveEmployee}" th:value="${emp.empMasterid}"  th:text="${emp.StaffName}"></option>
                          
                          </select>
                          <div class="invalid-feedback">Please Select In-Charge</div>
                        </div>
                        <div class="col-12 col-md-6">
                          <label class="form-label" for="Model_STATED_DATE">Started On</label>
                          <input
                            type="date"
                            class="form-control flatpickr-validation"
                            id="Model_STATED_DATE"
                            th:value="${BranchMaster['STATED_DATE']}"
                            required
                          />
                          <div class="invalid-feedback">Please enter Started On.</div>
                        </div>
                        <div class="col-12 col-md-6">
                          <label class="form-label" for="Model_COMES_UNDER">Hierarchy </label>
                          <select class="form-select" id="Model_COMES_UNDER" 
                          th:field="*{COMES_UNDER}"
                          th:value="${BranchMaster['COMES_UNDER']}"
                          required>
                           <option value="">Select Hierarchy</option>
                           <option value="Self">Self</option>
                           <option th:each="branch :${BranchList}" th:value="${branch.id}"  th:text="${branch.BRANCH_NAME}"></option> 
                           
                         </select>
                         <div class="invalid-feedback">Please enter Hierarchy.</div>
                        </div>
                        <div class="col-12 col-md-6">
                          <label class="form-label" for="Model_CURRENT_STATUS">Status</label>
                          <select
                            id="Model_CURRENT_STATUS"
                            class="form-select"
                            aria-label="Default select example"
                            th:field="*{CURRENT_STATUS}"
                            th:value="${BranchMaster['CURRENT_STATUS']}"
                            required
                          >
                            <option value="">Status</option>
                            <option value="Active">Active</option>
                            <option value="Inactive">Inactive</option>
                            
                          </select>
                          <div class="invalid-feedback">Please enter Status.</div>
                        </div>
                        <div class="col-12 col-md-6">
                          <label class="form-label" for="Model_effectiveon">Effect On</label>
                          <input
                            type="date"
                            class="form-control flatpickr-validation"
                            id="Model_effectiveon"
                            th:value="${BranchMaster['effectiveon']}"
                            required
                          />
                          
                         <div class="invalid-feedback">Please enter Effect on.</div>
                        </div>
                      
                        <div class="col-12 text-center mt-4">
                          <button type="submit" class="btn btn-primary editbranchdatasubmit me-sm-3 me-1">Update</button>
                          <button
                            type="button"
                            class="btn btn-label-secondary editbranchdataclose"
                            data-bs-dismiss="modal"
                            aria-label="Close"
                          >
                            Cancel
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
              <!--/ Edit User Modal -->

              <!-- Add New Contact Modal -->  
              <div class="modal fade" id="addNewContact" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered1 modal-simple modal-add-new-cc">
                  <div class="modal-content p-3 p-md-5">
                    <div class="modal-body">
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      <div class="text-center mb-4">
                        <h3>Contact Details</h3>
                        <p>Add/Update Contact Information</p>
                      </div>
                      <form id="addContactform" class="row g-3" onsubmit="return false">
                        <div class="col-12">
                          <label class="form-label w-100" for="modalAddCard">Contact Type 
                          <label class="emptitle additem" name="addmodalcontacttype"><i
																class="bx bxs-plus-circle ownstyle1"></i></label>
                          </label>
                          <div class="input-group input-group-merge">
                            <select id="modalcontacttype" class="form-select modalcontacttype" required>
	                         
	                         <option value="">-</option>
							<th:block th:each="str :${CONTACTTYPE}">
								<option  th:value="${str}"  th:text="${str}"></option>
							</th:block>
	                         
	                        </select>
	                         <div class="invalid-feedback">Please select contact type</div>
                           <input
                              type="hidden"
                              id="modalcontactid"
                              name="modalcontactid"
                              class="form-contro"
                              
                            />
                          </div>
                        </div>
                        <div class="col-12">
                          <label class="form-label" for="modalcontactPhone">Phone Number </label>
                          <div class="input-group input-group-merge">
                            <span class="input-group-text">+91</span>
                            <input
                              type="text"
                              id="modalcontactPhone"
                              name="modalcontactPhone"
                              class="form-control phone-number-otp-mask" pattern=".{12}"
                              placeholder="999 555 0111"
                              required
                            />
                            
                          </div>
                        </div>
                        <div class="col-12">
                          <label class="form-label" for="modalContactemail">Email </label>
                          <input
                            type="email"
                            id="modalContactemail"
                            class="form-control expiry-date-mask"
                            
                          />
                          <div class="invalid-feedback">Please enter a valid email</div>
                        </div>
                        
                        
                        <div class="col-12">
                          <label class="switch">
                            <input type="checkbox" class="switch-input" id="modalcontactprimary"/>
                            <span class="switch-toggle-slider">
                              <span class="switch-on">
                                <i class="bx bx-check"></i>
                              </span>
                              <span class="switch-off">
                                <i class="bx bx-x"></i>
                              </span>
                            </span>
                            <span class="switch-label">Make this as primary contact?</span>
                          </label>
                        </div>
                        
                        <div class="col-12 text-center mt-4">
                          <button type="submit" class="btn  btn-primary me-sm-3 me-1 contactsavebtn">Submit</button>
                          <button
                            type="reset"
                            class="btn btn-label-secondary btn-reset contactclosebtn"
                            data-bs-dismiss="modal"
                            aria-label="Close"
                          >
                            Cancel
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
              <!--/ Add New Credit Card Modal -->
              <!-- Add New Address Modal -->
              <div class="modal fade" id="addNewAddress" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-simple modal-add-new-address">
                  <div class="modal-content p-3 p-md-5">
                    <div class="modal-body">
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      <div class="text-center mb-4">
                        <h3 class="address-title"> Address</h3>
                        <p class="address-subtitle">Add/Update Address Details</p>
                      </div>
                      <form id="addNewAddressForm" class="row g-3" onsubmit="return false">
                        <div class="col-12">
                          <label class="form-label" for="modalAddressCountry">Country</label>
                          <select
                            id="modalAddressCountry"
                            name="modalAddressCountry"
                            class="select2 form-select"
                            data-allow-clear="true"
                            th:value="${BranchMaster.COUNTRY}"
                            required
                          >
                            <option value="">Select</option>
                            <option value="Australia">Australia</option>
                            <option value="Bangladesh">Bangladesh</option>
                            <option value="Belarus">Belarus</option>
                            <option value="Brazil">Brazil</option>
                            <option value="Canada">Canada</option>
                            <option value="China">China</option>
                            <option value="France">France</option>
                            <option value="Germany">Germany</option>
                            <option value="India">India</option>
                            <option value="Indonesia">Indonesia</option>
                            <option value="Israel">Israel</option>
                            <option value="Italy">Italy</option>
                            <option value="Japan">Japan</option>
                            <option value="Korea">Korea, Republic of</option>
                            <option value="Mexico">Mexico</option>
                            <option value="Philippines">Philippines</option>
                            <option value="Russia">Russian Federation</option>
                            <option value="South Africa">South Africa</option>
                            <option value="Thailand">Thailand</option>
                            <option value="Turkey">Turkey</option>
                            <option value="Ukraine">Ukraine</option>
                            <option value="United Arab Emirates">United Arab Emirates</option>
                            <option value="United Kingdom">United Kingdom</option>
                            <option value="United States">United States</option>
                          </select>
                        </div>
                        <div class="col-12">
                          <label class="form-label" for="modalAddressAddress1">Address Line 1</label>
                          <input
                            type="text"
                            id="modalAddressAddress1"
                            name="modalAddressAddress1"
                            class="form-control"
                            placeholder="Flat, House no, Building, Apartment"
                            th:value="${BranchMaster.BRANCH_ADDRESSLINE1}"
                            required
                          />
                        </div>
                        <div class="col-12">
                          <label class="form-label" for="modalAddressAddress2">Address Line 2</label>
                          <input
                            type="text"
                            id="modalAddressAddress2"
                            name="modalAddressAddress2"
                            class="form-control"
                            placeholder="Area, Street, Sector"
                            th:value="${BranchMaster.BRANCH_ADDRESSLINE2}"
                          />
                        </div>
                        <div class="col-12">
                          <label class="form-label" for="modalAddressLandmark">Landmark</label>
                          <input
                            type="text"
                            id="modalAddressLandmark"
                            name="modalAddressLandmark"
                            class="form-control"
                            placeholder="E.g. near Kovai All India Radio"
                            th:value="${BranchMaster.BRANCH_ADDRESSLandMark}"
                          />
                        </div>
                        <div class="col-12 col-md-6">
                          <label class="form-label" for="modalAddressVillage">Village </label>
                          <input
                            type="text"
                            id="modalAddressVillage"
                            name="modalAddressVillage"
                            class="form-control"
                            th:value="${BranchMaster.BRANCH_ADDRESSVillage}"
                          />
                        </div>
                        <div class="col-12 col-md-6">
                          <label class="form-label" for="modalAddressCity">City</label>
                          <input
                            type="text"
                            id="modalAddressCity"
                            name="modalAddressCity"
                            class="form-control"
                            th:value="${BranchMaster.CITY}"
                            required
                          />
                        </div>
                        <div class="col-12 col-md-6">
                          <label class="form-label" for="modalAddressLandmark">State</label>
                          <input
                            type="text"
                            id="modalAddressState"
                            name="modalAddressState"
                            class="form-control"
                            th:value="${BranchMaster.STATE}"
                            required
                          />
                        </div>
                        <div class="col-12 col-md-6">
                          <label class="form-label" for="modalAddressZipCode">Zip Code</label>
                          <input
                            type="number"
                            id="modalAddressZipCode"
                            name="modalAddressZipCode"
                            class="form-control"
                            th:value="${BranchMaster.ZIP_CODE}"
                            
                          />
                        </div>
                        
                        <div class="col-12 text-center mt-4">
                          <button type="submit" class="btn btn-primary me-sm-3 me-1 editbranchAddressdatasubmit">Update</button>
                          <button
                            type="button"
                            class="btn btn-label-secondary editbranchAddressdataclose"
                            data-bs-dismiss="modal"
                            aria-label="Close"
                          >
                            Cancel
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
              <!--/ Add New Address Modal -->
              
              <!-- Add Document -->
              <div class="modal fade" id="addNewDocument" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered1 modal-simple modal-add-new-cc">
                  <div class="modal-content p-3 p-md-5">
                    <div class="modal-body">
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      <div class="text-center mb-4">
                        <h3>Add Document  </h3>
                        <p>Attach Files / Documents / Image</p>
                      </div>
                      <form id="addNewdocument" class="row g-3" onsubmit="return false">
                        <div class="col-12">
                          <label class="form-label w-100" for="modalAddCard">Document Type
                          	<label class="emptitle additem" name="addmodaldocumenttype">
                          		<i class="bx bxs-plus-circle ownstyle1"></i></label>
                          		
                           </label>
                          <div class="input-group input-group-merge">
                            <select id="modalDocumenttype" class="form-select modalDocumenttype">
	                          <option value="">Default select</option>
	                          <th:block th:each="str :${Documenttype}">
								<option  th:value="${str}"  th:text="${str}"></option>
							</th:block>
	                         
	                        </select>
                           
                          </div>
                        </div>
                        <div class="col-12">
                          <label class="form-label" for="modalAddCardName">Document No </label>
                          <input
                            type="text"
                            id="modalDocNo"
                            class="form-control"
                          />
                        </div>
                        <div class="col-12">
                          <label class="form-label" for="modalAddCardExpiryDate">Upload File </label>
                          <input
                            type="file"
                            id="modalFile"
                            class="form-control"
                            accept="image/jpeg,image/png,image/jpg,application/pdf"
                          />
                        </div>
                        <div class="col-12 text-center mt-4">
                          <button type="submit" class="btn btn-primary me-sm-3 me-1 documentsave">ADD</button>
                          <button
                            type="reset"
                            class="btn btn-label-secondary btn-reset documentclose"
                            data-bs-dismiss="modal"
                            aria-label="Close"
                          >
                            Cancel
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
              <!--/ Add Document -->
             
                <!-- Add BankDetails -->
              <div class="modal fade" id="addNewBankDetails" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered1 modal-simple modal-add-new-cc">
                  <div class="modal-content p-3 p-md-5">
                    <div class="modal-body">
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      <div class="text-center mb-4">
                        <h3>Bank Details  </h3>
                        <p>Add/Update Bank Information</p>
                      </div>
                      <form id="addNewBankDetails" class="row g-3" onsubmit="return false" th:with ="accobj = ${BranchMaster.branchAccNo[0]}">
                        
                        <div class="col-12">
                          <label class="form-label" for="model_acno">A.C.No </label>
                           <input
                            type="hidden"
                            id="model_branchAccnoid"
                            class="form-control expiry-date-mask" th:value="${accobj.branchAccnoid}" required
                          />
                          <input
                            type="text"
                            id="model_acno"
                            class="form-control expiry-date-mask" th:value="${accobj.acno}" required
                          />
                        </div>
                        <div class="col-12">
                          <label class="form-label" for="model_acno_confirm">Confirm The A.C.No </label>
                          <input
                            type="password"
                            id="model_acno_confirm" 
                            class="form-control expiry-date-mask" th:value="${accobj.acno}" required
                          /> 
                        </div>
                        <div class="col-12">
                          <label class="form-label" for="model_acname">Account Name</label>
                          <input
                            type="text"
                            id="model_acname"
                            class="form-control expiry-date-mask" th:value="${accobj.acname}" required
                          />
                        </div>
                        <div class="col-12">
                          <label class="form-label" for="model_bankname">Bank Name</label>
                          <input
                            type="text"
                            id="model_bankname"
                            class="form-control expiry-date-mask" th:value="${accobj.bankname}" required
                          />
                        </div>
                        <div class="col-6">
                          <label class="form-label" for="model_branchname">Branch Name </label>
                          <input
                            type="text"
                            id="model_branchname"
                            class="form-control expiry-date-mask" th:value="${accobj.branchname}" required
                          />
                        </div>
                        <div class="col-6">
                          <label class="form-label" for="model_ifsccode">IFSC Code  </label>
                          <input
                            type="text"
                            id="model_ifsccode"
                            class="form-control expiry-date-mask" th:value="${accobj.ifsccode}" required
                          />
                        </div>
                        
                        <div class="col-12 text-center mt-4">
                          <button type="submit" class="btn btn-primary me-sm-3 me-1 BankDetailssave">Update</button>
                          <button
                            type="button"
                            class="btn btn-label-secondary btn-reset BankDetailsclose"
                            data-bs-dismiss="modal"
                            aria-label="Close"
                          >
                            Cancel
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
              <!--/ Add BankDetails -->
               
              <!--scrolling content Modal -->
				<div class="modal fade" id="ItemStatusScrollable"
					tabindex="-1" role="dialog"
					aria-labelledby="ItemStatusScrollableTitle"
					aria-hidden="true">
					<div class="modal-dialog modal-dialog-scrollable"
						role="document">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title white"
									id="ItemStatusScrollableTitle"></h5>
								<button
                                  type="button"
                                  class="btn-close"
                                  data-bs-dismiss="modal"
                                  aria-label="Close"
                                ></button>
							</div>
							<div class="modal-body">
								<div class="col-md-12">
									<div class="form-group">
										<label for="addmodel" id="additemalltxt"></label>
										<div class="position-relative">
											<fieldset class="form-group">
												<input type="text" id="additemall" name="addmodel"
													class="form-control capitalize">
											</fieldset>
										</div>
									</div>
								</div>

							</div>
							<div class="modal-footer">
								<button type="button" class="btn btn-light-secondary"
									data-bs-dismiss="modal">
									<i class="bx bx-x d-block d-sm-none"></i> <span
										class="d-none d-sm-block">Close</span>
								</button>
								<button type="button" class="btn btn-primary ml-1"
									id="additemallsavebtn">
									<i class="bx bx-check d-block d-sm-none"></i> <span
										class="d-none d-sm-block">ADD</span>
								</button>
							</div>
						</div>
					</div>
				</div>
				<!--scrolling content Modal -->
              <!-- /Modal -->
            </div>
            <!-- / Content -->

            <!-- Footer -->
            <footer class="content-footer footer bg-footer-theme">
              <div class="container-fluid d-flex flex-wrap justify-content-between py-2 flex-md-row flex-column">
                <div class="mb-2 mb-md-0">
                
                </div>
                <div>

                </div>
              </div>
            </footer>
            <!-- / Footer -->

            <div class="content-backdrop fade"></div>
          </div>
          <!-- Content wrapper -->
        </div>
        <!-- / Layout page -->
      </div>

      <!-- Overlay -->
      <div class="layout-overlay layout-menu-toggle"></div>

      <!-- Drag Target Area To SlideIn Menu On Small Screens -->
      <div class="drag-target"></div>
    </div>
    <!-- / Layout wrapper -->

<!-- 
BranchID
Model_B_TYPE
Model_BRANCH_NAME
Model_BRANCH_IN_CHARGE
Model_STATED_DATE
Model_COMES_UNDER
Model_CURRENT_STATUS
 -->
    <!-- Core JS -->
    <!-- build:js assets/vendor/js/core.js -->
    <script th:src="@{/assets/vendor/libs/jquery/jquery.js}"></script>
    <script th:src="@{/assets/vendor/libs/popper/popper.js}"></script>
    <script th:src="@{/assets/vendor/js/bootstrap.js}"></script>
    <script th:src="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js}"></script>

    <script th:src="@{/assets/vendor/libs/hammer/hammer.js}"></script>

    <script th:src="@{/assets/vendor/libs/i18n/i18n.js}"></script>
    <script th:src="@{/assets/vendor/libs/typeahead-js/typeahead.js}"></script>

    <script th:src="@{/assets/vendor/js/menu.js}"></script>
    <!-- endbuild -->

    <!-- Vendors JS -->
    <script th:src="@{/assets/vendor/libs/moment/moment.js}"></script>
    <script th:src="@{/assets/vendor/libs/datatables/jquery.dataTables.js}"></script>
    <script th:src="@{/assets/vendor/libs/datatables-bs5/datatables-bootstrap5.js}"></script>
    <script th:src="@{/assets/vendor/libs/datatables-responsive/datatables.responsive.js}"></script>
    <script th:src="@{/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.js}"></script>
    <script th:src="@{/assets/vendor/libs/datatables-buttons/datatables-buttons.js}"></script>
    <script th:src="@{/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.js}"></script>
    <script th:src="@{/assets/vendor/libs/jszip/jszip.js}"></script>
    <script th:src="@{/assets/vendor/libs/pdfmake/pdfmake.js}"></script>
    <script th:src="@{/assets/vendor/libs/datatables-buttons/buttons.html5.js}"></script>
    <script th:src="@{/assets/vendor/libs/datatables-buttons/buttons.print.js}"></script>
    <script th:src="@{/assets/vendor/libs/sweetalert2/sweetalert2.js}"></script>
    <script th:src="@{/assets/vendor/libs/cleavejs/cleave.js}"></script>
    <script th:src="@{/assets/vendor/libs/cleavejs/cleave-phone.js}"></script>
    <script th:src="@{/assets/vendor/libs/select2/select2.js}"></script>
	<!-- Form Validation -->
    <script th:src="@{/assets/vendor/libs/formvalidation/dist/js/FormValidation.min.js}"></script>
    <script th:src="@{/assets/vendor/libs/formvalidation/dist/js/plugins/Bootstrap5.min.js}"></script>
    <script th:src="@{/assets/vendor/libs/formvalidation/dist/js/plugins/AutoFocus.min.js}"></script>
     
    <!-- Main JS -->
    <script th:src="@{/assets/js/main.js}"></script>
    
	<!-- Flat Picker -->
    <script th:src="@{/assets/vendor/libs/moment/moment.js}"></script>
    <script th:src="@{/assets/vendor/libs/flatpickr/flatpickr.js}"></script>
     <script th:src="@{/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.js}"></script>
    <script th:src="@{/assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.js}"></script>
    <script th:src="@{/assets/vendor/libs/jquery-timepicker/jquery-timepicker.js}"></script>
    <script th:src="@{/assets/vendor/libs/pickr/pickr.js}"></script>
    
    <!-- Page JS -->
    <!-- <script th:src="@{/assets/js/modal-edit-user.js}"></script> -->
    <script th:src="@{/assets/js/app-user-view.js}"></script>
    <script th:src="@{/assets/js/app-user-view-account.js}"></script>
    
     
    
	<script>
	var NATUREOFWORK_temp = "";
	
	$(document).ready(function() {  
    	//--------------------------------------------------------------------------------------------------------------------------------------
    	 var branchtypp="[[${BranchMaster['B_TYPE']}]]";
    	 document.getElementById("radio"+ branchtypp +"").checked=true;
    	 
    	 var country="[[${BranchMaster['COUNTRY']}]]";
    	 $('#modalAddressCountry').val(country).change();
 		//--------------------------------------------------------------------------------------------------------------------------------------		 		

    	 	var UNITS="[[${UNITS}]]";
			
			
			UNITS_temp="";
			var array = UNITS.replace("[","").replace("]","").split(",");
			for(i=0;i<array.length;i++){
				UNITS_temp += "<option value='" +array[i] + "'>"+array[i] + "</option>";
			}
    	 

			//console.log(Accountsheadsexpenseitems);
			var Accountsheadsexpenseitemsstr ="";
			Accountsheadsexpenseitems.forEach(myFunction);
			
			function myFunction(item) {
				 arritem = item.split("|");
				Accountsheadsexpenseitemsstr += "<option value='" +arritem[0] + "'>"+arritem[1] + "</option>";
			}
			
			NATUREOFWORK_temp=Accountsheadsexpenseitemsstr;
		//--------------------------------------------------------------------------------------------------------------------------------------		 		

		$(function() {
			var token = $("meta[name='_csrf']").attr("content");
			var header = $("meta[name='_csrf_header']").attr("content");
			$(document).ajaxSend(function(e, xhr, options) {
				xhr.setRequestHeader(header, token);
			});
		});
		//--------------------------------------------------------------------------------------------------------------------------------------		 
	

		 $('#editBranchdetailsForm').on('submit', function(event){

			 if($('#Model_STATED_DATE').val() == '' || $('#Model_effectiveon').val() == '')
	    	 {
		    	  Swal.fire({
				        title: '',
				        text: 'Start & Effect Date Should not be empty!',
				        confirmButtonText: 'Ok',
				        customClass: {
				          confirmButton: 'btn btn-primary'
				        },
				        buttonsStyling: false
				      });
	   		 }else
	   		 {	
		    	    if(event.target.checkValidity()){
		   			
		    	    	$('.editbranchdatasubmit').prop("disabled",true);
		    	    	$('.editbranchdatasubmit').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
		    	    	var BranchID=$("#BranchID").val();
		    	    	var branchName =$('#Model_BRANCH_NAME').val();
		  	        	var branch_type =$("input[name=Model_B_TYPE]:checked").val();
		  	        	var branch_incharge =$('#Model_BRANCH_IN_CHARGE').val();
		  	        	var branch_startdate =$('#Model_STATED_DATE').val();
		  	        	var Model_COMES_UNDER =$('#Model_COMES_UNDER').val();
		  	        	var branchCode =$('#Model_BranchCode').val();
		  	        	var effectiveon =$('#Model_effectiveon').val();
		  	        	var branchcurrentstatus =$('#Model_CURRENT_STATUS').val();
		  	        	
		  	        	 var formData = {
		  	        			 BranchID: BranchID,
		  	        			 branchName : branchName,
		  	        			 branch_type : branch_type,
		  	        			 branch_incharge : branch_incharge,
		  	        			 branch_startdate : branch_startdate,
		  	        			 branchHierarchy : Model_COMES_UNDER,
		  	        			 branchstatus : branchcurrentstatus,
		  	        			 effectiveon: effectiveon,
		  	        			 branchCode : branchCode
		  				 }
		  				 $.ajax({
		  						type : "POST",url : "branchupdatejson",
		  						data : formData, success : function(result) {
		  							var bmobj = JSON.parse(JSON.stringify(result));
		  							//console.log(bmobj);
		  							
		  							$('#Lbl_B_TYPE').text(bmobj.b_TYPE);
		  							$('#Lbl_BRANCH_NAME').text(bmobj.branch_NAME);
		  							$('#Lbl_BRANCH_IN_CHARGE').text(bmobj.branch_IN_CHARGE_name);
		  							$('#Lbl_STATED_DATE').text(bmobj.startdateMMformat);
		  							$('#Lbl_COMES_UNDER').text(bmobj.comes_UNDER_name);
		  							$('#Lbl_BranchCode').text(bmobj.branchCode);
		  							$('#Lbl_effectiveon').text(bmobj.effectiveonMMformat);
		  							if(bmobj.current_STATUS == 'Active')
	  								{
		  								$('#Lbl_CURRENT_STATUS').html('<span  class="badge bg-label-success">Active</span>');
	  								}else
  									{
	  									$('#Lbl_CURRENT_STATUS').html('<span  class="badge bg-label-danger">In Active</span>');
  									}

		  							validationformreset();
			  								
		  						},
		  						error : function(e) {
		  							console.log("Error" + e);
		  						}
		  					});
		  	        }	
		    	    else
		        	{
		    	    	$('.editbranchdatasubmit').prop("disabled",false);
		        	}

	   		 }
		    	
		      });
		// --------------------------------------------------------------------
	     
	     $(document).on("change", "input[name=Model_B_TYPE]", function() {	
				var val=$(this).val();
				
				if(val == 'Head-Office')
				{
					let branchid = $("#BranchID").val();
					formData={
							branchid : branchid
					}
					 $.ajax({
							type : "GET",url : "checkHeadofficeisPresant",
							data :formData ,success : function(result) {
									if(result == true)
										{
											Swal.fire({
										        title: '',
										        text: "A company can only have one head and it already exists",
										        confirmButtonText: 'Ok',
										        customClass: {
										          confirmButton: 'btn btn-primary'
										        },
										        buttonsStyling: false
										      });
											document.getElementById("radioHead-Office").checked=false;
											
										}else
										{
											
											$('#Model_COMES_UNDER').append('<option value="Self">Self</option>');
											$('#Model_COMES_UNDER').val('Self').change();
											$('#Model_COMES_UNDER').attr('disabled',true);
										}
							 }
					 });
					 
				}else
					{
					    $('#Model_COMES_UNDER option[value="Self"]').remove();
						$('#Model_COMES_UNDER').attr('disabled',false);
					}
			});
	   //------------------------------------------------------------------------ 			 
	

		 $('.editbranchAddressdatasubmit').on('click', function(event){

		    	  $('.editbranchAddressdatasubmit').prop("disabled",true);
		    	  
		    	    if(event.target.checkValidity()){
		    	    	$('.editbranchAddressdatasubmit').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
		    	    	var BranchID=$("#BranchID").val();
		    	    	var modalAddressCountry =$('#modalAddressCountry').val();
		    	    	var modalAddressAddress1 =$('#modalAddressAddress1').val();
		    	    	var modalAddressAddress2 =$('#modalAddressAddress2').val();
		    	    	var modalAddressLandmark =$('#modalAddressLandmark').val();
		    	    	var modalAddressVillage =$('#modalAddressVillage').val();
		    	    	var modalAddressCity =$('#modalAddressCity').val();
		    	    	var modalAddressState =$('#modalAddressState').val();
		    	    	var modalAddressZipCode =$('#modalAddressZipCode').val();
		    	    	var formData = {
		  	        			 BranchID: BranchID,
		  	        			AddressCountry : modalAddressCountry,
		  	        			AddressAddress1 : modalAddressAddress1,
		  	        			AddressAddress2 : modalAddressAddress2,
		  	        			AddressLandmark : modalAddressLandmark,
		  	        			AddressVillage : modalAddressVillage,
		  	        			AddressCity : modalAddressCity,
		  	        			AddressState : modalAddressState,
		  	        			AddressZipCode : modalAddressZipCode,
		  	        			functiontype : 'Branch'
		  				 }
		  				 $.ajax({
		  						type : "POST",url : "Addressupdatejson",
		  						data : formData, success : function(result) {
		  							var bmobj = JSON.parse(JSON.stringify(result));
		  							//console.log(bmobj);
		  							$('#Lbl_AddressCountry').text(bmobj.Lbl_AddressCountry);
		  							$('#Lbl_AddressAddress1').text(bmobj.branch_ADDRESSLINE1);
		  							$('#Lbl_AddressAddress2').text(bmobj.branch_ADDRESSLINE2);
		  							$('#Lbl_AddressLandmark').text(bmobj.branch_ADDRESSLandMark);
		  							$('#Lbl_AddressVillage').text(bmobj.branch_ADDRESSVillage);
		  							$('#Lbl_AddressCity').text(bmobj.city);
		  							$('#Lbl_AddressState').text(bmobj.state);
		  							$('#Lbl_AddressZipCode').text(bmobj.zip_CODE);
									validationformaddressreset();
		  						},
		  						error : function(e) {
		  							console.log("Error" + e);
		  						}
		  					});
		  	        }	
		    	    else
		        	{
		    	    	$('.editbranchAddressdatasubmit').prop("disabled",false);
		        	}
		      });
	  		// --------------------------------------------------------------------
		   		function validationformreset()
			   {
		   				$('.editbranchdataclose').click();
		   				$('.editbranchdatasubmit').prop("disabled",false);
			   			$('.editbranchdatasubmit').html("Submit");
			   }
		   		function validationformaddressreset()
			   {
		   				$('.editbranchAddressdataclose').click();
		   				$('.editbranchAddressdatasubmit').prop("disabled",false);
			   			$('.editbranchAddressdatasubmit').html("Submit");
			   }
		   		function validationformContactreset()
				   {
			   				$('.contactclosebtn').click();
			   				$('.contactsavebtn').prop("disabled",false);
				   			$('.contactsavebtn').html("Submit");
				   			$('#modalcontactid').val("-");
				   }
		   		
		   		function validationformfilereset()
				   {
			   				$('.documentclose').click();
			   				$('.documentsave').prop("disabled",false);
				   			$('.documentsave').html("Submit");
				   }
		   		function validationformbankaccreset()
		   		{
		   			$('.BankDetailsclose').click();
	   				$('.BankDetailssave').prop("disabled",false);
		   			$('.BankDetailssave').html("Submit");
		   		}

				function validationinvoiceformreset()
				   {
			   				$('.editPurchaseclose').click();
			   				$('.editPurchasesubmit').prop("disabled",false);
			   				$('#purchaseitemlist').html("");
			   				purchaseIncre=0;
			   				invoiceamountCalculator();
				   			$('.editPurchasesubmit').html("Save The Invoice");
				   			
				   }
				
				function validationreceiptformreset()
				   {
					$('.editReceiptclose').click();
	   				$('.editReceiptsubmit').prop("disabled",false);
		   			$('.editReceiptsubmit').html("Save");
				   			
				   }
			//------------------------------------------------------------------------ 
			 $('.addNewPurchasebtn').on('click', function(event){
				validationinvoiceformreset();
				$("#branchpurchaseid").val("");
				purchaseIncre = 1;
				html='<div class="d-flex border rounded position-relative pe-0 incontact'+ purchaseIncre + '"> <div class="row w-100 m-0 p-3"> 	<div class="col-md-4 col-12 mb-md-0 mb-3 ps-md-0"> <p class="mb-2 repeater-title">Item Description</p> <input type="hidden" id="branchpurchaseitemid'+ purchaseIncre +'" name="branchpurchaseitemid'+ purchaseIncre +'" /> <select class="form-select item-details mb-2" id="BranchpurchaseItem'+ purchaseIncre +'" name="BranchpurchaseItem'+ purchaseIncre +'" required> <option value="">-</option> ' + NATUREOFWORK_temp + '</select> <textarea class="form-control" rows="2" id="Description'+ purchaseIncre +'" name="Description'+ purchaseIncre +'" placeholder="Item Information"></textarea> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Qty</p> <input type="number" class="form-control invoice-item-qty"  min="1" max="500" id="Quantity'+ purchaseIncre +'" name="Quantity'+ purchaseIncre +'" onchange="invoiceamountCalculator()" required /> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Unit</p> <select class="form-select item-details mb-2" id="Unit'+ purchaseIncre +'" name="Unit'+ purchaseIncre +'" required> <option value="">-</option> '+ UNITS_temp +'  </select> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Price</p> <input type="number" class="form-control invoice-item-price mb-2" onchange="invoiceamountCalculator()" id="Price'+ purchaseIncre +'" name="Price'+ purchaseIncre +'" required/> <input type="hidden" id="Discountperip'+ purchaseIncre +'" value="0" name="Discountper'+ purchaseIncre +'" /> <input type="hidden" id="CGSTperip'+ purchaseIncre +'" value="0" name="CGSTper'+ purchaseIncre +'" /> <input type="hidden" id="IGSTperip'+ purchaseIncre +'" value="0" name="IGSTper'+ purchaseIncre +'" /> <input type="hidden" id="SGSTperip'+ purchaseIncre +'" value="0" name="SGSTper'+ purchaseIncre +'" /> 	 <div> <span>Discount Per Unit:</span> <span  data-bs-toggle="tooltip" data-bs-placement="top" 	title="Discount %"	class="discount me-2" id="Discountpertxt'+  purchaseIncre +'">0%</span> <span class="tax-1 me-2" data-bs-toggle="tooltip" 	data-bs-placement="top" title="CGST %" 	id="CGSTpertxt'+  purchaseIncre +'">0%</span> <span class="tax-2" 	data-bs-toggle="tooltip" data-bs-placement="top" 	title="SGST %" id="SGSTpertxt'+  purchaseIncre +'">0%</span> <span 	class="tax-2" data-bs-toggle="tooltip" 	data-bs-placement="top" title="IGST %" 	id="IGSTpertxt'+  purchaseIncre +'">0%</span> </div> 	</div> 	<div class="col-md-2 col-12 pe-0"> <p class="mb-2 repeater-title">Taxable Amount</p> <p class="mb-0" id="taxableamount'+  purchaseIncre +'">0.00</p> 	</div> </div> <div 	class="d-flex flex-column align-items-center justify-content-between border-start p-2"> 	<i class="bx bx-x fs-4 text-muted cursor-pointer" onclick="deleteprojectpurchaseItem('+ purchaseIncre +')"></i> 	<div class="dropdown"> <i class="bx bx-cog bx-xs text-muted cursor-pointer more-options-dropdown" role="button" id="dropdownMenuButton" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false"> </i> <div class="dropdown-menu dropdown-menu-end w-px-300 p-3" aria-labelledby="dropdownMenuButton"> <div class="row g-3"> 	<div class="col-12"> <label for="discountInput" class="form-label">Discount(%)</label> <input type="number" class="form-control" id="Discountper'+ purchaseIncre +'" min="0" max="100" /> 	</div> 	<div class="col-md-6"> <label for="taxInput1" class="form-label">CGST % 1</label> <select id="CGSTper'+ purchaseIncre +'" class="form-select tax-select CGST"> <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> 	<div class="col-md-6"> <label for="taxInput2" class="form-label">SGST % 2</label> <select id="SGSTper'+ purchaseIncre +'" class="form-select tax-select SGST"> <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> 	<div class="col-md-12"> <label for="taxInput2" class="form-label">IGST % 2</label> <select id="IGSTper'+ purchaseIncre +'" class="form-select tax-select IGST" onchange="IGSTchange('+ purchaseIncre +')"> <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> </div> <div class="dropdown-divider my-3"></div> <button type="button" onclick="applydiscountandtax(this)" name="'+ purchaseIncre + '"	class="btn btn-label-primary btn-apply-changes">Apply</button> </div> 	</div> </div> </div>';
				$('#purchaseitemlist').html(html);
				$("#branchpurchaseType").val("Tax Invoice").change();
			 });	
		   	// --------------------------------------------------------------------
		   	 
  			  $(".addcontactbtn").click(function(){
  				$('#modalcontactid').val("-");
  			  });
  			//--------------------------------------------------------------------------------------------------------------------------------------
				$('#editPurchaseformx').on('submit',function(event) {
					if (event.target.checkValidity()) {
						$('.editPurchasesubmit').prop("disabled",true);
						$('.editPurchasesubmit').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
						const formData = new FormData(document.querySelector("#editPurchaseformx"));
						formData.append("branchid","[[${BranchMaster['id']}]]");
						formData.append("branchpurchaseitemcount", purchaseIncre);
						
						$.ajax({
							type : "POST",
							url : "branchbranchpurchasesave",
							processData : false,
							contentType : false,
							data : formData,
							success : function(
									result) {
								
								validationinvoiceformreset();
								
								getpurchaselist();

							},
							error : function(e) {
								console.log("Error"+ e);
							}
						});
					} else {
						$('.editPurchasesubmit').prop("disabled",false);
					}
				});
				// --------------------------------------------------------------------
				
				$("#addnewpurchaseitem").click(function() {
					purchaseIncre = purchaseIncre+1;
					
					html='<div class="d-flex border rounded position-relative pe-0 incontact'+ purchaseIncre + '"> <div class="row w-100 m-0 p-3"> 	<div class="col-md-4 col-12 mb-md-0 mb-3 ps-md-0"> <p class="mb-2 repeater-title">Item Description</p> <input type="hidden" id="branchpurchaseitemid'+ purchaseIncre +'" name="branchpurchaseitemid'+ purchaseIncre +'" /> <select class="form-select item-details mb-2" id="BranchpurchaseItem'+ purchaseIncre +'" name="BranchpurchaseItem'+ purchaseIncre +'" required> <option value="">-</option> ' + NATUREOFWORK_temp + '</select> <textarea class="form-control" rows="2" id="Description'+ purchaseIncre +'" name="Description'+ purchaseIncre +'" placeholder="Item Information"></textarea> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Qty</p> <input type="number" class="form-control invoice-item-qty"  min="1" max="500" id="Quantity'+ purchaseIncre +'" name="Quantity'+ purchaseIncre +'" onchange="invoiceamountCalculator()" required /> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Unit</p> <select class="form-select item-details mb-2" id="Unit'+ purchaseIncre +'" name="Unit'+ purchaseIncre +'" required> <option value="">-</option> '+ UNITS_temp +'  </select> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Price</p> <input type="number" class="form-control invoice-item-price mb-2" onchange="invoiceamountCalculator()" id="Price'+ purchaseIncre +'" name="Price'+ purchaseIncre +'" required/> <input type="hidden" id="Discountperip'+ purchaseIncre +'" value="0" name="Discountper'+ purchaseIncre +'" /> <input type="hidden" id="CGSTperip'+ purchaseIncre +'" value="0" name="CGSTper'+ purchaseIncre +'" /> <input type="hidden" id="IGSTperip'+ purchaseIncre +'" value="0" name="IGSTper'+ purchaseIncre +'" /> <input type="hidden" id="SGSTperip'+ purchaseIncre +'" value="0" name="SGSTper'+ purchaseIncre +'" /> 	 <div> <span>Discount Per Unit:</span> <span  data-bs-toggle="tooltip" data-bs-placement="top" 	title="Discount %"	class="discount me-2" id="Discountpertxt'+  purchaseIncre +'">0%</span> <span class="tax-1 me-2" data-bs-toggle="tooltip" 	data-bs-placement="top" title="CGST %" 	id="CGSTpertxt'+  purchaseIncre +'">0%</span> <span class="tax-2" 	data-bs-toggle="tooltip" data-bs-placement="top" 	title="SGST %" id="SGSTpertxt'+  purchaseIncre +'">0%</span> <span 	class="tax-2" data-bs-toggle="tooltip" 	data-bs-placement="top" title="IGST %" 	id="IGSTpertxt'+  purchaseIncre +'">0%</span> </div> 	</div> 	<div class="col-md-2 col-12 pe-0"> <p class="mb-2 repeater-title">Taxable Amount</p> <p class="mb-0" id="taxableamount'+  purchaseIncre +'">0.00</p> 	</div> </div> <div 	class="d-flex flex-column align-items-center justify-content-between border-start p-2"> 	<i class="bx bx-x fs-4 text-muted cursor-pointer" onclick="deleteprojectpurchaseItem('+ purchaseIncre +')"></i> 	<div class="dropdown"> <i class="bx bx-cog bx-xs text-muted cursor-pointer more-options-dropdown" role="button" id="dropdownMenuButton" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false"> </i> <div class="dropdown-menu dropdown-menu-end w-px-300 p-3" aria-labelledby="dropdownMenuButton"> <div class="row g-3"> 	<div class="col-12"> <label for="discountInput" class="form-label">Discount(%)</label> <input type="number" class="form-control" id="Discountper'+ purchaseIncre +'" min="0" max="100" /> 	</div> 	<div class="col-md-6"> <label for="taxInput1" class="form-label">CGST % 1</label> <select id="CGSTper'+ purchaseIncre +'" class="form-select tax-select CGST"> <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> 	<div class="col-md-6"> <label for="taxInput2" class="form-label">SGST % 2</label> <select id="SGSTper'+ purchaseIncre +'" class="form-select tax-select SGST"> <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> 	<div class="col-md-12"> <label for="taxInput2" class="form-label">IGST % 2</label> <select id="IGSTper'+ purchaseIncre +'" class="form-select tax-select IGST" onchange="IGSTchange('+ purchaseIncre +')"> <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> </div> <div class="dropdown-divider my-3"></div> <button type="button" onclick="applydiscountandtax(this)" name="'+ purchaseIncre + '"	class="btn btn-label-primary btn-apply-changes">Apply</button> </div> 	</div> </div> </div>';
					$('#purchaseitemlist').append(html);
				});
				
				//--------------------------------------------------------------------------------------------------------------------------------------
				$('#editreceiptformx').on('submit',function(event) {
					if (event.target.checkValidity()) {
						$('.editReceiptsubmit').prop("disabled",true);
						$('.editReceiptsubmit').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
						const formData = new FormData(document.querySelector("#editreceiptformx"));
						formData.append("branchid","[[${BranchMaster['id']}]]");
						
						$.ajax({
							type : "POST",
							url : "branchpurchasepaymentsave",
							processData : false,
							contentType : false,
							data : formData,
							success : function(
									result) {
								
								validationreceiptformreset();
								
								getreceiptlist();

							},
							error : function(e) {
								console.log("Error"+ e);
							}
						});
					} else {
						$('.editReceiptsubmit').prop("disabled",false);
					}
				});
				// --------------------------------------------------------------------
				
				// ----------------------------------------------------------------------------------------------------------------------------------------
								function getpurchaselist() {
									
									var formData = {
										mastercategoryid : "[[${BranchMaster['id']}]]"
									}
	
									$.ajax({
										type : "POST",
										url : "getbranchpurchaselist",
										data : formData,
										success : function(result) {
											var htmlop="";
											var bmobj = JSON.parse(JSON.stringify(result));
											var total=0;
											//console.log(bmobj);
											
											bmobj.forEach((element, index, array) =>
								           	{
								           		var sub_total=0;
								           	  
								           		element.branchpurchaseItemMasterlist.forEach((elementx, indexx, arrayx) =>
									           	  {
									           		sub_total +=elementx.taxableAmount + elementx.cgstamount + elementx.sgstamount+ elementx.igstamount; 
									           	  });
									           	  
									           	 htmlop +="<tr><td class='text-nowrap editbranchprj' onclick='editpurchaseinfo(this)' id='"+element.branchpurchaseid +"'>"+element.branchpurchaseNo+"</td>";
									           	 htmlop +="<td class='text-nowrap'>"+element.branchpurchaseType +"</td><td class='text-nowrap'>"+element.branchpurchaseDateMMMddyyyy +"</td><td>"+element.dueDateMMMddyyyy +"</td>";
									           	 htmlop +="<td>"+sub_total.toFixed(2) +" <i class='bx bx-money  generatenewreceipt' onclick='generatereceipt("+element.branchpurchaseid +")'  ></i></td></tr>";
									           	 total +=parseFloat(sub_total);
								            });
											
											 htmlop += "<tr> <td colspan='3' class='align-top px-4 py-3'> </td> <td class='text-end px-4 py-3'> <p class='mb-0'>Total:</p> </td>  <td class='px-4 py-3'> <p class='fw-semibold mb-0'>Rs. "+ total.toFixed(2) +"</p> </td> </tr>";
											$('#branchPurchaselist').html(htmlop);
										},
										error : function(e) {
											console.log("Error" + e);
	
										}
	
									});
	
								}
								
								
								// ----------------------------------------------------------------------------------------------------------------------------------------
								function getreceiptlist() {
									
									var formData = {
										mastercategoryid : "[[${BranchMaster['id']}]]"
									}
	
									$.ajax({
										type : "POST",
										url : "getbranchpurpaymentlist",
										data : formData,
										success : function(result) {
											var htmlop="";
											var bmobj = JSON.parse(JSON.stringify(result));
											var total=0;
											//console.log(bmobj);
											
											bmobj.forEach((element, index, array) =>
								           	{
								           		var sub_total=0;
								           	  
								           		
									           	 htmlop +="<tr><td class='text-nowrap editbranchprj' onclick='editreceiptinfo(this)' id='"+element.recepitid +"'>"+element.recepitNo+"</td>";
									           	 htmlop +="<td class='text-nowrap'>"+element.purchaseNo +"</td><td class='text-nowrap'>"+element.recepitDateMMMddyyyy +"</td><td>"+element.depitedfrom_txt +"</td>";
									           	 htmlop +="<td>"+element.amount.toFixed(2) +"</td></tr>";
									           	 total +=parseFloat(element.amount);
								            });
											
											 htmlop += "<tr> <td colspan='3' class='align-top px-4 py-3'> </td> <td class='text-end px-4 py-3'> <p class='mb-0'>Total:</p> </td>  <td class='px-4 py-3'> <p class='fw-semibold mb-0'>Rs. "+ total.toFixed(2) +"</p> </td> </tr>";
												
											$('#receiptslist').html(htmlop);
										},
										error : function(e) {
											console.log("Error" + e);
	
										}
	
									});
	
								}
								// ----------------------------------------------------------------------------------------------------------------------------------------
								
  			// --------------------------------------------------------------------
  			
  			   	$('#addContactform').on('submit', function(event){
  			   	
  			   		formData={
						branchid : $("#BranchID").val(),
						src : "Branch",
						modalcontactid : $('#modalcontactid').val()								
				}
  			  $.ajax({
				type : "GET",url : "checkPrimaryContactisPresant",
				data :formData ,success : function(result) {
						if(result == true && $("#modalcontactprimary").is(':checked'))
							{
								Swal.fire({
							        title: '',
							        text: "Primary Contact it already exists",
							        confirmButtonText: 'Ok',
							        customClass: {
							          confirmButton: 'btn btn-primary'
							        },
							        buttonsStyling: false
							      });
								document.getElementById("radioHead-Office").checked=false;
								
							}else
							{
  			   	
					  			   		$('.contactsavebtn').prop("disabled",true);
							    	  
							    	    if(event.target.checkValidity()){
							    	    	$('.contactsavebtn').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
							    	    	var BranchID=$("#BranchID").val();
							    	    	var modalcontactid =$('#modalcontactid').val();
							    	    	var modalcontacttype =$('#modalcontacttype').val();
							    	    	var modalcontactPhone =$('#modalcontactPhone').val();
							    	    	var modalContactemail =$('#modalContactemail').val();
							    	    	var primarycontact =$("#modalcontactprimary").is(':checked');
							    	  
							    	    	
							    	    	var formData = {
							  	        			 BranchID: BranchID,
							  	        			 contactid: modalcontactid,
							  	        			 contacttype : modalcontacttype,
							  	        			 contactPhone : modalcontactPhone,
							  	        			 contactemail : modalContactemail,
							  	        			 primarycontact: primarycontact,
							  	        			functiontype : 'Branch'
							  				 }
							  				 $.ajax({
							  						type : "POST",url : "Contactupdatejson",
							  						data : formData, success : function(result) {
							  							var bmobj = JSON.parse(JSON.stringify(result));
							  							
							  							if(modalcontactid == '-')
						  								{
							  								let tempresultid=bmobj;
							  								let parameters= tempresultid +",'"+ modalcontacttype +"','"+ modalcontactPhone +"','"+ modalContactemail +"','"+ primarycontact +"'";
								  							let tempresult ='<div class="cardMaster border p-3 rounded mb-3 card'+ tempresultid +'"><div class="d-flex justify-content-between flex-sm-row flex-column"><div class="card-information">';
								  							tempresult += '<input type="hidden" class="primarycontact'+ tempresultid +'" value="'+ primarycontact +'"/><h6 class="mb-3 contacteditbtn contacttype'+  tempresultid +'"   onClick="reply_click('+ parameters +')">'+ modalcontacttype +'</h6>';
								  							tempresult += '<h6 class="mb-1 phonenumber'+  tempresultid +'">'+ modalcontactPhone +'</h6><span class="card-number email'+ tempresultid +'">'+ modalContactemail +'</span>';
								  							
								  							tempresult += '<span class="primarycontactlablecontainer'+  tempresultid +'">';
								  							if(primarycontact)
							  								{
								  								tempresult += '<span class="primarycontacttxt'+  tempresultid +'"><span class="badge bg-label-primary ">Primary</span></span>';
							  								}
								  							tempresult += '</span>'; 
								  							tempresult += '</div><div class="d-flex flex-column text-start text-lg-end"><div class="d-flex order-sm-0 order-1 mt-3">';
								  							//tempresult += '<button class="btn btn-label-primary me-3 " name="'+ tempresultid +'" onClick="reply_click('+ parameters +')"><i class="bx bxs-edit-alt"></i></button><br/>';
								  							tempresult += '<button class="btn btn-label-secondary"  id="'+ tempresultid +'" name="'+ tempresultid +'"  onClick="contactdeleteoperation('+ tempresultid +')"  ><i class="bx bxs-trash-alt"></i></button></div></div></div></div>';
								  						
								  							$('#contactaddidv').before(tempresult);
								  						    
						  								}
							  							else
						  								{
							  								
							  								if(primarycontact)
							  								{
							  									$('.primarycontactlablecontainer'+modalcontactid).html("<span class='badge bg-label-primary'>Primary</span>");
							  									
							  								}else
						  									{
							  									$('.primarycontactlablecontainer'+modalcontactid).html("");
							  										 
						  									}
							  								$('.contacttype'+modalcontactid).text(modalcontacttype);
							  								$('.phonenumber'+modalcontactid).text(modalcontactPhone);
							  								$('.email'+modalcontactid).text(modalContactemail);
							  								$('.primarycontact'+modalcontactid).val(primarycontact);
							  								
						  								}
								  							validationformContactreset();
							  						},
							  						error : function(e) {
							  							console.log("Error" + e);
							  						}
							  					});
							  	        }	
							    	    else
							        	{
							    	    	$('.contactsavebtn').prop("disabled",false);
							        	}
									}
							 }
					 });
  			   	});	
  			// --------------------------------------------------------------------
  			  $('.contacteditbtn').on('click', function(event){
  				$('.contactsavebtn').prop("disabled",false);
	   			$('.contactsavebtn').html("Submit");
	   			
  				let id=$(this).attr("name");
  				$('#modalcontactid').val(id);
				$('#modalcontacttype').val($('.contacttype'+id).text());
				$('#modalcontactPhone').val($('.phonenumber'+id).text());
				$('#modalContactemail').val($('.email'+id).text());
				if($('.primarycontact'+id).val()=='true')
				{
					$('#modalcontactprimary').prop("checked",true);	
				}else
				{
					$('#modalcontactprimary').prop("checked",false);
				}
				 
				$('#addNewContact').modal('show');
  			  });
  			// --------------------------------------------------------------------
  			
  			
  			// --------------------------------------------------------------------
  		    // --------------------------------------------------------------------
  			// File uploading 		  
  					 const addNewdocumentForm =document.getElementById("addNewdocument");
  					 const modalFile =document.getElementById("modalFile");
  					 addNewdocumentForm.addEventListener("submit", e =>{
  						 
  						 if($('#modalDocNo').val() == '' && modalFile.files[0] == null)
  				    	 {
  					    	  Swal.fire({
  							        title: '',
  							        text: 'Either Document No (or) Upload file is mandatory!',
  							        confirmButtonText: 'Ok',
  							        customClass: {
  							          confirmButton: 'btn btn-primary'
  							        },
  							        buttonsStyling: false
  							      });
  				   		 }else
  				   		 {	 
		  						$('.documentsave').prop("disabled",true);
		  						$('.documentsave').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
		  						const endpoint ="fileuploadjson";
		  						const formdata= new FormData();
		  						//console.log(modalFile.files);
		  						
		  						formdata.append("File_Attach",modalFile.files[0]);
		  						formdata.append("BranchID",$('#BranchID').val());
		  						formdata.append("Documenttype",$('#modalDocumenttype').val());
		  						formdata.append("DocNo",$('#modalDocNo').val());
		  						formdata.append("functiontype","Branch");
		  						
		  						  $.ajax({
		  			   					type : "POST",url : endpoint,
		  			   					data : formdata,
		  			   					contentType: false,
		  			   	              processData: false,
		  			   					success : function(result) {
		  			   						
		  			   					tempobj =JSON.parse(JSON.stringify(result));
		  			   						
		  			   					//console.log(tempobj);
		  								
			  							let tempresult = '<div class="cardMaster border p-3 rounded mb-3 filecard'+ tempobj.branchfilesid  +'"><div class="d-flex justify-content-between flex-sm-row flex-column"><div class="card-information">';		                              
			  							tempresult += '<h6 class="mb-1">'+ tempobj.documentType +'</h6>';
			  							tempresult += '<span class="card-number">'+ tempobj.documentNo +'</span>';
			  							if(tempobj.filePath != '')
			  							{
			  								tempresult += '<br/><a href="'+ tempobj.filePath +'" target="_blank">';
			  								if(tempobj.filePath.split(".")[1] == 'pdf')
		  									{
			  									tempresult += '<img src="assets/img/icons/misc/pdf.png" alt="PDF image" width="20" class="me-2">';
		  									}else
		 									{
		  										tempresult += '<img src="assets/img/icons/misc/jpg.png" alt="jp image" width="20" class="me-2">';
		 									}
			  								tempresult += '<span class="text-body"> ' + tempobj.filePath.split("/")[1].substring(15) + '</span>';
			  								tempresult += '</a>';
			  							}
			  							tempresult += '</div><div class="d-flex flex-column text-start text-lg-end"><div class="d-flex order-sm-0 order-1 mt-3">';
			  							
			  							tempresult += '<button class="btn btn-label-secondary filedeletebtn" name="'+ tempobj.branchfilesid +'"   onClick="filedeleteoperation('+ tempobj.branchfilesid +')"><i class="bx bxs-trash-alt"></i></button></div></div></div></div>';
			  								
			  							$('#fileaddidv').before(tempresult);
			  							
		  			   					validationformfilereset();
		  			   					},
		  			   					error : function(e) {
		  			   						console.log("Error" + e);
		  			   					}
		  			   				});
  				   		 }
  					 });
  				// --------------------------------------------------------------------
  				
  				$(".additem").click(function() {
					var name = $(this).attr('name');
					var labeltext = "";
					if (name == "addmodalcontacttype") {
						labeltext = "New Contact Type";
					}else if(name == "addmodaldocumenttype")
					{
						labeltext = "New Document Type";
					}
					
					$('#additemalltxt').text(labeltext);
					$('#ItemStatusScrollable').modal('toggle');

				});

				$("#additemallsavebtn").click(
						function() {
					if ($("#additemall").val() != '') {
						var name = $('#additemalltxt').text();
						var labeltext = "";
						if (name == "New Contact Type") {
							labeltext = "modalcontacttype";
						}else if (name == "New Document Type") {
							labeltext = "modalDocumenttype";
						}
						
						$('.' + labeltext).append(
								"<option value='"
										+ $("#additemall").val()
										+ "'>"
										+ $("#additemall").val()
										+ "</option>");
						//$('.' + labeltext).val($("#additemall").val());
						$("#additemall").val('');
						$('#ItemStatusScrollable').modal(
								'toggle');
					}
				});
  				
  				// --------------------------------------------------------------------
  				
  			   	$('#addNewBankDetails').on('submit', function(event){
  			   	 
  			   		
	  			   	if($('#model_acno').val() ==  $('#model_acno_confirm').val())
	  		    	 {
	  			    	  	$('.BankDetailssave').prop("disabled",true);
				    	  
				    	    if(event.target.checkValidity()){
				    	    	$('.BankDetailssave').html('<span class="spinner-border" role="status" aria-hidden="true"></span> Loading...');
				    	    	var BranchID=$("#BranchID").val();
				    	    	var model_acid =$('#model_branchAccnoid').val();
				    	    	var model_acno =$('#model_acno').val();
				    	    	var model_acname =$('#model_acname').val();
				    	    	var model_bankname =$('#model_bankname').val();
				    	    	var model_branchname =$('#model_branchname').val();
				    	    	var model_ifsccode =$('#model_ifsccode').val();
				    	    	var formData = {
				  	        			BranchID: BranchID,
				  	        			acid: model_acid,
				  	        			acno: model_acno,
				  	        			acname : model_acname,
				  	        			bankname : model_bankname,
				  	        			branchname : model_branchname,
				  	        			ifsccode : model_ifsccode,
				  	        			functiontype : 'Branch'
				  				 }
				    	    	
				  				 $.ajax({
				  						type : "POST",url : "Bankaccupdatejson",
				  						data : formData, success : function(result) {
				  							var bmobj = JSON.parse(JSON.stringify(result));
				  							//console.log(bmobj);
				  							$('#Lbl_acno').text(model_acno);
				  							$('#Lbl_acname').text(model_acname);
				  							$('#Lbl_bankname').text(model_bankname);
				  							$('#Lbl_branchname').text(model_branchname);
				  							$('#Lbl_ifsccode').text(model_ifsccode); 
				  							validationformbankaccreset();
				  						},
				  						error : function(e) {
				  							console.log("Error" + e);
				  						}
				  					});
		  	        }	
		    	    else
		        	{
		    	    	$('.BankDetailssave').prop("disabled",false);
		        	}
  		   		 }else{
  		   			 Swal.fire({
				        title: '',
					        text: 'Account number is not match!',
					        confirmButtonText: 'Ok',
					        customClass: {
					          confirmButton: 'btn btn-primary'
					        },
					        buttonsStyling: false
					      });
		   		 }
		   		 
  			   	});	
  			// --------------------------------------------------------------------
  			$('.collapsetogglebtn').click(function(){
  				 $('#collapsetoggleicon').toggleClass('bx-chevron-down bx-chevron-up'); 
  			});
  			// --------------------------------------------------------------------
  			//-------------------------------------------
								$('#payfull').change(function() {
							        if(this.checked) {
							        	$("#amount").val($('#purpaymentBalancetxt').text());
							        	
							        }
								});
			//--------------------------------------------
			$(document).ready(function(){
			    setTimeout(function(){
			    	
			    	getpurchaselist();
			    	getreceiptlist();
			     },500); // milliseconds
			});
			//-------------------------------------------
			  
		    }); // Jquery
    
    function reply_click(id,contacttype,phonenumber,email,primarycontact)
	{
		$('#modalcontactid').val(id);
		$('#modalcontacttype').val(contacttype);
		$('#modalcontactPhone').val(phonenumber);
		$('#modalContactemail').val(email);
		if(primarycontact=='true')
		{
			$('#modalcontactprimary').prop("checked",true);	
		}else
		{
			$('#modalcontactprimary').prop("checked",false);
		}
		$('#addNewContact').modal('show');
	}
		 
 
    function contactdeleteoperation(id){
    	 Swal.fire({
             title: 'Are you sure?',
             text: "You won't be able to revert this!",
             icon: 'warning',
             showCancelButton: true,
             confirmButtonText: 'Yes, delete it!',
             customClass: {
               confirmButton: 'btn btn-primary me-3',
               cancelButton: 'btn btn-label-secondary'
             },
             buttonsStyling: false
           }).then(function (result) {
             if (result.value) {
              var formData = {
           	 contactid: id,
           	functiontype : 'Branch'
           	 }
   			 $.ajax({
   					type : "POST",url : "Contactdeletejson",
   					data : formData, success : function(result) {
   						$('.card'+id).remove();
   						Swal.fire({
   				              icon: 'success',
   				              title: 'Deleted!',
   				              text: 'Contact has been deleted.',
   				              customClass: {
   				                confirmButton: 'btn btn-success'
   				              }
   				            });
   					},
   					error : function(e) {
   						console.log("Error" + e);
   					}
   				});
               
               }
           });
    }
  
  //------------------------------------------------------    
   function filedeleteoperation(id){
    	 Swal.fire({
             title: 'Are you sure?',
             text: "You won't be able to revert this!",
             icon: 'warning',
             showCancelButton: true,
             confirmButtonText: 'Yes, delete it!',
             customClass: {
               confirmButton: 'btn btn-primary me-3',
               cancelButton: 'btn btn-label-secondary'
             },
             buttonsStyling: false
           }).then(function (result) {
             if (result.value) {
              var formData = {
            		  fileid: id,
            		  functiontype : 'Branch'
           	 }
   			 $.ajax({
   					type : "POST",url : "Filedeletejson",
   					data : formData, success : function(result) {
   						$('.filecard'+id).remove();
   						Swal.fire({
   				              icon: 'success',
   				              title: 'Deleted!',
   				              text: 'File has been deleted.',
   				              customClass: {
   				                confirmButton: 'btn btn-success'
   				              }
   				            });
   					},
   					error : function(e) {
   						console.log("Error" + e);
   					}
   				});
               
               }
           });
    }
  
  //------------------------------------------------------    
  
  $('.contactdeletebtn').on('click', function(event){
    	  let id=$(this).attr("name");
    	  contactdeleteoperation(id);
      });
  	//------------------------------------------------------    
  	  $('.filedeletebtn').on('click', function(event){
    	  let id=$(this).attr("name");
    	  filedeleteoperation(id);
      });
//------------------------------------------------------
    // Date Format
   const flatpickrFriendly = document.querySelector('#Model_STATED_DATE');
	 // Human Friendly
	  if (flatpickrFriendly) {
	    flatpickrFriendly.flatpickr({
	      altInput: true,
	      altFormat: 'F j, Y',
	      dateFormat: 'Y-m-d'
	    });
	  }
	 
	// Date Format
	   const flatpickrFriendly1 = document.querySelector('#Model_effectiveon');
		 // Human Friendly
		  if (flatpickrFriendly1) {
		    flatpickrFriendly1.flatpickr({
		      altInput: true,
		      altFormat: 'F j, Y',
		      dateFormat: 'Y-m-d'
		    });
		  }
	// Phone
		 const phoneMask = document.querySelector('.phone-number-otp-mask');

	    // Phone Number Input Mask
	    if (phoneMask) {
	      new Cleave(phoneMask, {
	        phone: true,
	        phoneRegionCode: 'US'
	      });
	    }    
	  //------------------------------------------------------    
		 
		 function editpurchaseinfo(e){
				var branchid= e.getAttribute("id");
				
					var formData = {
							branchid : branchid,
						mastercategoryid: "[[${BranchMaster['id']}]]"
					}

					$.ajax({
						type : "POST",
						url : "getbranchpurchaseitem",
						data : formData,
						success : function(result) {
							var bmobj = JSON.parse(JSON.stringify(result));
							//console.log(bmobj);
							
							$("#branchpurchaseid").val(bmobj.branchpurchaseid);
							$("#branchpurchaseNo").val(bmobj.branchpurchaseNo);
							$("#branchpurchaseDate").val(bmobj.branchpurchaseDate);
							$("#dueDate").val(bmobj.dueDate);
							$("#branchpurchaseType").val(bmobj.branchpurchaseType).change();
							$("#receivable").val(bmobj.receivable).change();
							$("#purchase_employeeid").val(bmobj.employeeid).change();
							$("#purchase_supplierid").val(bmobj.supplierid).change();
							$("#note").val(bmobj.notes);

							purchaseIncre = 0 ;
							html="";
							bmobj.branchpurchaseItemMasterlist.forEach((element, index, array) =>
				           	{
				           	 	purchaseIncre= purchaseIncre+1;
								html +='<div class="d-flex border rounded position-relative pe-0 incontact'+ purchaseIncre + '"> <div class="row w-100 m-0 p-3"> 	<div class="col-md-4 col-12 mb-md-0 mb-3 ps-md-0"> <p class="mb-2 repeater-title">Item Description</p> <input type="hidden" id="branchpurchaseitemid'+ purchaseIncre +'" name="branchpurchaseitemid'+ purchaseIncre +'" value="'+ element.branchpurchaseitemid + '"/> <select class="form-select item-details mb-2" id="BranchpurchaseItem'+ purchaseIncre +'" name="BranchpurchaseItem'+ purchaseIncre +'" required> <option value="'+ element.branchpurchaseItem + '">'+ element.branchpurchaseItem_name + '</option> ' + NATUREOFWORK_temp + '</select> <textarea class="form-control" rows="2" id="Description'+ purchaseIncre +'" name="Description'+ purchaseIncre +'" placeholder="Item Information">'+ element.description + '</textarea> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Qty</p> <input type="number" class="form-control invoice-item-qty"  min="1" max="500" id="Quantity'+ purchaseIncre +'" value="'+ element.quantity + '" name="Quantity'+ purchaseIncre +'" onchange="invoiceamountCalculator()" required /> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Unit</p> <select class="form-select item-details mb-2" id="Unit'+ purchaseIncre +'" name="Unit'+ purchaseIncre +'" required> <option value="'+ element.unit + '">'+ element.unit + '</option> '+ UNITS_temp +'  </select> 	</div> 	<div class="col-md-2 col-12 mb-md-0 mb-3"> <p class="mb-2 repeater-title">Price</p> <input type="number" class="form-control invoice-item-price mb-2" onchange="invoiceamountCalculator()" id="Price'+ purchaseIncre +'" name="Price'+ purchaseIncre +'"  value="'+ element.price + '" required/> <input type="hidden" id="Discountperip'+ purchaseIncre +'" value="'+ element.discountper + '" name="Discountper'+ purchaseIncre +'" /> <input type="hidden" id="CGSTperip'+ purchaseIncre +'" value="'+ element.cgstper + '" name="CGSTper'+ purchaseIncre +'" /> <input type="hidden" id="IGSTperip'+ purchaseIncre +'" value="'+ element.igstper + '" name="IGSTper'+ purchaseIncre +'" /> <input type="hidden" id="SGSTperip'+ purchaseIncre +'" value="'+ element.sgstper + '" name="SGSTper'+ purchaseIncre +'" /> 	 <div> <span>Discount Per Unit:</span> <span  data-bs-toggle="tooltip" data-bs-placement="top" 	title="Discount %"	class="discount me-2" id="Discountpertxt'+  purchaseIncre +'">'+ element.discountper + '%</span> <span class="tax-1 me-2" data-bs-toggle="tooltip" 	data-bs-placement="top" title="CGST %" 	id="CGSTpertxt'+  purchaseIncre +'">'+ element.cgstper + '%</span> <span class="tax-2" 	data-bs-toggle="tooltip" data-bs-placement="top" 	title="SGST %" id="SGSTpertxt'+  purchaseIncre +'">'+ element.sgstper + '%</span> <span 	class="tax-2" data-bs-toggle="tooltip" 	data-bs-placement="top" title="IGST %" 	id="IGSTpertxt'+  purchaseIncre +'">'+ element.igstper + '%</span> </div> 	</div> 	<div class="col-md-2 col-12 pe-0"> <p class="mb-2 repeater-title">Taxable Amount</p> <p class="mb-0" id="taxableamount'+  purchaseIncre +'">'+ element.taxableAmount.toFixed(2) +'</p> 	</div> </div> <div 	class="d-flex flex-column align-items-center justify-content-between border-start p-2"> 	<i class="bx bx-x fs-4 text-muted cursor-pointer" onclick="deleteprojectpurchaseItem('+ purchaseIncre +')"></i> 	<div class="dropdown"> <i class="bx bx-cog bx-xs text-muted cursor-pointer more-options-dropdown" role="button" id="dropdownMenuButton" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false"> </i> <div class="dropdown-menu dropdown-menu-end w-px-300 p-3" aria-labelledby="dropdownMenuButton"> <div class="row g-3"> 	<div class="col-12"> <label for="discountInput" class="form-label">Discount(%)</label> <input type="number" class="form-control" id="Discountper'+ purchaseIncre +'" min="0" max="100" value="'+ element.discountper+'" /> 	</div> 	<div class="col-md-6"> <label for="taxInput1" class="form-label">CGST % 1</label> <select id="CGSTper'+ purchaseIncre +'" class="form-select tax-select CGST"> <option value="'+ element.cgstper +'" >'+ element.cgstper +'%</option> <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> 	<div class="col-md-6"> <label for="taxInput2" class="form-label">SGST % 2</label> <select id="SGSTper'+ purchaseIncre +'" class="form-select tax-select SGST"><option value="'+ element.sgstper +'" >'+ element.sgstper +'%</option>  <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> 	<div class="col-md-12"> <label for="taxInput2" class="form-label">IGST % 2</label> <select id="IGSTper'+ purchaseIncre +'" class="form-select tax-select IGST" onchange="IGSTchange('+ purchaseIncre +')"><option value="'+ element.igstper +'" >'+ element.igstper +'%</option>  <option value="0" >0%</option> <option value="1.5">1.5%</option> <option value="2.5">2.5%</option><option value="6">6%</option><option value="9">9%</option><option value="10">10%</option> <option value="14">14%</option> <option value="18">18%</option> </select> 	</div> </div> <div class="dropdown-divider my-3"></div> <button type="button" onclick="applydiscountandtax(this)" name="'+ purchaseIncre + '"	class="btn btn-label-primary btn-apply-changes">Apply</button> </div> 	</div> </div> </div>';
				           	});
				           	
							$('#purchaseitemlist').html(html);
							invoiceamountCalculator();
							$('#Purchasemodel').modal('show');
						},
						error : function(e) {
							console.log("Error" + e);
						}
					});
				
			}
		//------------------------------------------------------
		//
		// 
		$('.invoice-item-qty').on('change',function(event) {
			invoiceamountCalculator();
			
		});
		$('.invoice-item-price').on('change',function(event) {
			invoiceamountCalculator();
			
		});
		//------------------------------------------------------------------------------------
		$('#branchpurchaseType').on('change',function(event) {
			if($(this).val() == "Bill"){
				$(".CGST").val("0").change();
				$(".SGST").val("0").change();
				$(".IGST").val("0").change();
				$('.CGST').prop("disabled", true);
				$('.SGST').prop("disabled", true);
				$('.IGST').prop("disabled", true);
				
			}else
			{
				
				 const elementsWithClass = document.querySelectorAll(".CGST");
				 const elementsArray = Array.from(elementsWithClass);
				  elementsArray.forEach((element) => {
				     let tempid = element.id.replace("CGSTper","");
				     
				    	 if($("#CGSTper"+tempid).val() == 0 && $("#IGSTper"+tempid).val()== 0)
						{
							$("#CGSTper"+tempid).val("9").change();
						}
						if($("#SGSTper"+tempid).val() == 0 && $("#IGSTper"+tempid).val()== 0)
						{
							$("#SGSTper"+tempid).val("9").change();
						}
						if($("#SGSTper"+tempid).val() != 0 && $("#CGSTper"+tempid).val()!= 0)
						{
							$("#IGSTper"+tempid).val("0").change();
						}
				     
				  });
				 
				
				
				$('.CGST').prop("disabled", false);
				$('.SGST').prop("disabled", false);
				$('.IGST').prop("disabled", false);
			}
			
			$(".btn-apply-changes").click();
			
		});
		//------------------------------------------------------------------------------------
		
		//------------------------------------------------------------------------------------
		function applydiscountandtax(e){
			var rowid= e.getAttribute("name");
			
			Discountper =$("#Discountper"+ rowid).val();
			if(Discountper ==""){
				$("#Discountperip"+ rowid).val(0);
				$("#Discountpertxt"+ rowid).text("0%");
			}else{
				$("#Discountperip"+ rowid).val($("#Discountper"+ rowid).val());	
				$("#Discountpertxt"+ rowid).text($("#Discountper"+ rowid).val()+ "%");
			}
			$("#CGSTperip"+ rowid).val($("#CGSTper"+ rowid).val());
			$("#IGSTperip"+ rowid).val($("#IGSTper"+ rowid).val());
			$("#SGSTperip"+ rowid).val($("#SGSTper"+ rowid).val());
			
			
			$("#CGSTpertxt"+ rowid).text($("#CGSTper"+ rowid).val()+ "%");
			$("#IGSTpertxt"+ rowid).text($("#IGSTper"+ rowid).val()+ "%");
			$("#SGSTpertxt"+ rowid).text($("#SGSTper"+ rowid).val()+ "%");
			$('.more-options-dropdown').click();
			invoiceamountCalculator();
		}
		//------------------------------------------------------
		function generatereceipt(branchpurchaseid)
		{
			
			$("#recepitid").val("");
			
			var formData = {
					branchpurchaseid : branchpurchaseid,
					mastercategoryid: "[[${BranchMaster['id']}]]"
				}

				$.ajax({
					type : "POST",
					url : "getbranchpurchasepaymentitem",
					data : formData,
					success : function(result) {
						var bmobj = JSON.parse(JSON.stringify(result));
						//console.log(bmobj);
						
						$("#branchpurchaseNotxt").text(bmobj.purchaseno);
						$("#duedatetxt").text(bmobj.duedate);
						$("#purpaymentamounttxt").text(bmobj.amount);
						$("#purpaymenttotalpaidNotxt").text(bmobj.totalpaidamount);
						$("#purpaymentBalancetxt").text(bmobj.balanceamount);
						$("#recbranchpurchaseid").val(bmobj.purchaseid);
						
						$('#receiptmodel').modal('show');
					},
					error : function(e) {
						console.log("Error" + e);
					}
				});
			
		}
		//------------------------------------------------------------------------------------
		function invoiceamountCalculator(){
				totalamtwithouttax =0.00;
				totalCGST =0.00;
				totalSGST =0.00;
				totalIGST =0.00;
				totalamount =0.00;
				totaldiscountamount =0.00;
				for( i =1; i<=purchaseIncre;i++)
				{
					 price = $("#Price"+i).val();
					 qty = $("#Quantity"+i).val();
					 taxableAmount =price *  qty ;
					 
					 CGSTper = $("#CGSTperip"+i).val();
					 IGSTper = $("#IGSTperip"+i).val();
					 SGSTper = $("#SGSTperip"+i).val();
					 Discountper = $("#Discountperip"+i).val();
					 
					 Discountamt =taxableAmount * (Discountper/100);
					 afetdiscountamount =  taxableAmount -Discountamt;
					$('#taxableamount'+i).text(afetdiscountamount.toFixed(2));
					
					IGSTamount =afetdiscountamount * (IGSTper/100);
					SGSTamount =afetdiscountamount * (SGSTper/100);
					CGSTamount=afetdiscountamount * (CGSTper/100);
					
					
					totalamtwithouttax = totalamtwithouttax+afetdiscountamount;
					totalCGST =totalCGST+CGSTamount;
					totalSGST = totalSGST+SGSTamount;
					totalIGST = totalIGST+IGSTamount;
					totaldiscountamount = totaldiscountamount+Discountamt;
					
				}
				//-------------------------------------------------
				if(totaldiscountamount.toFixed(2)>0)
				{
					$('.totaldiscountamountdiv').css("visibility","visible");
					$('#totaldiscountamount').text(totaldiscountamount.toFixed(2));
				}else
				{
					$('.totaldiscountamountdiv').css("visibility","hidden");
				}
				//-------------------------------------------------
				if(totalCGST.toFixed(2)>0)
				{
					$('.totalCGSTdiv').css("visibility","visible");
					$('#totalCGST').text(totalCGST.toFixed(2));
				}else
				{
					$('.totalCGSTdiv').css("visibility","hidden");
				}
				//-------------------------------------------------
				if(totalSGST.toFixed(2)>0)
				{
					$('.totalSGSTdiv').css("visibility","visible");
					$('#totalSGST').text(totalSGST.toFixed(2));
				}else
				{
					$('.totalSGSTdiv').css("visibility","hidden");
				}
				//-------------------------------------------------
				if(totalIGST.toFixed(2)>0)
				{
					$('.totalIGSTdiv').css("visibility","visible");
					$('#totalIGST').text(totalIGST.toFixed(2));
				}else
				{
					$('.totalIGSTdiv').css("visibility","hidden");
				}
				//-------------------------------------------------
				
			
				$('#totalamount').text((totalamtwithouttax+ totalCGST + totalSGST + totalIGST).toFixed(2));
				$('#totalamtwithouttax').text(totalamtwithouttax.toFixed(2));
				
				
									
			}
		//------------------------------------------------------------------------------------
		function deleteprojectpurchaseItem(id){
			
			 Swal.fire({
	             title: 'Are you sure?',
	             text: "You won't be able to revert this!",
	             icon: 'warning',
	             showCancelButton: true,
	             confirmButtonText: 'Yes, delete it!',
	             customClass: {
	               confirmButton: 'btn btn-primary me-3',
	               cancelButton: 'btn btn-label-secondary'
	             },
	             buttonsStyling: false
	           }).then(function (result) {
	             if (result.value) {
	            	 $(".incontact"+id).remove();
	            	 purchaseIncre=purchaseIncre-1;
	            	 invoiceamountCalculator();
			   			
	               }
	           });
			
		}
		
		//------------------------------------------------------------------------------------
		
		 function editreceiptinfo(e){
				var branchid= e.getAttribute("id");
				
					var formData = {
						branchid : branchid,
						mastercategoryid: "[[${BranchMaster['id']}]]"
					}

					$.ajax({
						type : "POST",
						url : "getbranchpurpaymentreceiptitem",
						data : formData,
						success : function(result) {
							var bmobj = JSON.parse(JSON.stringify(result));
							//console.log(bmobj);
							
							$("#recepitid").val(bmobj.recepitid);
							$("#recepitNo").val(bmobj.recepitNo);
							$("#recepitDate").val(bmobj.recepitDate);
							$("#recbranchpurchaseid").val(bmobj.branchpurchaseid);
							$("#depitedfrom").val(bmobj.depitedfrom).change();
							$("#modeofPayment").val(bmobj.modeofPayment).change();
							$("#amount").val(bmobj.amount);
							$("#notes").val(bmobj.notes);
							
						
							var formData = {
									branchpurchaseid : bmobj.purchaseid,
									mastercategoryid: "[[${BranchMaster['id']}]]"
								}

								$.ajax({
									type : "POST",
									url : "getbranchpurchasepaymentMasteritem",
									data : formData,
									success : function(result) {
										var bmobj = JSON.parse(JSON.stringify(result));
										//console.log(bmobj);
										
										$("#branchpurchaseNotxt").text(bmobj.purchaseno);
										$("#duedatetxt").text(bmobj.duedate);
										$("#purpaymentamounttxt").text(bmobj.amount);
										$("#purpaymenttotalpaidNotxt").text(bmobj.totalpaidamount);
										$("#purpaymentBalancetxt").text(bmobj.balanceamount);
										$("#recbranchpurchaseid").val(bmobj.purchaseid);
										
										$('#receiptmodel').modal('show');
									},
									error : function(e) {
										console.log("Error" + e);
									}
								});
							
						},
						error : function(e) {
							console.log("Error" + e);
						}
					});
				
			}
		//------------------------------------------------------------------------------------
			function IGSTchange(id){
				if($("#IGSTper"+ id).val()>0)
				{
					$("#CGSTper"+ id).val("0").change();
					$("#SGSTper"+ id).val("0").change();		
				}
		
			}
		//------------------------------------------------------
    </script>
		  </body>
		</html>
