<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" lang="en"
	class="light-style layout-navbar-fixed layout-menu-fixed" dir="ltr"
	data-theme="theme-default" th:data-assets-path="@{/assets/}"
	data-template="vertical-menu-template">
<head>
<meta name="_csrf" th:content="${_csrf.token}" />
<!-- default header name is X-CSRF-TOKEN -->
<meta name="_csrf_header" th:content="${_csrf.headerName}" />

<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

<title>Report - Attendance</title>

<meta name="description" content="" />

<!-- Favicon -->
<link rel="icon" type="image/x-icon"
	th:href="@{/assets/img/favicon/favicon.ico}" />

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
	href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Rubik:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
	rel="stylesheet" type="text/css" />

<!-- Icons -->
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/fonts/boxicons.css}" />
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/fonts/fontawesome.css}" />
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/fonts/flag-icons.css}" />

<!-- Core CSS -->
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/css/rtl/core.css}"
	class="template-customizer-core-css" />
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/css/rtl/theme-default.css}"
	class="template-customizer-theme-css" />
<link rel="stylesheet" type="text/css" th:href="@{/assets/css/demo.css}" />

<!-- Vendors CSS -->
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css}" />
<link rel="stylesheet" type="text/css"
	th:href="@{/assets/vendor/libs/typeahead-js/typeahead.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-bs5/datatables.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-checkboxes-jquery/datatables.checkboxes.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/sweetalert2/sweetalert2.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/flatpickr/flatpickr.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/jquery-timepicker/jquery-timepicker.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/pickr/pickr-themes.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/tagify/tagify.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/bootstrap-select/bootstrap-select.css}" />
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/select2/select2.css}" />

<!-- Row Group CSS -->
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/datatables-rowgroup-bs5/rowgroup.bootstrap5.css}" />
<!-- Form Validation -->
<link rel="stylesheet"
	th:href="@{/assets/vendor/libs/formvalidation/dist/css/formValidation.min.css}" />


<!-- Page CSS -->

<!-- Helpers -->
<script th:src="@{/assets/vendor/js/helpers.js}"></script>

<!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
<!--? Template customizer: To hide customizer set displayCustomizer value false in config.js.  -->
<script th:src="@{/assets/vendor/js/template-customizer.js}"></script>
<!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
<script th:src="@{/assets/js/config.js}"></script>

<style>
.sticky-col {
	position: -webkit-sticky;
	position: sticky;
	background-color: white !important;
	border-right: 1px solid #ccc;
}

.first-col {
	text-align: left;
	width: 30px;
	min-width: 30px;
	max-width: 30px;
	left: 0px;
	border-right: 1px solid #ccc;
}

.second-col {
	text-align: left;
	width: 200px;
	min-width: 200px;
	max-width: 200px;
	left: 0px;
	border-right: 1px solid #ccc;
}

.table, .table>tr, .table td {
	line-height: 8px;
	padding: 0.5rem 0.5rem;
	text-align: left;
}

.table th {
	padding: 1.5rem 0.5rem;
	text-align: left;
}

.P {
	color: green;
}

.A {
	color: red;
}

.T {
	color: #FDAC41;
}

.HL {
	color: #4169E1;
}

.sunday {
	background: #FFE4E1;
}

td.sunday {
	background: #FFE4E1;
}

.holiday {
	background: #EEEEE0;
}

td.holiday {
	background: #EEEEE0;
}

.reortmonth {
	color: green;
	font-weight: bold;
}

.note {
	padding: 10px;
}

.card-datatable  button {
	background: #EEEEE0;
	border: none;
	padding: 5px;
	color: #9C9C9C;
}
</style>

</head>

<body>
	<!-- Layout wrapper -->
	<div class="layout-wrapper layout-content-navbar">
		<div class="layout-container">
			<!-- Menu -->
			<div th:insert="menu"></div>
			<!-- / Menu -->

			<!-- Layout container -->
			<div class="layout-page">
				<!-- Navbar -->
				<div th:insert="header"></div>
				<!-- / Navbar -->

				<!-- Content wrapper -->
				<div class="content-wrapper">
					<!-- Content -->

					<div class="container-xxl flex-grow-1 container-p-y">
						<h4 class="py-3 breadcrumb-wrapper mb-4">
							<span class="text-muted fw-light">Administration/HR
								Management/Attendance/Report </span>
						</h4>
						<div class="row gy-4">
							<!-- User Sidebar -->
							<div class="col-xl-12 col-lg-5 col-md-5 order-1 order-md-0">
								<!-- User Card -->
								<div class="card mb-4">
									<div class="card-body">
										<!-- ---------------------- -- ---------------------- -->
										<!-- ---------------------- -- ---------------------- -->
										<!-- Zero configuration table -->
										<section id="basic-datatable">
											<div class="row">
												<div class="col-12">

													<form th:action="@{attendancereport}" method="GET"
														class="wizard-horizontal" enctype="multipart/form-data">
														<div class="row">
															<div class="col-md-3">

																<div class="form-group">
																	<label for="contact-info-icon">Attendance Month</label>
																	<div class="form-group">
																		<div class="position-relative has-icon-left">
																			<input type="month" name="month" id="month"
																				class="e1 form-control" />

																		</div>
																	</div>
																</div>
															</div>
															<div class="col-md-3">

																<div class="form-group">
																	<label for="contact-info-icon">Branch</label>
																	<div class="form-group">
																		<div class="position-relative has-icon-left">
																			<select class="form-control" id="branch"
																				name="branch"  required>
																				<option value="">-</option>
																				<th:block th:each="obj : ${branchlist}">
																					<option
																						th:if="${obj.BRANCH_NAME} != ${targetedbranchName}"
																						th:value="${obj.id}" th:text="${obj.BRANCH_NAME}"></option>
																				</th:block>


																			</select>

																		</div>
																	</div>
																</div>
															</div>
															<div class="col-md-3">
																<div class="form-group">
																	<br />
																	<button type="submit"
																		class="e2 position-relative  btn btn-primary ml-1"
																		id="hiredatebtn">Search</button>
																</div>

															</div>
														</div>
													</form>
													<hr />
													<th:block>
														<p class="reortmonth"
															th:text="'Report Month ' +${monthstr}"></p>
													</th:block>
													
													<div class="card-datatable table-responsive pt-0">
														<table class="datatables-basic table table-bordered"
															id="empattendancereport">
															<thead>
																<tr>
																	<th class="sticky-col first-col">#</th>
																	<th class="sticky-col second-col">Name</th>
																	<th:block
																		th:each="i : ${#numbers.sequence( 1, prdenddate, 1)}">

																		<th th:if="${#lists.contains(sundays,'|'+ i +'|')}"
																			class="sunday" th:text="${ i }"></th>
																		<th:block
																			th:unless="${#lists.contains(sundays,'|'+ i +'|')}">

																			<th
																				th:if="${#lists.contains(holidaylist,'|'+ i +'|')}"
																				class="holiday" th:text="${ i }"></th>
																			<th
																				th:unless="${#lists.contains(holidaylist,'|'+ i +'|')}"
																				th:text="${ i }"></th>

																		</th:block>

																	</th:block>
																	<th>Total_P</th>
																	<th>Total_A</th>
																	<th>Total_HL</th>
																	<th>Total_T</th>


																</tr>
															</thead>
															<tbody>
																<tr th:each="rpt,stat : ${reportarr}">
																	<td class="sticky-col first-col"
																		th:text="${stat.index+1}"></td>
																	<td class="sticky-col second-col"
																		th:text="${#strings.arraySplit(rpt,'~')[0] }"></td>

																	<th:block
																		th:each="i : ${#numbers.sequence( 1, prdenddate+4, 1)}">
																		<td th:if="${#lists.contains(sundays,'|'+ i +'|')}"
																			th:text="${#strings.arraySplit(rpt,'~')[i+1] }"
																			th:class="${#strings.arraySplit(rpt,'~')[i+1] } + ' sunday'"></td>
																		<th:block
																			th:unless="${#lists.contains(sundays,'|'+ i +'|')}">
																			<td
																				th:if="${#lists.contains(holidaylist,'|'+ i +'|')}"
																				th:text="${#strings.arraySplit(rpt,'~')[i+1] }"
																				th:class="${#strings.arraySplit(rpt,'~')[i+1] } + 'holiday'"></td>
																			<td
																				th:unless="${#lists.contains(holidaylist,'|'+ i +'|')}"
																				th:text="${#strings.arraySplit(rpt,'~')[i+1] }"
																				th:class="${#strings.arraySplit(rpt,'~')[i+1] }"></td>
																		</th:block>

																	</th:block>

																</tr>

															</tbody>

														</table>
													</div>
													<br /> <span class="sunday note">Sunday</span> <span
														class="holiday note">Holiday</span>
												</div>
											</div>

										</section>
										<!--/ Zero configuration table -->
										<!-- ---------------------- -- ---------------------- -->
										<!-- ---------------------- -- ---------------------- -->
									</div>
								</div>
								<!-- /User Card -->


							</div>
							<!--/ User Sidebar -->


						</div>


					</div>
					<!-- / Content -->

					<!-- Footer -->
					<footer class="content-footer footer bg-footer-theme">
						<div
							class="container-fluid d-flex flex-wrap justify-content-between py-2 flex-md-row flex-column">
							<div class="mb-2 mb-md-0"></div>
							<div></div>
						</div>
					</footer>
					<!-- / Footer -->

					<div class="content-backdrop fade"></div>
				</div>
				<!-- Content wrapper -->
			</div>
			<!-- / Layout page -->
		</div>

		<!-- Overlay -->
		<div class="layout-overlay layout-menu-toggle"></div>

		<!-- Drag Target Area To SlideIn Menu On Small Screens -->
		<div class="drag-target"></div>
	</div>
	<!-- / Layout wrapper -->

<!-- Core JS -->
		<!-- build:js assets/vendor/js/core.js -->
		<script th:src="@{/assets/vendor/libs/jquery/jquery.js}"></script>
		<script th:src="@{/assets/vendor/libs/popper/popper.js}"></script>
		<script th:src="@{/assets/vendor/js/bootstrap.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js}"></script>

		<script th:src="@{/assets/vendor/libs/hammer/hammer.js}"></script>

		<script th:src="@{/assets/vendor/libs/i18n/i18n.js}"></script>
		<script th:src="@{/assets/vendor/libs/typeahead-js/typeahead.js}"></script>

		<script th:src="@{/assets/vendor/js/menu.js}"></script>
		<!-- endbuild -->

		<!-- Vendors JS -->
		<script th:src="@{/assets/vendor/libs/select2/select2.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/bootstrap-select/bootstrap-select.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables/jquery.dataTables.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-bs5/datatables-bootstrap5.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-responsive/datatables.responsive.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-responsive-bs5/responsive.bootstrap5.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-checkboxes-jquery/datatables.checkboxes.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons/datatables-buttons.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons-bs5/buttons.bootstrap5.js}"></script>
		<script th:src="@{/assets/vendor/libs/jszip/jszip.js}"></script>
		<script th:src="@{/assets/vendor/libs/pdfmake/pdfmake.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons/buttons.html5.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-buttons/buttons.print.js}"></script>
		<!-- Flat Picker -->
		<script th:src="@{/assets/vendor/libs/moment/moment.js}"></script>
		<script th:src="@{/assets/vendor/libs/flatpickr/flatpickr.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/bootstrap-datepicker/bootstrap-datepicker.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/bootstrap-daterangepicker/bootstrap-daterangepicker.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/jquery-timepicker/jquery-timepicker.js}"></script>
		<script th:src="@{/assets/vendor/libs/pickr/pickr.js}"></script>

		<!-- Row Group JS -->
		<script
			th:src="@{/assets/vendor/libs/datatables-rowgroup/datatables.rowgroup.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/datatables-rowgroup-bs5/rowgroup.bootstrap5.js}"></script>
		<script th:src="@{/assets/vendor/libs/sweetalert2/sweetalert2.js}"></script>
		<script th:src="@{/assets/vendor/libs/tagify/tagify.js}"></script>
		<!-- Form Validation -->
		<script
			th:src="@{/assets/vendor/libs/formvalidation/dist/js/FormValidation.min.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/formvalidation/dist/js/plugins/Bootstrap5.min.js}"></script>
		<script
			th:src="@{/assets/vendor/libs/formvalidation/dist/js/plugins/AutoFocus.min.js}"></script>

		<!-- Main JS -->
		<script th:src="@{/assets/js/main.js}"></script>

		<!-- Page JS -->
		<!-- <script th:src="@{/assets/js/tables-datatables-basic.js}"></script> -->
		<script th:src="@{/assets/js/form-validation.js}"></script>


	<script>
$(document).ready(function () {
    
	$("#branch").val("[[${branchid}]]").change();
	var month="[[${monthstr}]]";

	if(month.length==6)
	{
		var arr=month.split("-");
		$("#month").val(arr[0]+"-0"+arr[1]);
	}else
	{
		$("#month").val("[[${monthstr}]]");
	}
	
	
	var table = $('#empattendancereport').DataTable({
        lengthChange: true,
        buttons: [ 'copy', 'csv', 'pdf' ]
    });
 

    table.buttons().container()
        .appendTo( '.card-datatable' );
});
</script>



</body>
</html>
